<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aioveu.boot.aioveuAttendance.mapper.AioveuAttendanceMapper">

    <!-- 获取考勤信息分页列表 -->
    <select id="getAioveuAttendancePage" resultType="com.aioveu.boot.aioveuAttendance.model.vo.AioveuAttendanceVO">
        SELECT
                attendance_id,
                employee_id,
                date,
                checkin_time,
                checkout_time,
                work_hours,
                status,
                create_time,
                update_time
        FROM
            aioveu_attendance
        <where>
            <if test="queryParams.attendanceId != null">
                AND attendance_id LIKE CONCAT('%', #{queryParams.attendanceId}, '%')
            </if>
            <if test="queryParams.employeeId != null">
                AND employee_id LIKE CONCAT('%', #{queryParams.employeeId}, '%')
            </if>
            <if test="queryParams.date != null">
                <if test="queryParams.date[0] != null and queryParams.date[0] != ''">
                    <bind name="startDate" value="queryParams.date[0].length() == 10 ? queryParams.date[0] + ' 00:00:00' : queryParams.date[0]"/>
                    AND date &gt;= #{startDate}
                </if>
                <if test="queryParams.date[1] != null and queryParams.date[1] != ''">
                    <bind name="endDate" value="queryParams.date[1].length() == 10 ? queryParams.date[1] + ' 23:59:59' : queryParams.date[1]"/>
                    AND date &lt;= #{endDate}
                </if>
            </if>
            <if test="queryParams.checkinTime != null">
                <if test="queryParams.checkinTime[0] != null and queryParams.checkinTime[0] != ''">
                    <bind name="startDate" value="queryParams.checkinTime[0].length() == 10 ? queryParams.checkinTime[0] + ' 00:00:00' : queryParams.checkinTime[0]"/>
                    AND checkin_time &gt;= #{startDate}
                </if>
                <if test="queryParams.checkinTime[1] != null and queryParams.checkinTime[1] != ''">
                    <bind name="endDate" value="queryParams.checkinTime[1].length() == 10 ? queryParams.checkinTime[1] + ' 23:59:59' : queryParams.checkinTime[1]"/>
                    AND checkin_time &lt;= #{endDate}
                </if>
            </if>
            <if test="queryParams.checkoutTime != null">
                <if test="queryParams.checkoutTime[0] != null and queryParams.checkoutTime[0] != ''">
                    <bind name="startDate" value="queryParams.checkoutTime[0].length() == 10 ? queryParams.checkoutTime[0] + ' 00:00:00' : queryParams.checkoutTime[0]"/>
                    AND checkout_time &gt;= #{startDate}
                </if>
                <if test="queryParams.checkoutTime[1] != null and queryParams.checkoutTime[1] != ''">
                    <bind name="endDate" value="queryParams.checkoutTime[1].length() == 10 ? queryParams.checkoutTime[1] + ' 23:59:59' : queryParams.checkoutTime[1]"/>
                    AND checkout_time &lt;= #{endDate}
                </if>
            </if>
            <if test="queryParams.workHours != null">
                AND work_hours LIKE CONCAT('%', #{queryParams.workHours}, '%')
            </if>
            <if test="queryParams.status != null">
                AND status LIKE CONCAT('%', #{queryParams.status}, '%')
            </if>
            <if test="queryParams.createTime != null">
                <if test="queryParams.createTime[0] != null and queryParams.createTime[0] != ''">
                    <bind name="startDate" value="queryParams.createTime[0].length() == 10 ? queryParams.createTime[0] + ' 00:00:00' : queryParams.createTime[0]"/>
                    AND create_time &gt;= #{startDate}
                </if>
                <if test="queryParams.createTime[1] != null and queryParams.createTime[1] != ''">
                    <bind name="endDate" value="queryParams.createTime[1].length() == 10 ? queryParams.createTime[1] + ' 23:59:59' : queryParams.createTime[1]"/>
                    AND create_time &lt;= #{endDate}
                </if>
            </if>
            <if test="queryParams.updateTime != null">
                <if test="queryParams.updateTime[0] != null and queryParams.updateTime[0] != ''">
                    <bind name="startDate" value="queryParams.updateTime[0].length() == 10 ? queryParams.updateTime[0] + ' 00:00:00' : queryParams.updateTime[0]"/>
                    AND update_time &gt;= #{startDate}
                </if>
                <if test="queryParams.updateTime[1] != null and queryParams.updateTime[1] != ''">
                    <bind name="endDate" value="queryParams.updateTime[1].length() == 10 ? queryParams.updateTime[1] + ' 23:59:59' : queryParams.updateTime[1]"/>
                    AND update_time &lt;= #{endDate}
                </if>
            </if>
        </where>
    </select>

</mapper>
