import{d as e,h as a,a8 as l,al as s,a as o,w as t,i as r,E as i,G as c,o as n,e as u,q as d,s as m,g as f,b as p,a4 as _,a0 as v,f as g,X as w,W as h}from"./index-5U173LQ3.js";import{_ as y}from"./wd-icon.CDbxLjoy.js";import{_ as x}from"./wd-form.BbkYwo7Z.js";import{u as j,w as k}from"./wd-toast.BszgenSq.js";import{_ as C}from"./logo.B1GNBROf.js";import"./index.BkHvPazf.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./useChildren.Crbe03ZE.js";import"./types.Prh_CF5p.js";import"./wd-overlay.iGBdgU4M.js";import"./base64.3RFQOR3W.js";import"./wd-transition.7-0aPBrJ.js";const b=F(e({__name:"index",setup(e){const F=a(),b=j(),V=a(!1),I=l(),U=a(!1),z=a({username:"aioveu",password:"aioveu"}),D=a("");s((e=>{D.value=e&&e.redirect?decodeURIComponent(e.redirect):"/pages/index/index"}));const R=()=>{V.value||(V.value=!0,I.login(z.value).then((()=>I.getInfo())).then((()=>{b.success("登录成功"),I.isUserInfoComplete()?setTimeout((()=>{h({url:D.value})}),1e3):setTimeout((()=>{w({url:`/pages/login/complete-profile?redirect=${encodeURIComponent(D.value)}`})}),1e3)})).catch((e=>{b.error((null==e?void 0:e.message)||"登录失败")})).finally((()=>{V.value=!1})))},q=async()=>{if(!V.value){V.value=!0;try{b.error("当前环境不支持微信登录")}catch(e){b.error((null==e?void 0:e.message)||"微信登录失败")}finally{V.value=!1}}},T=()=>{w({url:"/pages/mine/user-agreement/index"})},$=()=>{w({url:"/pages/mine/privacy/index"})};return(e,a)=>{const l=d,s=m,w=r,h=i(c("wd-icon"),y),j=_,b=v,I=i(c("wd-form"),x),D=i(c("wd-toast"),k);return n(),o(w,{class:"login-container"},{default:t((()=>[u(l,{src:"/static/images/login-bg.svg",mode:"aspectFill",class:"login-bg"}),u(w,{class:"header"},{default:t((()=>[u(l,{src:C,class:"logo"}),u(s,{class:"title"},{default:t((()=>[f("可我不敌可爱")])),_:1}),u(s,{class:"subtitle"},{default:t((()=>[f("恰同学少年，风华正茂；书生意气，挥斥方遒")])),_:1})])),_:1}),u(w,{class:"login-card"},{default:t((()=>[u(w,{class:"form-wrap"},{default:t((()=>[u(I,{ref_key:"loginFormRef",ref:F,model:z.value},{default:t((()=>[u(w,{class:"form-item"},{default:t((()=>[u(h,{name:"user",size:"22",color:"#165DFF",class:"input-icon color-_wn_165DFF"}),u(j,{modelValue:z.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>z.value.username=e),class:"form-input",placeholder:"请输入用户名"},null,8,["modelValue"]),z.value.username?(n(),o(h,{key:0,name:"close-fill",size:"18",color:"#9ca3af",class:"clear-icon color-_wn_9ca3af",onClick:a[1]||(a[1]=e=>z.value.username="")})):p("",!0)])),_:1}),u(w,{class:"divider"}),u(w,{class:"form-item"},{default:t((()=>[u(h,{name:"lock-on",size:"22",color:"#165DFF",class:"input-icon color-_wn_165DFF"}),u(j,{modelValue:z.value.password,"onUpdate:modelValue":a[2]||(a[2]=e=>z.value.password=e),class:"form-input",type:U.value?"text":"password",placeholder:"请输入密码","placeholder-style":"color: #9ca3af; font-weight: normal;"},null,8,["modelValue","type"]),u(h,{name:U.value?"eye-open":"eye-close",size:"18",color:"#9ca3af",class:"eye-icon color-_wn_9ca3af",onClick:a[3]||(a[3]=e=>U.value=!U.value)},null,8,["name"])])),_:1}),u(w,{class:"divider"}),u(b,{class:"login-btn",disabled:V.value,style:g(V.value?"opacity: 0.7;":""),onClick:R},{default:t((()=>[f(" 登录 ")])),_:1},8,["disabled","style"])])),_:1},8,["model"]),u(w,{class:"other-login"},{default:t((()=>[u(w,{class:"other-login-title"},{default:t((()=>[u(w,{class:"line"}),u(s,{class:"text"},{default:t((()=>[f("其他登录方式")])),_:1}),u(w,{class:"line"})])),_:1}),u(w,{class:"wechat-login",onClick:q},{default:t((()=>[u(w,{class:"wechat-icon-wrapper"},{default:t((()=>[u(l,{src:"/static/icons/weixin.png",class:"wechat-icon"})])),_:1})])),_:1})])),_:1}),u(w,{class:"agreement"},{default:t((()=>[u(s,{class:"text"},{default:t((()=>[f("登录即同意")])),_:1}),u(s,{class:"link",onClick:T},{default:t((()=>[f("《用户协议》")])),_:1}),u(s,{class:"text"},{default:t((()=>[f("和")])),_:1}),u(s,{class:"link",onClick:$},{default:t((()=>[f("《隐私政策》")])),_:1})])),_:1})])),_:1})])),_:1}),u(D)])),_:1})}}}),[["__scopeId","data-v-6b5d9a2f"]]);export{b as default};
