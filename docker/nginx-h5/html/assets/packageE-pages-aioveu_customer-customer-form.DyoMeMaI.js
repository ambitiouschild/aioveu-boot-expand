import{d as e,h as l,y as a,al as t,$ as o,a as u,w as s,i as m,o as c,e as r,s as d,g as n,t as i,ay as f,a4 as v,a6 as p,a0 as _,aI as y,a3 as b,aJ as V}from"./index-5U173LQ3.js";import{A as g}from"./aioveu-customer.MhylDKEJ.js";import{A as h}from"./aioveu-employee.t1i7jtWp.js";import{D as N}from"./dict.R0KYYCD_.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=k(e({__name:"form",setup(e){const k=l("新增客户"),x=l(void 0),w=l(!1),I=l(void 0),U=a({}),C=l([]),D=l([]),R=l([]),A=l([]),j=l([]),S=l(-1),O=l(-1),E=l(-1),F=l(-1),J=l(-1);t((e=>{console.log("页面参数:",e),$(),q(),e.id?(x.value=Number(e.id),k.value="编辑客户",W()):k.value="新增客户",I.value=x.value}));const W=async()=>{if(x.value)try{w.value=!0;const e=await g.getFormData(x.value);if(Object.assign(U,e),void 0!==U.type){const e=C.value.findIndex((e=>Number(e.value)===U.type));S.value=e}if(void 0!==U.creditRating){const e=D.value.findIndex((e=>Number(e.value)===U.creditRating));O.value=e}if(void 0!==U.customerStatus){const e=R.value.findIndex((e=>Number(e.value)===U.customerStatus));E.value=e}if(void 0!==U.source){const e=A.value.findIndex((e=>Number(e.value)===U.source));F.value=e}if(U.salesRepName){const e=j.value.findIndex((e=>e.employeeName===U.salesRepName));J.value=e}}catch(e){console.error("加载客户数据失败:",e),o({title:"加载数据失败",icon:"none"})}finally{w.value=!1}},$=async()=>{try{const e=await N.getDictItems("customer_customer_type");C.value=e;const l=await N.getDictItems("customer_credit_rating");D.value=l;const a=await N.getDictItems("customer_status");R.value=a;const t=await N.getDictItems("customer_source");A.value=t}catch(e){console.error("加载字典选项失败:",e),o({title:"加载选项失败",icon:"none"})}},q=async()=>{try{const e=await h.getAllEmployeeOptions();Array.isArray(e)&&(j.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))}catch(e){console.error("加载员工列表失败:",e),o({title:"加载员工列表失败",icon:"none"})}},z=e=>{const l=e.detail.value;S.value=l,C.value[l]&&(U.type=Number(C.value[l].value))},B=e=>{const l=e.detail.value;O.value=l,D.value[l]&&(U.creditRating=Number(D.value[l].value))},G=e=>{const l=e.detail.value;E.value=l,R.value[l]&&(U.customerStatus=Number(R.value[l].value))},H=e=>{const l=e.detail.value;F.value=l,A.value[l]&&(U.source=Number(A.value[l].value))},K=e=>{const l=e.detail.value;J.value=l,j.value[l]&&(U.salesRepName=j.value[l].employeeName)},L=e=>{U.establishedDate=e.detail.value},M=async()=>{if(P())try{y({title:"提交中..."});const e=I.value;e?(await g.update(e,U),o({title:"修改成功",icon:"success"})):(await g.add(U),o({title:"新增成功",icon:"success"})),b()}catch(e){console.error("提交表单失败:",e),o({title:"提交失败",icon:"none"})}finally{V()}},P=()=>U.customerNo?U.name?void 0===U.type?(o({title:"请选择客户类型",icon:"none"}),!1):void 0===U.creditRating?(o({title:"请选择信用等级",icon:"none"}),!1):void 0!==U.customerStatus||(o({title:"请选择客户状态",icon:"none"}),!1):(o({title:"请输入客户名称",icon:"none"}),!1):(o({title:"请输入客户编号",icon:"none"}),!1),Q=()=>{b()};return(e,l)=>{const a=d,t=m,o=v,y=p,b=f,V=_;return c(),u(t,{class:"form-container"},{default:s((()=>[r(t,{class:"form-header"},{default:s((()=>[r(a,{class:"form-title"},{default:s((()=>[n(i(k.value),1)])),_:1})])),_:1}),r(b,{class:"form-body scroll-y","scroll-y":""},{default:s((()=>[r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("客户编号")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入客户编号",modelValue:U.customerNo,"onUpdate:modelValue":l[0]||(l[0]=e=>U.customerNo=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("客户名称")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入客户名称",modelValue:U.name,"onUpdate:modelValue":l[1]||(l[1]=e=>U.name=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("客户类型")])),_:1}),r(y,{class:"form-picker",mode:"selector",range:C.value,"range-key":"label",value:S.value,onChange:z},{default:s((()=>[r(t,{class:"picker-view"},{default:s((()=>[n(i(S.value>=0?C.value[S.value].label:"请选择客户类型"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("信用等级")])),_:1}),r(y,{class:"form-picker",mode:"selector",range:D.value,"range-key":"label",value:O.value,onChange:B},{default:s((()=>[r(t,{class:"picker-view"},{default:s((()=>[n(i(O.value>=0?D.value[O.value].label:"请选择信用等级"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("客户状态")])),_:1}),r(y,{class:"form-picker",mode:"selector",range:R.value,"range-key":"label",value:E.value,onChange:G},{default:s((()=>[r(t,{class:"picker-view"},{default:s((()=>[n(i(E.value>=0?R.value[E.value].label:"请选择客户状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("客户地址")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入客户地址",modelValue:U.address,"onUpdate:modelValue":l[2]||(l[2]=e=>U.address=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("所在城市")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入所在城市",modelValue:U.city,"onUpdate:modelValue":l[3]||(l[3]=e=>U.city=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("所在省份")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入所在省份",modelValue:U.province,"onUpdate:modelValue":l[4]||(l[4]=e=>U.province=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("国家")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入国家",modelValue:U.country,"onUpdate:modelValue":l[5]||(l[5]=e=>U.country=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("邮政编码")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入邮政编码",modelValue:U.postalCode,"onUpdate:modelValue":l[6]||(l[6]=e=>U.postalCode=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("联系电话")])),_:1}),r(o,{type:"tel",class:"form-input",placeholder:"请输入联系电话",modelValue:U.phone,"onUpdate:modelValue":l[7]||(l[7]=e=>U.phone=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("电子邮箱")])),_:1}),r(o,{type:"email",class:"form-input",placeholder:"请输入电子邮箱",modelValue:U.email,"onUpdate:modelValue":l[8]||(l[8]=e=>U.email=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("网址")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入网址",modelValue:U.website,"onUpdate:modelValue":l[9]||(l[9]=e=>U.website=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("税号")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入税号",modelValue:U.taxId,"onUpdate:modelValue":l[10]||(l[10]=e=>U.taxId=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("银行账号")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入银行账号",modelValue:U.bankAccount,"onUpdate:modelValue":l[11]||(l[11]=e=>U.bankAccount=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("开户行")])),_:1}),r(o,{type:"text",class:"form-input",placeholder:"请输入开户行",modelValue:U.bankName,"onUpdate:modelValue":l[12]||(l[12]=e=>U.bankName=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("年营业额")])),_:1}),r(o,{type:"number",class:"form-input",placeholder:"请输入年营业额",modelValue:U.annualRevenue,"onUpdate:modelValue":l[13]||(l[13]=e=>U.annualRevenue=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("员工人数")])),_:1}),r(o,{type:"number",class:"form-input",placeholder:"请输入员工人数",modelValue:U.employeeCount,"onUpdate:modelValue":l[14]||(l[14]=e=>U.employeeCount=e)},null,8,["modelValue"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("成立日期")])),_:1}),r(y,{class:"form-picker",mode:"date",value:U.establishedDate,onChange:L},{default:s((()=>[r(t,{class:"picker-view"},{default:s((()=>[n(i(U.establishedDate||"请选择成立日期"),1)])),_:1})])),_:1},8,["value"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("客户来源")])),_:1}),r(y,{class:"form-picker",mode:"selector",range:A.value,"range-key":"label",value:F.value,onChange:H},{default:s((()=>[r(t,{class:"picker-view"},{default:s((()=>[n(i(F.value>=0?A.value[F.value].label:"请选择客户来源"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(t,{class:"form-item"},{default:s((()=>[r(a,{class:"form-label"},{default:s((()=>[n("负责人")])),_:1}),r(y,{class:"form-picker",mode:"selector",range:j.value,"range-key":"employeeName",value:J.value,onChange:K},{default:s((()=>[r(t,{class:"picker-view"},{default:s((()=>[n(i(J.value>=0?j.value[J.value].employeeName:"请选择负责人"),1)])),_:1})])),_:1},8,["range","value"])])),_:1})])),_:1}),r(t,{class:"form-footer"},{default:s((()=>[r(V,{class:"form-btn cancel",onClick:Q},{default:s((()=>[n("取消")])),_:1}),r(V,{class:"form-btn confirm",onClick:M},{default:s((()=>[n("提交")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-1259d500"]]);export{x as default};
