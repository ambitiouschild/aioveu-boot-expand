import{a as e,w as a,h as l,l as t,z as s,a2 as o,Z as d,i,a3 as u,$ as r,_ as c,o as n,e as f,s as m,g as p,t as v,b as h,a4 as _,a5 as g,a6 as D,n as C,c as b,F as k,r as V,a7 as $,a0 as y}from"./index-5U173LQ3.js";import{_ as T}from"./_plugin-vue_export-helper.BCo6x5W8.js";const S=T({setup(){const e=l({id:"",title:"",description:"",deadline:"",priority:"medium",completed:!1}),a=l(""),i=l(""),n=l(!1),f=t((()=>e.value.id?"编辑待办":"新增待办")),m=l([{value:"low",label:"低"},{value:"medium",label:"中"},{value:"high",label:"高"}]);s((()=>{const e=o(),a=e[e.length-1].options;a.id&&p(a.id)}));const p=l=>{const t=d("todos");if(t){const s=JSON.parse(t).find((e=>e.id===l));if(s&&(e.value={...s},s.deadline)){const e=new Date(s.deadline);a.value=`${e.getFullYear()}-${h(e.getMonth()+1)}-${h(e.getDate())}`,i.value=`${h(e.getHours())}:${h(e.getMinutes())}`}}},v=()=>{if(a.value){const l=i.value||"00:00";e.value.deadline=`${a.value} ${l}:00`}},h=e=>e.toString().padStart(2,"0");return{formData:e,formTitle:f,dateValue:a,timeValue:i,showTitleError:n,priorityOptions:m,handleDateChange:e=>{a.value=e.detail.value,v()},handleTimeChange:e=>{i.value=e.detail.value,v()},handleStatusChange:a=>{e.value.completed=a.detail.value},formatDateTime:e=>{if(!e)return"";const a=new Date(e);return`${a.getFullYear()}-${h(a.getMonth()+1)}-${h(a.getDate())} ${h(a.getHours())}:${h(a.getMinutes())}`},saveTodo:()=>{if(!e.value.title)return n.value=!0,void r({title:"请填写标题",icon:"none",position:"top"});n.value=!1;let a=d("todos"),l=a?JSON.parse(a):[];if(e.value.id){const a=l.findIndex((a=>a.id===e.value.id));-1!==a&&(l[a]=e.value)}else e.value.id=Date.now().toString(),e.value.createdAt=(new Date).toISOString(),l.unshift(e.value);c("todos",JSON.stringify(l)),r({title:"保存成功",icon:"success"}),setTimeout((()=>{u()}),1500)},goBack:()=>{u()}}}},[["render",function(l,t,s,o,d,u){const r=m,c=i,T=_,S=g,w=D,x=$,O=y;return n(),e(c,{class:"form-container"},{default:a((()=>[f(c,{class:"form-header"},{default:a((()=>[f(r,{class:"form-title"},{default:a((()=>[p(v(o.formTitle),1)])),_:1})])),_:1}),f(c,{class:"form-body"},{default:a((()=>[f(c,{class:"form-item"},{default:a((()=>[f(r,{class:"form-label"},{default:a((()=>[p("标题"),f(r,{class:"required"},{default:a((()=>[p("*")])),_:1})])),_:1}),f(T,{class:"form-input",placeholder:"请输入待办标题",modelValue:o.formData.title,"onUpdate:modelValue":t[0]||(t[0]=e=>o.formData.title=e),"placeholder-class":"placeholder"},null,8,["modelValue"]),o.showTitleError?(n(),e(r,{key:0,class:"error-text"},{default:a((()=>[p("请填写标题")])),_:1})):h("",!0)])),_:1}),f(c,{class:"form-item"},{default:a((()=>[f(r,{class:"form-label"},{default:a((()=>[p("描述")])),_:1}),f(S,{class:"form-textarea",placeholder:"请输入详细描述",modelValue:o.formData.description,"onUpdate:modelValue":t[1]||(t[1]=e=>o.formData.description=e),"placeholder-class":"placeholder"},null,8,["modelValue"])])),_:1}),f(c,{class:"form-item"},{default:a((()=>[f(r,{class:"form-label"},{default:a((()=>[p("截止时间")])),_:1}),f(c,{class:"datetime-picker-group"},{default:a((()=>[f(w,{mode:"date",value:o.dateValue,onChange:o.handleDateChange},{default:a((()=>[f(c,{class:"picker"},{default:a((()=>[f(r,{class:C(o.dateValue?"selected":"placeholder")},{default:a((()=>[p(v(o.dateValue||"选择日期"),1)])),_:1},8,["class"])])),_:1})])),_:1},8,["value","onChange"]),f(w,{mode:"time",value:o.timeValue,onChange:o.handleTimeChange},{default:a((()=>[f(c,{class:"picker"},{default:a((()=>[f(r,{class:C(o.timeValue?"selected":"placeholder")},{default:a((()=>[p(v(o.timeValue||"选择时间"),1)])),_:1},8,["class"])])),_:1})])),_:1},8,["value","onChange"])])),_:1}),o.formData.deadline?(n(),e(r,{key:0,class:"selected-datetime"},{default:a((()=>[p(" 已选择: "+v(o.formatDateTime(o.formData.deadline)),1)])),_:1})):h("",!0)])),_:1}),f(c,{class:"form-item"},{default:a((()=>[f(r,{class:"form-label"},{default:a((()=>[p("优先级")])),_:1}),f(c,{class:"priority-group"},{default:a((()=>[(n(!0),b(k,null,V(o.priorityOptions,(l=>(n(),e(c,{key:l.value,class:C(["priority-option",{active:o.formData.priority===l.value,[l.value]:!0}]),onClick:e=>o.formData.priority=l.value},{default:a((()=>[f(r,null,{default:a((()=>[p(v(l.label),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),f(c,{class:"form-item"},{default:a((()=>[f(r,{class:"form-label"},{default:a((()=>[p("状态")])),_:1}),f(c,{class:"status-toggle"},{default:a((()=>[f(r,{class:C(["status-label",o.formData.completed?"inactive":"active"])},{default:a((()=>[p("未完成")])),_:1},8,["class"]),f(x,{checked:o.formData.completed,onChange:o.handleStatusChange,class:"status-switch"},null,8,["checked","onChange"]),f(r,{class:C(["status-label",o.formData.completed?"active":"inactive"])},{default:a((()=>[p("已完成")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),f(c,{class:"form-footer"},{default:a((()=>[f(O,{class:"form-btn cancel",onClick:o.goBack},{default:a((()=>[p("取消")])),_:1},8,["onClick"]),f(O,{class:"form-btn save",onClick:o.saveTodo},{default:a((()=>[p("保存")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-f9460fab"]]);export{S as default};
