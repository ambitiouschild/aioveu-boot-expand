import{d as e,h as a,y as l,al as o,$ as t,a as s,w as c,i as n,o as u,e as m,s as r,g as i,t as d,ay as f,a4 as v,a6 as p,a5 as y,a0 as _,aI as b,a3 as h,aJ as V}from"./index-5U173LQ3.js";import{A as g}from"./aioveu-warehouse.DBFoddqK.js";import{A as N}from"./aioveu-employee.BSG7yiTE.js";import{D as w}from"./dict.R0KYYCD_.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=A(e({__name:"form",setup(e){const A=a("新增仓库"),x=a(void 0),k=a(void 0),I=l({name:"",code:"",location:"",area:void 0,capacity:void 0,managerName:"",contactPhone:"",description:"",isActive:void 0}),U=a([]),j=a([]),C=a(-1),D=a(-1),P=a(!0);o((e=>{console.log("页面参数:",e),P.value=!0,E(),F(),e.id?(x.value=Number(e.id),A.value="编辑仓库",O()):A.value="新增仓库",k.value=x.value,P.value=!1}));const O=async()=>{if(x.value)try{P.value=!0;const e=await g.getFormData(x.value);if(Object.assign(I,e),I.managerName){const e=U.value.findIndex((e=>e.employeeName===I.managerName));C.value=e}if(void 0!==I.isActive){const e=j.value.findIndex((e=>Number(e.value)===I.isActive));D.value=e}}catch(e){console.error("加载仓库数据失败:",e),t({title:"加载数据失败",icon:"none"})}finally{P.value=!1}},E=async()=>{try{const e=await N.getAllEmployeeOptions();Array.isArray(e)&&(U.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))}catch(e){console.error("加载员工列表失败:",e),t({title:"加载员工列表失败",icon:"none"})}},F=async()=>{try{const e=await w.getDictItems("warehouse_is_active");j.value=e}catch(e){console.error("加载启用状态失败:",e),t({title:"加载启用状态失败",icon:"none"})}},J=e=>{const a=e.detail.value;C.value=a,U.value[a]&&(I.managerName=U.value[a].employeeName)},M=e=>{const a=e.detail.value;D.value=a,j.value[a]&&(I.isActive=Number(j.value[a].value))},$=async()=>{if(q())try{b({title:"提交中..."});const e=k.value;e?(await g.update(e,I),t({title:"修改成功",icon:"success"})):(await g.add(I),t({title:"新增成功",icon:"success"})),h()}catch(e){console.error("提交表单失败:",e),t({title:"提交失败",icon:"none"})}finally{V()}},q=()=>I.name?I.code?I.location?I.managerName?void 0!==I.isActive||(t({title:"请选择启用状态",icon:"none"}),!1):(t({title:"请选择负责人",icon:"none"}),!1):(t({title:"请输入仓库位置",icon:"none"}),!1):(t({title:"请输入仓库编码",icon:"none"}),!1):(t({title:"请输入仓库名称",icon:"none"}),!1),z=()=>{h()};return(e,a)=>{const l=r,o=n,t=v,b=p,h=y,V=f,g=_;return u(),s(o,{class:"form-container"},{default:c((()=>[m(o,{class:"form-header"},{default:c((()=>[m(l,{class:"form-title"},{default:c((()=>[i(d(A.value),1)])),_:1})])),_:1}),m(V,{class:"form-body scroll-y","scroll-y":""},{default:c((()=>[m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("仓库名称")])),_:1}),m(t,{type:"text",class:"form-input",placeholder:"请输入仓库名称",modelValue:I.name,"onUpdate:modelValue":a[0]||(a[0]=e=>I.name=e)},null,8,["modelValue"])])),_:1}),m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("仓库编码")])),_:1}),m(t,{type:"text",class:"form-input",placeholder:"请输入仓库编码",modelValue:I.code,"onUpdate:modelValue":a[1]||(a[1]=e=>I.code=e)},null,8,["modelValue"])])),_:1}),m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("仓库位置")])),_:1}),m(t,{type:"text",class:"form-input",placeholder:"请输入仓库位置",modelValue:I.location,"onUpdate:modelValue":a[2]||(a[2]=e=>I.location=e)},null,8,["modelValue"])])),_:1}),m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("仓库面积")])),_:1}),m(t,{type:"number",class:"form-input",placeholder:"请输入仓库面积",modelValue:I.area,"onUpdate:modelValue":a[3]||(a[3]=e=>I.area=e)},null,8,["modelValue"])])),_:1}),m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("存储容量")])),_:1}),m(t,{type:"number",class:"form-input",placeholder:"请输入存储容量",modelValue:I.capacity,"onUpdate:modelValue":a[4]||(a[4]=e=>I.capacity=e)},null,8,["modelValue"])])),_:1}),m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("负责人")])),_:1}),m(b,{class:"form-picker",mode:"selector",range:U.value,"range-key":"employeeName",value:C.value,onChange:J},{default:c((()=>[m(o,{class:"picker-view"},{default:c((()=>[i(d(C.value>=0?U.value[C.value].employeeName:"请选择负责人"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("联系电话")])),_:1}),m(t,{type:"tel",class:"form-input",placeholder:"请输入联系电话",modelValue:I.contactPhone,"onUpdate:modelValue":a[5]||(a[5]=e=>I.contactPhone=e)},null,8,["modelValue"])])),_:1}),m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("仓库描述")])),_:1}),m(h,{class:"form-textarea",placeholder:"请输入仓库描述",modelValue:I.description,"onUpdate:modelValue":a[6]||(a[6]=e=>I.description=e)},null,8,["modelValue"])])),_:1}),m(o,{class:"form-item"},{default:c((()=>[m(l,{class:"form-label"},{default:c((()=>[i("启用状态")])),_:1}),m(b,{class:"form-picker",mode:"selector",range:j.value,"range-key":"label",value:D.value,onChange:M},{default:c((()=>[m(o,{class:"picker-view"},{default:c((()=>[i(d(D.value>=0?j.value[D.value].label:"请选择状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1})])),_:1}),m(o,{class:"form-footer"},{default:c((()=>[m(g,{class:"form-btn cancel",onClick:z},{default:c((()=>[i("取消")])),_:1}),m(g,{class:"form-btn confirm",onClick:$},{default:c((()=>[i("提交")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-c8f2b1d2"]]);export{x as default};
