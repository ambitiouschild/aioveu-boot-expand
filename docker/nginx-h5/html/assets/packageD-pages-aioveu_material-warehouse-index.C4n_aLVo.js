import{d as e,h as a,y as l,Y as t,z as s,a as u,w as o,$ as i,i as n,o as c,e as d,b as r,s as f,g as v,t as m,a4 as _,a6 as p,a0 as h,c as g,F as b,r as y,X as w,aa as k,aI as N,aJ as C}from"./index-5U173LQ3.js";import{A}from"./aioveu-warehouse.DBFoddqK.js";import{A as I}from"./aioveu-employee.BSG7yiTE.js";import{D as V}from"./dict.R0KYYCD_.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D=x(e({__name:"index",setup(e){const x=a(!1),D=a([]),j=a(0),P=a(!1),z=l({pageNum:1,pageSize:10}),W=a([]),S=a([]),U=a([]),M=a([]),O=a(-1),T=a(-1),$=a(-1),B=a(void 0),E=()=>{P.value=!P.value},F=e=>{const a=e.detail.value;O.value=a,S.value[a]&&(z.name=S.value[a].warehouseName)},J=e=>{const a=e.detail.value;T.value=a,U.value[a]&&(z.managerName=U.value[a].employeeName)},X=e=>{const a=e.detail.value;$.value=a,M.value[a]&&(z.isActive=Number(M.value[a].value))},Y=()=>{x.value=!0,A.getPage(z).then((e=>{W.value=e.list,j.value=e.total})).catch((e=>{console.error("查询仓库失败:",e),i({title:"加载数据失败",icon:"none"})})).finally((()=>{x.value=!1}))},q=()=>{z.pageNum=1,z.name="",z.code="",z.location="",z.managerName="",z.isActive=void 0,O.value=-1,T.value=-1,$.value=-1,W.value=[],Y()},G=()=>{z.pageNum>1&&(z.pageNum--,Y())},H=()=>{z.pageNum*z.pageSize<j.value&&(z.pageNum++,Y())},K=a(!1);t((()=>{K.value&&(Y(),K.value=!1)}));const L=e=>{K.value=!0,B.value=e;let a="/packageD/pages/aioveu_material/warehouse/form";void 0!==e&&(a+=`?id=${e}`),w({url:a})},Q=e=>{const a=e?[e]:D.value;0!==a.length?k({title:"提示",content:"确认删除选中的仓库吗？",success:e=>{e.confirm&&(N({title:"删除中..."}),A.deleteByIds(a.join(",")).then((()=>{i({title:"删除成功",icon:"success"}),q()})).catch((e=>{console.error("删除失败:",e),i({title:"删除失败",icon:"none"})})).finally((()=>C())))}}):i({title:"请选择要删除的仓库",icon:"none"})},R=e=>{const a=M.value.find((a=>Number(a.value)===e));return a?a.label:"未知状态"};return s((()=>{Y(),A.getAllWarehouseOptions().then((e=>{Array.isArray(e)&&(S.value=e.map((e=>({warehouseId:Number(e.warehouseId),warehouseName:e.warehouseName}))))})).catch((e=>{console.error("加载仓库选项失败:",e)})),I.getAllEmployeeOptions().then((e=>{Array.isArray(e)&&(U.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))})).catch((e=>{console.error("加载员工选项失败:",e)})),V.getDictItems("warehouse_is_active").then((e=>{M.value=e})).catch((e=>{console.error("加载状态选项失败:",e)}))})),(e,a)=>{const l=f,t=n,s=_,i=p,w=h;return c(),u(t,{class:"app-container"},{default:o((()=>[d(t,{class:"search-container"},{default:o((()=>[d(t,{class:"filter-header",onClick:E},{default:o((()=>[d(l,null,{default:o((()=>[v("🔍 筛选条件")])),_:1}),d(l,null,{default:o((()=>[v(m(P.value?"▲":"▼"),1)])),_:1})])),_:1}),P.value?(c(),u(t,{key:0,class:"filter-content"},{default:o((()=>[d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[v("仓库ID")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入仓库ID",modelValue:z.id,"onUpdate:modelValue":a[0]||(a[0]=e=>z.id=e),onConfirm:Y},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[v("仓库名称")])),_:1}),d(i,{class:"filter-picker",mode:"selector",range:S.value,"range-key":"warehouseName",value:O.value,onChange:F},{default:o((()=>[d(t,{class:"picker-view"},{default:o((()=>[v(m(O.value>=0?S.value[O.value].warehouseName:"请选择仓库"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[v("仓库编码")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入仓库编码",modelValue:z.code,"onUpdate:modelValue":a[1]||(a[1]=e=>z.code=e),onConfirm:Y},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[v("仓库位置")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入仓库位置",modelValue:z.location,"onUpdate:modelValue":a[2]||(a[2]=e=>z.location=e),onConfirm:Y},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[v("负责人")])),_:1}),d(i,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"employeeName",value:T.value,onChange:J},{default:o((()=>[d(t,{class:"picker-view"},{default:o((()=>[v(m(T.value>=0?U.value[T.value].employeeName:"请选择负责人"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[v("启用状态")])),_:1}),d(i,{class:"filter-picker",mode:"selector",range:M.value,"range-key":"label",value:$.value,onChange:X},{default:o((()=>[d(t,{class:"picker-view"},{default:o((()=>[v(m($.value>=0?M.value[$.value].label:"请选择状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-buttons"},{default:o((()=>[d(w,{class:"filter-btn reset",onClick:q},{default:o((()=>[v("重置")])),_:1}),d(w,{class:"filter-btn confirm",onClick:Y},{default:o((()=>[v("搜索")])),_:1})])),_:1})])),_:1})):r("",!0)])),_:1}),d(t,{class:"action-buttons"},{default:o((()=>[d(w,{"v-has-perm":["aioveuWarehouse:aioveuProcurement-warehouse:add"],class:"action-btn add",onClick:a[3]||(a[3]=e=>L())},{default:o((()=>[d(l,null,{default:o((()=>[v("+")])),_:1}),d(l,null,{default:o((()=>[v("新增")])),_:1})])),_:1}),d(w,{"v-has-perm":["aioveuWarehouse:aioveuProcurement-warehouse:delete"],class:"action-btn delete",disabled:0===D.value.length,onClick:a[4]||(a[4]=e=>Q())},{default:o((()=>[d(l,null,{default:o((()=>[v("🗑️")])),_:1}),d(l,null,{default:o((()=>[v("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),d(t,{class:"list-container"},{default:o((()=>[x.value?(c(),u(t,{key:0,class:"loading-state"},{default:o((()=>[d(l,null,{default:o((()=>[v("加载中...")])),_:1})])),_:1})):0===W.value.length?(c(),u(t,{key:1,class:"empty-state"},{default:o((()=>[d(l,{class:"empty-icon"},{default:o((()=>[v("📁")])),_:1}),d(l,{class:"empty-text"},{default:o((()=>[v("暂无仓库数据")])),_:1})])),_:1})):(c(!0),g(b,{key:2},y(W.value,(e=>(c(),u(t,{key:e.id,class:"warehouse-card"},{default:o((()=>[d(t,{class:"card-header"},{default:o((()=>[d(l,{class:"warehouse-id"},{default:o((()=>[v("ID: "+m(e.id),1)])),_:2},1024),d(l,{class:"warehouse-name"},{default:o((()=>[v(m(e.name),1)])),_:2},1024)])),_:2},1024),d(t,{class:"card-content"},{default:o((()=>[d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[v("编码:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[v(m(e.code),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[v("位置:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[v(m(e.location),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[v("面积:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[v(m(e.area),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[v("容量:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[v(m(e.capacity),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[v("负责人:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[v(m(e.managerName),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[v("联系电话:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[v(m(e.contactPhone),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[v("状态:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[v(m(R(e.isActive)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(t,{class:"card-footer"},{default:o((()=>[d(t,{class:"time-info"},{default:o((()=>[d(l,null,{default:o((()=>[v("创建: "+m(e.createTime),1)])),_:2},1024),d(l,null,{default:o((()=>[v("更新: "+m(e.updateTime),1)])),_:2},1024)])),_:2},1024),d(t,{class:"action-buttons"},{default:o((()=>[d(w,{"v-has-perm":["aioveuWarehouse:aioveuProcurement-warehouse:edit"],class:"action-btn edit",onClick:a=>L(e.id)},{default:o((()=>[d(l,null,{default:o((()=>[v("✏️")])),_:1}),d(l,null,{default:o((()=>[v("编辑")])),_:1})])),_:2},1032,["onClick"]),d(w,{"v-has-perm":["aioveuWarehouse:aioveuProcurement-warehouse:delete"],class:"action-btn delete",onClick:a=>Q(e.id)},{default:o((()=>[d(l,null,{default:o((()=>[v("🗑️")])),_:1}),d(l,null,{default:o((()=>[v("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),j.value>0?(c(),u(t,{key:3,class:"pagination"},{default:o((()=>[d(w,{class:"pagination-btn",disabled:z.pageNum<=1,onClick:G},{default:o((()=>[v(" 上一页 ")])),_:1},8,["disabled"]),d(l,{class:"page-info"},{default:o((()=>[v(m(z.pageNum)+" / "+m(Math.ceil(j.value/z.pageSize)),1)])),_:1}),d(w,{class:"pagination-btn",disabled:z.pageNum*z.pageSize>=j.value,onClick:H},{default:o((()=>[v(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):r("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-319eb35a"]]);export{D as default};
