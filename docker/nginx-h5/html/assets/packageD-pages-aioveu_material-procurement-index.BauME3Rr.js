import{d as e,h as a,y as l,al as t,$ as u,Y as s,a as o,w as n,i,o as c,e as f,b as r,s as d,g as v,t as m,a4 as _,a6 as p,a0 as g,c as b,F as h,r as N,X as k,aa as y}from"./index-5U173LQ3.js";import{A as w}from"./aioveu-procurement.sqKFhiud.js";import{D as x}from"./dict.R0KYYCD_.js";import{A as C}from"./aioveu-material.D870okzX.js";import{A as D}from"./aioveu-warehouse.DBFoddqK.js";import{A as P}from"./aioveu-employee.BSG7yiTE.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=j(e({__name:"index",setup(e){const j=a(!1),A=a(!1),I=a([]),T=a(0),V=l({pageNum:1,pageSize:10}),z=a([]),S=a([]),M=a([]),O=a([]),U=a([]),$=a(-1),q=a(-1),B=a(-1),E=a(void 0);t((()=>{ae(),le(),te(),ue(),Y()}));const F=()=>{j.value=!j.value},L=e=>{const a=e.detail.value;$.value=a,M.value[a]&&(V.materialName=M.value[a].value)},W=e=>{const a=e.detail.value;q.value=a,U.value[a]&&(V.applicantName=U.value[a].value)},X=e=>{const a=e.detail.value;B.value=a,S.value[a]&&(V.status=S.value[a].value)},Y=()=>{A.value=!0,w.getPage(V).then((e=>{z.value=e.list||[],T.value=e.total||0})).catch((e=>{console.error("æŸ¥è¯¢é‡‡è´­æµç¨‹å¤±è´¥:",e),u({title:"èŽ·å–æ•°æ®å¤±è´¥",icon:"none"})})).finally((()=>{A.value=!1}))},G=()=>{V.pageNum=1,V.procurementNo="",V.materialName="",V.status=void 0,V.applicantName="",$.value=-1,q.value=-1,B.value=-1,z.value=[],Y()},H=()=>{V.pageNum>1&&(V.pageNum--,Y())},J=()=>{V.pageNum*V.pageSize<T.value&&(V.pageNum++,Y())},K=a(!1);s((()=>{K.value&&(Y(),K.value=!1)}));const Q=e=>{K.value=!0,E.value=e;let a="/packageD/pages/aioveu_material/procurement/form";void 0!==e&&(a+=`?id=${e||""}`),k({url:a})},R=e=>{const a=e?[e]:I.value;0!==a.length?y({title:"è­¦å‘Š",content:"ç¡®è®¤åˆ é™¤å·²é€‰ä¸­çš„æ•°æ®é¡¹?",confirmText:"ç¡®å®š",cancelText:"å–æ¶ˆ",success:e=>{e.confirm&&(A.value=!0,w.deleteByIds(a.join(",")).then((()=>{u({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),Y()})).catch((e=>{console.error("åˆ é™¤å¤±è´¥:",e),u({title:"åˆ é™¤å¤±è´¥",icon:"none"})})).finally((()=>A.value=!1)))}}):u({title:"è¯·é€‰æ‹©è¦åˆ é™¤çš„é¡¹",icon:"none"})},Z=e=>e?e.substring(0,10):"",ee=e=>{const a=S.value.find((a=>a.value===e));return a?a.text:"æœªçŸ¥çŠ¶æ€"},ae=()=>{x.getDictItems("procurement_status").then((e=>{S.value=e.map((e=>({value:Number(e.value),text:e.label})))}))},le=()=>{C.getAllMaterialOptions().then((e=>{M.value=e.map((e=>({value:e.materialName,text:e.materialName})))}))},te=()=>{D.getAllWarehouseOptions().then((e=>{O.value=e.map((e=>({value:e.warehouseName,text:e.warehouseName})))}))},ue=()=>{P.getAllEmployeeOptions().then((e=>{U.value=e.map((e=>({value:e.employeeName,text:e.employeeName})))}))};return(e,a)=>{const l=d,t=i,u=_,s=p,k=g;return c(),o(t,{class:"app-container"},{default:n((()=>[f(t,{class:"search-container"},{default:n((()=>[f(t,{class:"filter-header",onClick:F},{default:n((()=>[f(l,null,{default:n((()=>[v("ðŸ” ç­›é€‰æ¡ä»¶")])),_:1}),f(l,null,{default:n((()=>[v(m(j.value?"â–²":"â–¼"),1)])),_:1})])),_:1}),j.value?(c(),o(t,{key:0,class:"filter-content"},{default:n((()=>[f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("é‡‡è´­ID")])),_:1}),f(u,{type:"text",class:"filter-input",placeholder:"è¯·è¾“å…¥é‡‡è´­ID",modelValue:V.id,"onUpdate:modelValue":a[0]||(a[0]=e=>V.id=e),onConfirm:Y},null,8,["modelValue"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("é‡‡è´­å•å·")])),_:1}),f(u,{type:"text",class:"filter-input",placeholder:"è¯·è¾“å…¥é‡‡è´­å•å·",modelValue:V.procurementNo,"onUpdate:modelValue":a[1]||(a[1]=e=>V.procurementNo=e),onConfirm:Y},null,8,["modelValue"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("ç‰©èµ„")])),_:1}),f(s,{class:"filter-picker",mode:"selector",range:M.value,"range-key":"text",value:$.value,onChange:L},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(m($.value>=0?M.value[$.value].text:"è¯·é€‰æ‹©ç‰©èµ„"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("çŠ¶æ€")])),_:1}),f(s,{class:"filter-picker",mode:"selector",range:S.value,"range-key":"text",value:B.value,onChange:X},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(m(B.value>=0?S.value[B.value].text:"è¯·é€‰æ‹©çŠ¶æ€"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("ç”³è¯·äºº")])),_:1}),f(s,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"text",value:q.value,onChange:W},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(m(q.value>=0?U.value[q.value].text:"è¯·é€‰æ‹©ç”³è¯·äºº"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-buttons"},{default:n((()=>[f(k,{class:"filter-btn reset",onClick:G},{default:n((()=>[v("é‡ç½®")])),_:1}),f(k,{class:"filter-btn confirm",onClick:Y},{default:n((()=>[v("æœç´¢")])),_:1})])),_:1})])),_:1})):r("",!0)])),_:1}),f(t,{class:"action-buttons"},{default:n((()=>[f(k,{"v-has-perm":["aioveuProcurement:aioveuProcurement-procurement:add"],class:"action-btn add",onClick:a[2]||(a[2]=e=>Q())},{default:n((()=>[f(l,null,{default:n((()=>[v("+")])),_:1}),f(l,null,{default:n((()=>[v("æ–°å¢ž")])),_:1})])),_:1}),f(k,{"v-has-perm":["aioveuProcurement:aioveuProcurement-procurement:delete"],class:"action-btn delete",disabled:0===I.value.length,onClick:a[3]||(a[3]=e=>R())},{default:n((()=>[f(l,null,{default:n((()=>[v("ðŸ—‘ï¸")])),_:1}),f(l,null,{default:n((()=>[v("åˆ é™¤")])),_:1})])),_:1},8,["disabled"])])),_:1}),f(t,{class:"list-container"},{default:n((()=>[A.value?(c(),o(t,{key:0,class:"loading-state"},{default:n((()=>[f(l,null,{default:n((()=>[v("åŠ è½½ä¸­...")])),_:1})])),_:1})):0===z.value.length?(c(),o(t,{key:1,class:"empty-state"},{default:n((()=>[f(l,{class:"empty-icon"},{default:n((()=>[v("ðŸ“")])),_:1}),f(l,{class:"empty-text"},{default:n((()=>[v("æš‚æ— é‡‡è´­æ•°æ®")])),_:1})])),_:1})):(c(!0),b(h,{key:2},N(z.value,(e=>(c(),o(t,{key:e.id,class:"procurement-card"},{default:n((()=>[f(t,{class:"card-header"},{default:n((()=>[f(l,{class:"procurement-id"},{default:n((()=>[v("ID: "+m(e.id),1)])),_:2},1024),f(l,{class:"procurement-no"},{default:n((()=>[v(m(e.procurementNo),1)])),_:2},1024)])),_:2},1024),f(t,{class:"card-content"},{default:n((()=>[f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("ç‰©èµ„:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(e.materialName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("é‡‡è´­æ•°é‡:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(e.quantity),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("é‡‡è´­å•ä»·:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(e.unitPrice),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("æ€»é‡‘é¢:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(e.totalAmount),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("ä¸‹å•æ—¶é—´:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(Z(e.orderDate)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("é¢„è®¡åˆ°è´§:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(Z(e.expectedDelivery)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("å®žé™…åˆ°è´§:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(Z(e.actualDelivery)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("ç­¾æ”¶æ—¶é—´:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(Z(e.receiptDate)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("å…¥åº“ä»“åº“:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(e.warehouseName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("å…¥åº“æ—¶é—´:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(Z(e.inboundDate)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("çŠ¶æ€:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(ee(e.status)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("ç”³è¯·äºº:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(e.applicantName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("å®¡æ ¸äºº:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(e.reviewerName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("å®¡æ ¸æ—¶é—´:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(m(Z(e.reviewTime)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),f(t,{class:"card-footer"},{default:n((()=>[f(t,{class:"time-info"},{default:n((()=>[f(l,null,{default:n((()=>[v("åˆ›å»º: "+m(Z(e.createTime)),1)])),_:2},1024),f(l,null,{default:n((()=>[v("æ›´æ–°: "+m(Z(e.updateTime)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"action-buttons"},{default:n((()=>[f(k,{"v-has-perm":["aioveuProcurement:aioveuProcurement-procurement:edit"],class:"action-btn edit",onClick:a=>Q(e.id)},{default:n((()=>[f(l,null,{default:n((()=>[v("âœï¸")])),_:1}),f(l,null,{default:n((()=>[v("ç¼–è¾‘")])),_:1})])),_:2},1032,["onClick"]),f(k,{"v-has-perm":["aioveuProcurement:aioveuProcurement-procurement:delete"],class:"action-btn delete",onClick:a=>R(e.id)},{default:n((()=>[f(l,null,{default:n((()=>[v("ðŸ—‘ï¸")])),_:1}),f(l,null,{default:n((()=>[v("åˆ é™¤")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),T.value>0?(c(),o(t,{key:0,class:"pagination"},{default:n((()=>[f(k,{class:"pagination-btn",disabled:V.pageNum<=1,onClick:H},{default:n((()=>[v(" ä¸Šä¸€é¡µ ")])),_:1},8,["disabled"]),f(l,{class:"page-info"},{default:n((()=>[v(m(V.pageNum)+" / "+m(Math.ceil(T.value/V.pageSize)),1)])),_:1}),f(k,{class:"pagination-btn",disabled:V.pageNum*V.pageSize>=T.value,onClick:J},{default:n((()=>[v(" ä¸‹ä¸€é¡µ ")])),_:1},8,["disabled"])])),_:1})):r("",!0)])),_:1})}}}),[["__scopeId","data-v-64d186a9"]]);export{A as default};
