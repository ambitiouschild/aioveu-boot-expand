import{d as e,h as a,y as l,al as o,$ as t,a as s,w as u,i as r,o as m,e as n,s as c,g as d,t as i,ay as f,a6 as p,a4 as y,a0 as v,aI as _,a3 as b,aJ as V}from"./index-5U173LQ3.js";import{A as h}from"./aioveu-salary.Czli4oVC.js";import{A as g}from"./aioveu-employee.CCWXpWw-.js";import{D as S}from"./dict.R0KYYCD_.js";import{_ as N}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=N(e({__name:"form",setup(e){const N=a("新增工资"),w=a(void 0),k=a(!1),D=l({employeeName:"",baseSalary:void 0,performanceBonus:void 0,overtimePay:void 0,allowances:void 0,socialSecurity:void 0,housingFund:void 0,tax:void 0,otherDeductions:void 0,netSalary:void 0,paymentStatus:void 0}),U=a([]),x=a([]),I=a(-1),P=a(-1);o((e=>{console.log("页面参数:",e),C(),A(),e.id?(w.value=Number(e.id),N.value="编辑工资",j()):N.value="新增工资"}));const j=async()=>{if(w.value)try{k.value=!0;const e=await h.getFormData(w.value);if(Object.assign(D,e),D.employeeName){const e=U.value.findIndex((e=>e.employeeName===D.employeeName));I.value=e}if(void 0!==D.paymentStatus){const e=x.value.findIndex((e=>Number(e.value)===D.paymentStatus));P.value=e}}catch(e){console.error("加载工资数据失败:",e),t({title:"加载数据失败",icon:"none"})}finally{k.value=!1}},C=async()=>{try{const e=await g.getAllEmployeeOptions();Array.isArray(e)&&(U.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))}catch(e){console.error("加载员工列表失败:",e),t({title:"加载员工列表失败",icon:"none"})}},A=async()=>{try{const e=await S.getDictItems("salary_payment_status");x.value=e}catch(e){console.error("加载发放状态失败:",e),t({title:"加载发放状态失败",icon:"none"})}},F=e=>{const a=e.detail.value;I.value=a,U.value[a]&&(D.employeeName=U.value[a].employeeName)},B=e=>{D.salaryPeriod=e.detail.value},J=e=>{D.paymentDate=e.detail.value},O=e=>{const a=e.detail.value;P.value=a,x.value[a]&&(D.paymentStatus=Number(x.value[a].value))},E=async()=>{if(G())try{_({title:"提交中..."}),w.value?(await h.update(w.value,D),t({title:"修改成功",icon:"success"})):(await h.add(D),t({title:"新增成功",icon:"success"})),b()}catch(e){console.error("提交表单失败:",e),t({title:"提交失败",icon:"none"})}finally{V()}},G=()=>D.employeeName?D.salaryPeriod?D.baseSalary?D.netSalary?void 0!==D.paymentStatus||(t({title:"请选择发放状态",icon:"none"}),!1):(t({title:"请输入实发工资",icon:"none"}),!1):(t({title:"请输入基本工资",icon:"none"}),!1):(t({title:"请选择工资周期",icon:"none"}),!1):(t({title:"请选择员工",icon:"none"}),!1),$=()=>{b()};return(e,a)=>{const l=c,o=r,t=p,_=y,b=f,V=v;return m(),s(o,{class:"form-container"},{default:u((()=>[n(o,{class:"form-header"},{default:u((()=>[n(l,{class:"form-title"},{default:u((()=>[d(i(N.value),1)])),_:1})])),_:1}),n(b,{class:"form-body scroll-y","scroll-y":""},{default:u((()=>[n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("员工")])),_:1}),n(t,{class:"form-picker",mode:"selector",range:U.value,"range-key":"employeeName",value:I.value,onChange:F},{default:u((()=>[n(o,{class:"picker-view"},{default:u((()=>[d(i(I.value>=0?U.value[I.value].employeeName:"请选择员工"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("工资周期")])),_:1}),n(t,{class:"form-picker",mode:"date",value:D.salaryPeriod,onChange:B},{default:u((()=>[n(o,{class:"picker-view"},{default:u((()=>[d(i(D.salaryPeriod||"请选择工资周期"),1)])),_:1})])),_:1},8,["value"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("基本工资")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入基本工资",modelValue:D.baseSalary,"onUpdate:modelValue":a[0]||(a[0]=e=>D.baseSalary=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("绩效奖金")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入绩效奖金",modelValue:D.performanceBonus,"onUpdate:modelValue":a[1]||(a[1]=e=>D.performanceBonus=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("加班补贴")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入加班补贴",modelValue:D.overtimePay,"onUpdate:modelValue":a[2]||(a[2]=e=>D.overtimePay=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("各类津贴")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入各类津贴",modelValue:D.allowances,"onUpdate:modelValue":a[3]||(a[3]=e=>D.allowances=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("社保扣除")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入社保扣除",modelValue:D.socialSecurity,"onUpdate:modelValue":a[4]||(a[4]=e=>D.socialSecurity=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("住房公积金")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入住房公积金",modelValue:D.housingFund,"onUpdate:modelValue":a[5]||(a[5]=e=>D.housingFund=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("个人所得税")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入个人所得税",modelValue:D.tax,"onUpdate:modelValue":a[6]||(a[6]=e=>D.tax=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("其他扣款")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入其他扣款",modelValue:D.otherDeductions,"onUpdate:modelValue":a[7]||(a[7]=e=>D.otherDeductions=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("实发工资")])),_:1}),n(_,{type:"number",class:"form-input",placeholder:"请输入实发工资",modelValue:D.netSalary,"onUpdate:modelValue":a[8]||(a[8]=e=>D.netSalary=e)},null,8,["modelValue"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("实际发放日期")])),_:1}),n(t,{class:"form-picker",mode:"date",value:D.paymentDate,onChange:J},{default:u((()=>[n(o,{class:"picker-view"},{default:u((()=>[d(i(D.paymentDate||"请选择发放日期"),1)])),_:1})])),_:1},8,["value"])])),_:1}),n(o,{class:"form-item"},{default:u((()=>[n(l,{class:"form-label"},{default:u((()=>[d("发放状态")])),_:1}),n(t,{class:"form-picker",mode:"selector",range:x.value,"range-key":"label",value:P.value,onChange:O},{default:u((()=>[n(o,{class:"picker-view"},{default:u((()=>[d(i(P.value>=0?x.value[P.value].label:"请选择发放状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1})])),_:1}),n(o,{class:"form-footer"},{default:u((()=>[n(V,{class:"form-btn cancel",onClick:$},{default:u((()=>[d("取消")])),_:1}),n(V,{class:"form-btn confirm",onClick:E},{default:u((()=>[d("提交")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-a3b5925b"]]);export{w as default};
