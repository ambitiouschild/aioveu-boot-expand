import{d as e,h as a,y as l,Y as t,z as s,a as u,w as n,$ as i,i as o,o as d,e as c,b as f,s as r,g as m,t as _,a4 as v,a6 as p,a0 as y,c as b,F as g,r as h,X as k,aa as N,aI as S,aJ as C}from"./index-5U173LQ3.js";import{A as I}from"./aioveu-salary.Czli4oVC.js";import{A as V}from"./aioveu-employee.CCWXpWw-.js";import{D as w}from"./dict.R0KYYCD_.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=D(e({__name:"index",setup(e){const D=a(!1),j=a([]),x=a(0),z=a(!1),A=l({pageNum:1,pageSize:10}),U=a([]),J=a([]),P=a([]),T=a(-1),$=a(-1),B=a(void 0),E=()=>{z.value=!z.value},F=e=>{const a=e.detail.value;T.value=a,J.value[a]&&(A.employeeName=J.value[a].employeeName)},G=e=>{const a=e.detail.value;$.value=a,P.value[a]&&(A.paymentStatus=Number(P.value[a].value))},M=()=>{D.value=!0,I.getPage(A).then((e=>{U.value=e.list,x.value=e.total})).catch((e=>{console.error("查询工资失败:",e),i({title:"加载数据失败",icon:"none"})})).finally((()=>{D.value=!1}))},O=()=>{A.pageNum=1,A.employeeName="",A.baseSalary=void 0,A.netSalary=void 0,A.paymentStatus=void 0,T.value=-1,$.value=-1,U.value=[],M()},X=()=>{A.pageNum>1&&(A.pageNum--,M())},Y=()=>{A.pageNum*A.pageSize<x.value&&(A.pageNum++,M())},q=a(!1);t((()=>{q.value&&(M(),q.value=!1)}));const H=e=>{q.value=!0,B.value=e;let a="/packageC/pages/aioveu_department/salary/form";void 0!==e&&(a+=`?id=${e}`),k({url:a})},K=e=>{const a=e?[e]:j.value;0!==a.length?N({title:"提示",content:"确认删除选中的工资记录吗？",success:e=>{e.confirm&&(S({title:"删除中..."}),I.deleteByIds(a.join(",")).then((()=>{i({title:"删除成功",icon:"success"}),O()})).catch((e=>{console.error("删除失败:",e),i({title:"删除失败",icon:"none"})})).finally((()=>C())))}}):i({title:"请选择要删除的工资记录",icon:"none"})},L=e=>{const a=P.value.find((a=>Number(a.value)===e));return a?a.label:"未知"};return s((()=>{M(),V.getAllEmployeeOptions().then((e=>{Array.isArray(e)&&(J.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))})).catch((e=>{console.error("加载员工选项失败:",e),i({title:"加载员工列表失败",icon:"none"})})),w.getDictItems("salary_payment_status").then((e=>{P.value=e}))})),(e,a)=>{const l=r,t=o,s=v,i=p,k=y;return d(),u(t,{class:"app-container"},{default:n((()=>[c(t,{class:"search-container"},{default:n((()=>[c(t,{class:"filter-header",onClick:E},{default:n((()=>[c(l,null,{default:n((()=>[m("🔍 筛选条件")])),_:1}),c(l,null,{default:n((()=>[m(_(z.value?"▲":"▼"),1)])),_:1})])),_:1}),z.value?(d(),u(t,{key:0,class:"filter-content"},{default:n((()=>[c(t,{class:"filter-item"},{default:n((()=>[c(l,{class:"filter-label"},{default:n((()=>[m("工资记录ID")])),_:1}),c(s,{type:"text",class:"filter-input",placeholder:"请输入工资记录ID",modelValue:A.id,"onUpdate:modelValue":a[0]||(a[0]=e=>A.id=e),onConfirm:M},null,8,["modelValue"])])),_:1}),c(t,{class:"filter-item"},{default:n((()=>[c(l,{class:"filter-label"},{default:n((()=>[m("员工")])),_:1}),c(i,{class:"filter-picker",mode:"selector",range:J.value,"range-key":"employeeName",value:T.value,onChange:F},{default:n((()=>[c(t,{class:"picker-view"},{default:n((()=>[m(_(T.value>=0?J.value[T.value].employeeName:"请选择员工"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),c(t,{class:"filter-item"},{default:n((()=>[c(l,{class:"filter-label"},{default:n((()=>[m("基本工资")])),_:1}),c(s,{type:"number",class:"filter-input",placeholder:"请输入基本工资",modelValue:A.baseSalary,"onUpdate:modelValue":a[1]||(a[1]=e=>A.baseSalary=e),onConfirm:M},null,8,["modelValue"])])),_:1}),c(t,{class:"filter-item"},{default:n((()=>[c(l,{class:"filter-label"},{default:n((()=>[m("实发工资")])),_:1}),c(s,{type:"number",class:"filter-input",placeholder:"请输入实发工资",modelValue:A.netSalary,"onUpdate:modelValue":a[2]||(a[2]=e=>A.netSalary=e),onConfirm:M},null,8,["modelValue"])])),_:1}),c(t,{class:"filter-item"},{default:n((()=>[c(l,{class:"filter-label"},{default:n((()=>[m("发放状态")])),_:1}),c(i,{class:"filter-picker",mode:"selector",range:P.value,"range-key":"label",value:$.value,onChange:G},{default:n((()=>[c(t,{class:"picker-view"},{default:n((()=>[m(_($.value>=0?P.value[$.value].label:"请选择发放状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),c(t,{class:"filter-buttons"},{default:n((()=>[c(k,{class:"filter-btn reset",onClick:O},{default:n((()=>[m("重置")])),_:1}),c(k,{class:"filter-btn confirm",onClick:M},{default:n((()=>[m("搜索")])),_:1})])),_:1})])),_:1})):f("",!0)])),_:1}),c(t,{class:"action-buttons"},{default:n((()=>[c(k,{"v-has-perm":["aioveuSalary:aioveu-salary:add"],class:"action-btn add",onClick:a[3]||(a[3]=e=>H())},{default:n((()=>[c(l,null,{default:n((()=>[m("+")])),_:1}),c(l,null,{default:n((()=>[m("新增")])),_:1})])),_:1}),c(k,{"v-has-perm":["aioveuSalary:aioveu-salary:delete"],class:"action-btn delete",disabled:0===j.value.length,onClick:a[4]||(a[4]=e=>K())},{default:n((()=>[c(l,null,{default:n((()=>[m("🗑️")])),_:1}),c(l,null,{default:n((()=>[m("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),c(t,{class:"list-container"},{default:n((()=>[D.value?(d(),u(t,{key:0,class:"loading-state"},{default:n((()=>[c(l,null,{default:n((()=>[m("加载中...")])),_:1})])),_:1})):0===U.value.length?(d(),u(t,{key:1,class:"empty-state"},{default:n((()=>[c(l,{class:"empty-icon"},{default:n((()=>[m("💰")])),_:1}),c(l,{class:"empty-text"},{default:n((()=>[m("暂无工资数据")])),_:1})])),_:1})):(d(!0),b(g,{key:2},h(U.value,(e=>(d(),u(t,{key:e.id,class:"salary-card"},{default:n((()=>[c(t,{class:"card-header"},{default:n((()=>[c(l,{class:"salary-id"},{default:n((()=>[m("ID: "+_(e.id),1)])),_:2},1024),c(l,{class:"employee-name"},{default:n((()=>[m(_(e.employeeName),1)])),_:2},1024)])),_:2},1024),c(t,{class:"card-content"},{default:n((()=>[c(t,{class:"info-row"},{default:n((()=>[c(l,{class:"info-label"},{default:n((()=>[m("工资周期:")])),_:1}),c(l,{class:"info-value"},{default:n((()=>[m(_(e.salaryPeriod),1)])),_:2},1024)])),_:2},1024),c(t,{class:"info-row"},{default:n((()=>[c(l,{class:"info-label"},{default:n((()=>[m("基本工资:")])),_:1}),c(l,{class:"info-value"},{default:n((()=>[m(_(e.baseSalary),1)])),_:2},1024)])),_:2},1024),c(t,{class:"info-row"},{default:n((()=>[c(l,{class:"info-label"},{default:n((()=>[m("实发工资:")])),_:1}),c(l,{class:"info-value"},{default:n((()=>[m(_(e.netSalary),1)])),_:2},1024)])),_:2},1024),c(t,{class:"info-row"},{default:n((()=>[c(l,{class:"info-label"},{default:n((()=>[m("发放状态:")])),_:1}),c(l,{class:"info-value"},{default:n((()=>[m(_(L(e.paymentStatus)),1)])),_:2},1024)])),_:2},1024),c(t,{class:"info-row"},{default:n((()=>[c(l,{class:"info-label"},{default:n((()=>[m("发放日期:")])),_:1}),c(l,{class:"info-value"},{default:n((()=>[m(_(e.paymentDate||"未发放"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),c(t,{class:"card-footer"},{default:n((()=>[c(t,{class:"time-info"},{default:n((()=>[c(l,null,{default:n((()=>[m("创建: "+_(e.createTime),1)])),_:2},1024),c(l,null,{default:n((()=>[m("更新: "+_(e.updateTime),1)])),_:2},1024)])),_:2},1024),c(t,{class:"action-buttons"},{default:n((()=>[c(k,{"v-has-perm":["aioveuSalary:aioveu-salary:edit"],class:"action-btn edit",onClick:a=>H(e.id)},{default:n((()=>[c(l,null,{default:n((()=>[m("✏️")])),_:1}),c(l,null,{default:n((()=>[m("编辑")])),_:1})])),_:2},1032,["onClick"]),c(k,{"v-has-perm":["aioveuSalary:aioveu-salary:delete"],class:"action-btn delete",onClick:a=>K(e.id)},{default:n((()=>[c(l,null,{default:n((()=>[m("🗑️")])),_:1}),c(l,null,{default:n((()=>[m("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),x.value>0?(d(),u(t,{key:3,class:"pagination"},{default:n((()=>[c(k,{class:"pagination-btn",disabled:A.pageNum<=1,onClick:X},{default:n((()=>[m(" 上一页 ")])),_:1},8,["disabled"]),c(l,{class:"page-info"},{default:n((()=>[m(_(A.pageNum)+" / "+_(Math.ceil(x.value/A.pageSize)),1)])),_:1}),c(k,{class:"pagination-btn",disabled:A.pageNum*A.pageSize>=x.value,onClick:Y},{default:n((()=>[m(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):f("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-dfa8fc83"]]);export{j as default};
