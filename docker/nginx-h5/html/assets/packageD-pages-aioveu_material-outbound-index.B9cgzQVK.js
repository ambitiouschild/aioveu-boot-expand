import{d as e,h as a,y as l,al as t,$ as u,Y as s,a as o,w as i,i as n,o as d,e as f,b as c,s as r,g as v,t as _,a4 as m,a6 as p,a0 as b,c as g,F as h,r as N,X as k,aa as y}from"./index-5U173LQ3.js";import{A as x}from"./aioveu-outbound.BtRxSKMm.js";import{D as w}from"./dict.R0KYYCD_.js";import{A as C}from"./aioveu-material.D870okzX.js";import{A as j}from"./aioveu-warehouse.DBFoddqK.js";import{A}from"./aioveu-department.N5KmT_PM.js";import{A as D}from"./aioveu-employee.BSG7yiTE.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const O=I(e({__name:"index",setup(e){const I=a(!1),O=a(!1),V=a([]),S=a(0),T=l({pageNum:1,pageSize:10}),z=a([]),M=a([]),U=a([]),$=a([]),q=a([]),B=a([]),E=a(-1),F=a(-1),L=a(-1),P=a(-1),W=a(void 0);t((()=>{se(),oe(),ie(),ne(),de(),K()}));const X=()=>{I.value=!I.value},Y=e=>{const a=e.detail.value;E.value=a,U.value[a]&&(T.materialName=U.value[a].value)},G=e=>{const a=e.detail.value;F.value=a,$.value[a]&&(T.warehouseName=$.value[a].value)},H=e=>{const a=e.detail.value;L.value=a,B.value[a]&&(T.recipientName=B.value[a].value)},J=e=>{const a=e.detail.value;P.value=a,M.value[a]&&(T.status=M.value[a].value)},K=()=>{O.value=!0,x.getPage(T).then((e=>{z.value=e.list||[],S.value=e.total||0})).catch((e=>{console.error("查询出库记录失败:",e),u({title:"获取数据失败",icon:"none"})})).finally((()=>{O.value=!1}))},Q=()=>{T.pageNum=1,T.outboundNo="",T.materialName="",T.warehouseName="",T.recipientName="",T.status=void 0,E.value=-1,F.value=-1,L.value=-1,P.value=-1,z.value=[],K()},R=()=>{T.pageNum>1&&(T.pageNum--,K())},Z=()=>{T.pageNum*T.pageSize<S.value&&(T.pageNum++,K())},ee=a(!1);s((()=>{ee.value&&(K(),ee.value=!1)}));const ae=e=>{ee.value=!0,W.value=e;let a="/packageD/pages/aioveu_material/outbound/form";void 0!==e&&(a+=`?id=${e}`),k({url:a})},le=e=>{const a=e?[e]:V.value;0!==a.length?y({title:"提示",content:"确认删除选中的出库记录吗？",confirmText:"确定",cancelText:"取消",success:e=>{e.confirm&&(O.value=!0,x.deleteByIds(a.join(",")).then((()=>{u({title:"删除成功",icon:"success"}),K()})).catch((e=>{console.error("删除失败:",e),u({title:"删除失败",icon:"none"})})).finally((()=>{O.value=!1})))}}):u({title:"请选择要删除的出库记录",icon:"none"})},te=e=>e?e.substring(0,10):"",ue=e=>{const a=M.value.find((a=>a.value===e));return a?a.text:"未知状态"},se=()=>{w.getDictItems("outbound_status").then((e=>{M.value=e.map((e=>({value:Number(e.value),text:e.label})))}))},oe=()=>{C.getAllMaterialOptions().then((e=>{U.value=e.map((e=>({value:e.materialName,text:e.materialName})))}))},ie=()=>{j.getAllWarehouseOptions().then((e=>{$.value=e.map((e=>({value:e.warehouseName,text:e.warehouseName})))}))},ne=()=>{A.getAllDepartmentOptions().then((e=>{q.value=e.map((e=>({value:e.deptName,text:e.deptName})))}))},de=()=>{D.getAllEmployeeOptions().then((e=>{B.value=e.map((e=>({value:e.employeeName,text:e.employeeName})))}))};return(e,a)=>{const l=r,t=n,u=m,s=p,k=b;return d(),o(t,{class:"app-container"},{default:i((()=>[f(t,{class:"search-container"},{default:i((()=>[f(t,{class:"filter-header",onClick:X},{default:i((()=>[f(l,null,{default:i((()=>[v("🔍 筛选条件")])),_:1}),f(l,null,{default:i((()=>[v(_(I.value?"▲":"▼"),1)])),_:1})])),_:1}),I.value?(d(),o(t,{key:0,class:"filter-content"},{default:i((()=>[f(t,{class:"filter-item"},{default:i((()=>[f(l,{class:"filter-label"},{default:i((()=>[v("出库ID")])),_:1}),f(u,{type:"text",class:"filter-input",placeholder:"请输入出库ID",modelValue:T.id,"onUpdate:modelValue":a[0]||(a[0]=e=>T.id=e),onConfirm:K},null,8,["modelValue"])])),_:1}),f(t,{class:"filter-item"},{default:i((()=>[f(l,{class:"filter-label"},{default:i((()=>[v("出库单号")])),_:1}),f(u,{type:"text",class:"filter-input",placeholder:"请输入出库单号",modelValue:T.outboundNo,"onUpdate:modelValue":a[1]||(a[1]=e=>T.outboundNo=e),onConfirm:K},null,8,["modelValue"])])),_:1}),f(t,{class:"filter-item"},{default:i((()=>[f(l,{class:"filter-label"},{default:i((()=>[v("物资")])),_:1}),f(s,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"text",value:E.value,onChange:Y},{default:i((()=>[f(t,{class:"picker-view"},{default:i((()=>[v(_(E.value>=0?U.value[E.value].text:"请选择物资"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:i((()=>[f(l,{class:"filter-label"},{default:i((()=>[v("仓库")])),_:1}),f(s,{class:"filter-picker",mode:"selector",range:$.value,"range-key":"text",value:F.value,onChange:G},{default:i((()=>[f(t,{class:"picker-view"},{default:i((()=>[v(_(F.value>=0?$.value[F.value].text:"请选择仓库"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:i((()=>[f(l,{class:"filter-label"},{default:i((()=>[v("领用人")])),_:1}),f(s,{class:"filter-picker",mode:"selector",range:B.value,"range-key":"text",value:L.value,onChange:H},{default:i((()=>[f(t,{class:"picker-view"},{default:i((()=>[v(_(L.value>=0?B.value[L.value].text:"请选择领用人"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:i((()=>[f(l,{class:"filter-label"},{default:i((()=>[v("状态")])),_:1}),f(s,{class:"filter-picker",mode:"selector",range:M.value,"range-key":"text",value:P.value,onChange:J},{default:i((()=>[f(t,{class:"picker-view"},{default:i((()=>[v(_(P.value>=0?M.value[P.value].text:"请选择状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-buttons"},{default:i((()=>[f(k,{class:"filter-btn reset",onClick:Q},{default:i((()=>[v("重置")])),_:1}),f(k,{class:"filter-btn confirm",onClick:K},{default:i((()=>[v("搜索")])),_:1})])),_:1})])),_:1})):c("",!0)])),_:1}),f(t,{class:"action-buttons"},{default:i((()=>[f(k,{"v-has-perm":["aioveuOutbound:aioveu-outbound:add"],class:"action-btn add",onClick:a[2]||(a[2]=e=>ae())},{default:i((()=>[f(l,null,{default:i((()=>[v("+")])),_:1}),f(l,null,{default:i((()=>[v("新增")])),_:1})])),_:1}),f(k,{"v-has-perm":["aioveuOutbound:aioveu-outbound:delete"],class:"action-btn delete",disabled:0===V.value.length,onClick:a[3]||(a[3]=e=>le())},{default:i((()=>[f(l,null,{default:i((()=>[v("🗑️")])),_:1}),f(l,null,{default:i((()=>[v("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),f(t,{class:"list-container"},{default:i((()=>[O.value?(d(),o(t,{key:0,class:"loading-state"},{default:i((()=>[f(l,null,{default:i((()=>[v("加载中...")])),_:1})])),_:1})):0===z.value.length?(d(),o(t,{key:1,class:"empty-state"},{default:i((()=>[f(l,{class:"empty-icon"},{default:i((()=>[v("📁")])),_:1}),f(l,{class:"empty-text"},{default:i((()=>[v("暂无出库数据")])),_:1})])),_:1})):(d(!0),g(h,{key:2},N(z.value,(e=>(d(),o(t,{key:e.id,class:"outbound-card"},{default:i((()=>[f(t,{class:"card-header"},{default:i((()=>[f(l,{class:"outbound-id"},{default:i((()=>[v("ID: "+_(e.id),1)])),_:2},1024),f(l,{class:"outbound-no"},{default:i((()=>[v(_(e.outboundNo),1)])),_:2},1024)])),_:2},1024),f(t,{class:"card-content"},{default:i((()=>[f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("物资:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.materialName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("仓库:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.warehouseName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("出库数量:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.quantity),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("批次号:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.batchNumber),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("出库时间:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(te(e.outTime)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("操作员:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.operatorName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("领用人:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.recipientName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("领用部门:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.departmentName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("用途说明:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.purpose),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("关联项目ID:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(e.projectId),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:i((()=>[f(l,{class:"info-label"},{default:i((()=>[v("状态:")])),_:1}),f(l,{class:"info-value"},{default:i((()=>[v(_(ue(e.status)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),f(t,{class:"card-footer"},{default:i((()=>[f(t,{class:"time-info"},{default:i((()=>[f(l,null,{default:i((()=>[v("创建: "+_(te(e.createTime)),1)])),_:2},1024),f(l,null,{default:i((()=>[v("更新: "+_(te(e.updateTime)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"action-buttons"},{default:i((()=>[f(k,{"v-has-perm":["aioveuOutbound:aioveu-outbound:edit"],class:"action-btn edit",onClick:a=>ae(e.id)},{default:i((()=>[f(l,null,{default:i((()=>[v("✏️")])),_:1}),f(l,null,{default:i((()=>[v("编辑")])),_:1})])),_:2},1032,["onClick"]),f(k,{"v-has-perm":["aioveuOutbound:aioveu-outbound:delete"],class:"action-btn delete",onClick:a=>le(e.id)},{default:i((()=>[f(l,null,{default:i((()=>[v("🗑️")])),_:1}),f(l,null,{default:i((()=>[v("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),S.value>0?(d(),o(t,{key:0,class:"pagination"},{default:i((()=>[f(k,{class:"pagination-btn",disabled:T.pageNum<=1,onClick:R},{default:i((()=>[v(" 上一页 ")])),_:1},8,["disabled"]),f(l,{class:"page-info"},{default:i((()=>[v(_(T.pageNum)+" / "+_(Math.ceil(S.value/T.pageSize)),1)])),_:1}),f(k,{class:"pagination-btn",disabled:T.pageNum*T.pageSize>=S.value,onClick:Z},{default:i((()=>[v(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):c("",!0)])),_:1})}}}),[["__scopeId","data-v-6f425c51"]]);export{O as default};
