import{d as e,h as a,y as l,Y as t,z as u,a as s,w as o,i as n,o as r,e as i,b as d,s as c,g as f,t as m,a4 as p,a6 as v,a0 as _,c as g,F as b,r as y,X as k,$ as h,aa as N,aI as C,aJ as I}from"./index-5U173LQ3.js";import{A as P}from"./aioveu-performance.wTi-7WFQ.js";import{A as w}from"./aioveu-employee.CCWXpWw-.js";import{D as V}from"./dict.R0KYYCD_.js";import{_ as S}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D=S(e({__name:"index",setup(e){const S=a(!1),D=a([]),j=a(0),x=a(!1),z=l({pageNum:1,pageSize:10}),A=a([]),G=a([]),Y=a([]),K=a([]),Q=a(-1),U=a(-1),T=a(-1),$=()=>{x.value=!x.value},q=e=>{const a=e.detail.value;Q.value=a,G.value[a]&&(z.employeeName=G.value[a].employeeName)},B=e=>{const a=e.detail.value;U.value=a,Y.value[a]&&(z.periodQuarter=Number(Y.value[a].value))},E=e=>{const a=e.detail.value;T.value=a,K.value[a]&&(z.performanceGrade=K.value[a].value.toString())},F=()=>{S.value=!0,P.getPage(z).then((e=>{A.value=e.list,j.value=e.total})).finally((()=>{S.value=!1}))},J=()=>{z.pageNum=1,z.employeeName="",z.periodQuarter=void 0,z.performanceGrade="",Q.value=-1,U.value=-1,T.value=-1,A.value=[],F()},M=()=>{z.pageNum>1&&(z.pageNum--,F())},O=()=>{z.pageNum*z.pageSize<j.value&&(z.pageNum++,F())},X=a(!1);t((()=>{X.value&&(F(),X.value=!1)}));const H=e=>{X.value=!0;let a="/packageC/pages/aioveu_department/performance/form";void 0!==e&&(a+=`?id=${e}`),console.log("跳转到:",a),k({url:a})},L=e=>{const a=e?[e]:D.value;0!==a.length?N({title:"提示",content:"确认删除选中的绩效记录吗？",success:e=>{e.confirm&&(C({title:"删除中..."}),P.deleteByIds(a.join(",")).then((()=>{h({title:"删除成功",icon:"success"}),J()})).finally((()=>I())))}}):h({title:"请选择要删除的绩效记录",icon:"none"})},R=e=>{const a=Y.value.find((a=>Number(a.value)===e));return a?a.label:"未知季度"},W=e=>{const a=K.value.find((a=>a.value===e));return a?a.label:"未知等级"};return u((()=>{F(),w.getAllEmployeeOptions().then((e=>{Array.isArray(e)&&(G.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))})),V.getDictItems("performance_period_quarter").then((e=>{Y.value=e})),V.getDictItems("performance_grade").then((e=>{K.value=e}))})),(e,a)=>{const l=c,t=n,u=p,k=v,h=_;return r(),s(t,{class:"app-container"},{default:o((()=>[i(t,{class:"search-container"},{default:o((()=>[i(t,{class:"filter-header",onClick:$},{default:o((()=>[i(l,null,{default:o((()=>[f("🔍 筛选条件")])),_:1}),i(l,null,{default:o((()=>[f(m(x.value?"▲":"▼"),1)])),_:1})])),_:1}),x.value?(r(),s(t,{key:0,class:"filter-content"},{default:o((()=>[i(t,{class:"filter-item"},{default:o((()=>[i(l,{class:"filter-label"},{default:o((()=>[f("绩效记录ID")])),_:1}),i(u,{type:"text",class:"filter-input",placeholder:"请输入绩效记录ID",modelValue:z.id,"onUpdate:modelValue":a[0]||(a[0]=e=>z.id=e),onConfirm:F},null,8,["modelValue"])])),_:1}),i(t,{class:"filter-item"},{default:o((()=>[i(l,{class:"filter-label"},{default:o((()=>[f("员工")])),_:1}),i(k,{class:"filter-picker",mode:"selector",range:G.value,"range-key":"employeeName",value:Q.value,onChange:q},{default:o((()=>[i(t,{class:"picker-view"},{default:o((()=>[f(m(Q.value>=0?G.value[Q.value].employeeName:"请选择员工"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),i(t,{class:"filter-item"},{default:o((()=>[i(l,{class:"filter-label"},{default:o((()=>[f("考核年份")])),_:1}),i(u,{type:"number",class:"filter-input",placeholder:"请输入考核年份",modelValue:z.periodYear,"onUpdate:modelValue":a[1]||(a[1]=e=>z.periodYear=e),onConfirm:F},null,8,["modelValue"])])),_:1}),i(t,{class:"filter-item"},{default:o((()=>[i(l,{class:"filter-label"},{default:o((()=>[f("考核季度")])),_:1}),i(k,{class:"filter-picker",mode:"selector",range:Y.value,"range-key":"label",value:U.value,onChange:B},{default:o((()=>[i(t,{class:"picker-view"},{default:o((()=>[f(m(U.value>=0?Y.value[U.value].label:"请选择季度"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),i(t,{class:"filter-item"},{default:o((()=>[i(l,{class:"filter-label"},{default:o((()=>[f("KPI评分")])),_:1}),i(u,{type:"number",class:"filter-input",placeholder:"请输入KPI评分(1-100)",modelValue:z.kpiScore,"onUpdate:modelValue":a[2]||(a[2]=e=>z.kpiScore=e),onConfirm:F},null,8,["modelValue"])])),_:1}),i(t,{class:"filter-item"},{default:o((()=>[i(l,{class:"filter-label"},{default:o((()=>[f("绩效等级")])),_:1}),i(k,{class:"filter-picker",mode:"selector",range:K.value,"range-key":"label",value:T.value,onChange:E},{default:o((()=>[i(t,{class:"picker-view"},{default:o((()=>[f(m(T.value>=0?K.value[T.value].label:"请选择绩效等级"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),i(t,{class:"filter-buttons"},{default:o((()=>[i(h,{class:"filter-btn reset",onClick:J},{default:o((()=>[f("重置")])),_:1}),i(h,{class:"filter-btn confirm",onClick:F},{default:o((()=>[f("搜索")])),_:1})])),_:1})])),_:1})):d("",!0)])),_:1}),i(t,{class:"action-buttons"},{default:o((()=>[i(h,{"v-has-perm":["aioveuPerformance:aioveuProcurement-performance:add"],class:"action-btn add",onClick:a[3]||(a[3]=e=>H())},{default:o((()=>[i(l,null,{default:o((()=>[f("+")])),_:1}),i(l,null,{default:o((()=>[f("新增")])),_:1})])),_:1}),i(h,{"v-has-perm":["aioveuPerformance:aioveuProcurement-performance:delete"],class:"action-btn delete",disabled:0===D.value.length,onClick:a[4]||(a[4]=e=>L())},{default:o((()=>[i(l,null,{default:o((()=>[f("🗑️")])),_:1}),i(l,null,{default:o((()=>[f("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),i(t,{class:"list-container"},{default:o((()=>[S.value?(r(),s(t,{key:0,class:"loading-state"},{default:o((()=>[i(l,null,{default:o((()=>[f("加载中...")])),_:1})])),_:1})):0===A.value.length?(r(),s(t,{key:1,class:"empty-state"},{default:o((()=>[i(l,{class:"empty-icon"},{default:o((()=>[f("📁")])),_:1}),i(l,{class:"empty-text"},{default:o((()=>[f("暂无绩效数据")])),_:1})])),_:1})):(r(!0),g(b,{key:2},y(A.value,(e=>(r(),s(t,{key:e.id,class:"performance-card"},{default:o((()=>[i(t,{class:"card-header"},{default:o((()=>[i(l,{class:"performance-id"},{default:o((()=>[f("ID: "+m(e.id),1)])),_:2},1024),i(l,{class:"employee-name"},{default:o((()=>[f(m(e.employeeName),1)])),_:2},1024)])),_:2},1024),i(t,{class:"card-content"},{default:o((()=>[i(t,{class:"info-row"},{default:o((()=>[i(l,{class:"info-label"},{default:o((()=>[f("考核年份:")])),_:1}),i(l,{class:"info-value"},{default:o((()=>[f(m(e.periodYear),1)])),_:2},1024)])),_:2},1024),i(t,{class:"info-row"},{default:o((()=>[i(l,{class:"info-label"},{default:o((()=>[f("考核季度:")])),_:1}),i(l,{class:"info-value"},{default:o((()=>[f(m(R(e.periodQuarter)),1)])),_:2},1024)])),_:2},1024),i(t,{class:"info-row"},{default:o((()=>[i(l,{class:"info-label"},{default:o((()=>[f("KPI评分:")])),_:1}),i(l,{class:"info-value"},{default:o((()=>[f(m(e.kpiScore)+"分",1)])),_:2},1024)])),_:2},1024),i(t,{class:"info-row"},{default:o((()=>[i(l,{class:"info-label"},{default:o((()=>[f("生产率:")])),_:1}),i(l,{class:"info-value"},{default:o((()=>[f(m(e.productivity)+"%",1)])),_:2},1024)])),_:2},1024),i(t,{class:"info-row"},{default:o((()=>[i(l,{class:"info-label"},{default:o((()=>[f("绩效等级:")])),_:1}),i(l,{class:"info-value"},{default:o((()=>[f(m(W(e.performanceGrade)),1)])),_:2},1024)])),_:2},1024),i(t,{class:"info-row"},{default:o((()=>[i(l,{class:"info-label"},{default:o((()=>[f("主管评语:")])),_:1}),i(l,{class:"info-value"},{default:o((()=>[f(m(e.review||"无"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(t,{class:"card-footer"},{default:o((()=>[i(t,{class:"time-info"},{default:o((()=>[i(l,null,{default:o((()=>[f("创建: "+m(e.createTime),1)])),_:2},1024),i(l,null,{default:o((()=>[f("更新: "+m(e.updateTime),1)])),_:2},1024)])),_:2},1024),i(t,{class:"action-buttons"},{default:o((()=>[i(h,{"v-has-perm":["aioveuPerformance:aioveuProcurement-performance:edit"],class:"action-btn edit",onClick:a=>H(e.id)},{default:o((()=>[i(l,null,{default:o((()=>[f("✏️")])),_:1}),i(l,null,{default:o((()=>[f("编辑")])),_:1})])),_:2},1032,["onClick"]),i(h,{"v-has-perm":["aioveuPerformance:aioveuProcurement-performance:delete"],class:"action-btn delete",onClick:a=>L(e.id)},{default:o((()=>[i(l,null,{default:o((()=>[f("🗑️")])),_:1}),i(l,null,{default:o((()=>[f("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),j.value>0?(r(),s(t,{key:3,class:"pagination"},{default:o((()=>[i(h,{class:"pagination-btn",disabled:z.pageNum<=1,onClick:M},{default:o((()=>[f(" 上一页 ")])),_:1},8,["disabled"]),i(l,{class:"page-info"},{default:o((()=>[f(m(z.pageNum)+" / "+m(Math.ceil(j.value/z.pageSize)),1)])),_:1}),i(h,{class:"pagination-btn",disabled:z.pageNum*z.pageSize>=j.value,onClick:O},{default:o((()=>[f(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):d("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-86cb201d"]]);export{D as default};
