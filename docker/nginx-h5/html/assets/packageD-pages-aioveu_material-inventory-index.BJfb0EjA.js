import{d as e,h as a,y as l,Y as t,z as s,a as u,w as i,i as n,o,e as d,b as r,s as c,g as f,t as v,a4 as _,a6 as m,a0 as p,c as g,F as b,r as h,X as y,$ as N,aa as k,aI as w,aJ as I}from"./index-5U173LQ3.js";import{A as C}from"./aioveu-inventory.D9zDSFh5.js";import{A}from"./aioveu-warehouse.DBFoddqK.js";import{A as x}from"./aioveu-material.D870okzX.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D=j(e({__name:"index",setup(e){const j=a(!1),D=a([]),z=a(0),P=a(!1),O=l({pageNum:1,pageSize:10}),S=a([]),M=a([]),V=a([]),T=a(-1),$=a(-1),q=()=>{P.value=!P.value},B=e=>{const a=e.detail.value;T.value=a,M.value[a]&&(O.warehouseName=M.value[a].warehouseName)},F=e=>{const a=e.detail.value;$.value=a,V.value[a]&&(O.materialName=V.value[a].materialName)},J=()=>{j.value=!0,C.getPage(O).then((e=>{S.value=e.list,z.value=e.total})).finally((()=>{j.value=!1}))},L=()=>{O.pageNum=1,O.warehouseName="",O.materialName="",T.value=-1,$.value=-1,S.value=[],J()},U=()=>{O.pageNum>1&&(O.pageNum--,J())},W=()=>{O.pageNum*O.pageSize<z.value&&(O.pageNum++,J())},X=a(!1);t((()=>{X.value&&(J(),X.value=!1)}));const Y=e=>{X.value=!0;let a="/packageD/pages/aioveu_material/inventory/form";void 0!==e&&(a+=`?id=${e}`),y({url:a})},E=e=>{const a=e?[e]:D.value;0!==a.length?k({title:"提示",content:"确认删除选中的库存记录吗？",success:e=>{e.confirm&&(w({title:"删除中..."}),C.deleteByIds(a.join(",")).then((()=>{N({title:"删除成功",icon:"success"}),L()})).finally((()=>I())))}}):N({title:"请选择要删除的库存记录",icon:"none"})};return s((()=>{J(),A.getAllWarehouseOptions().then((e=>{Array.isArray(e)&&(M.value=e.map((e=>({warehouseId:Number(e.warehouseId),warehouseName:e.warehouseName}))))})),x.getAllMaterialOptions().then((e=>{Array.isArray(e)&&(V.value=e.map((e=>({materialId:Number(e.materialId),materialName:e.materialName}))))}))})),(e,a)=>{const l=c,t=n,s=_,y=m,N=p;return o(),u(t,{class:"app-container"},{default:i((()=>[d(t,{class:"search-container"},{default:i((()=>[d(t,{class:"filter-header",onClick:q},{default:i((()=>[d(l,null,{default:i((()=>[f("🔍 筛选条件")])),_:1}),d(l,null,{default:i((()=>[f(v(P.value?"▲":"▼"),1)])),_:1})])),_:1}),P.value?(o(),u(t,{key:0,class:"filter-content"},{default:i((()=>[d(t,{class:"filter-item"},{default:i((()=>[d(l,{class:"filter-label"},{default:i((()=>[f("库存ID")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入库存ID",modelValue:O.id,"onUpdate:modelValue":a[0]||(a[0]=e=>O.id=e),onConfirm:J},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:i((()=>[d(l,{class:"filter-label"},{default:i((()=>[f("仓库")])),_:1}),d(y,{class:"filter-picker",mode:"selector",range:M.value,"range-key":"warehouseName",value:T.value,onChange:B},{default:i((()=>[d(t,{class:"picker-view"},{default:i((()=>[f(v(T.value>=0?M.value[T.value].warehouseName:"请选择仓库"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-item"},{default:i((()=>[d(l,{class:"filter-label"},{default:i((()=>[f("物资")])),_:1}),d(y,{class:"filter-picker",mode:"selector",range:V.value,"range-key":"materialName",value:$.value,onChange:F},{default:i((()=>[d(t,{class:"picker-view"},{default:i((()=>[f(v($.value>=0?V.value[$.value].materialName:"请选择物资"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-buttons"},{default:i((()=>[d(N,{class:"filter-btn reset",onClick:L},{default:i((()=>[f("重置")])),_:1}),d(N,{class:"filter-btn confirm",onClick:J},{default:i((()=>[f("搜索")])),_:1})])),_:1})])),_:1})):r("",!0)])),_:1}),d(t,{class:"action-buttons"},{default:i((()=>[d(N,{"v-has-perm":["aioveuInventory:aioveuProcurement-inventory:add"],class:"action-btn add",onClick:a[1]||(a[1]=e=>Y())},{default:i((()=>[d(l,null,{default:i((()=>[f("+")])),_:1}),d(l,null,{default:i((()=>[f("新增")])),_:1})])),_:1}),d(N,{"v-has-perm":["aioveuInventory:aioveuProcurement-inventory:delete"],class:"action-btn delete",disabled:0===D.value.length,onClick:a[2]||(a[2]=e=>E())},{default:i((()=>[d(l,null,{default:i((()=>[f("🗑️")])),_:1}),d(l,null,{default:i((()=>[f("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),d(t,{class:"list-container"},{default:i((()=>[j.value?(o(),u(t,{key:0,class:"loading-state"},{default:i((()=>[d(l,null,{default:i((()=>[f("加载中...")])),_:1})])),_:1})):0===S.value.length?(o(),u(t,{key:1,class:"empty-state"},{default:i((()=>[d(l,{class:"empty-icon"},{default:i((()=>[f("📁")])),_:1}),d(l,{class:"empty-text"},{default:i((()=>[f("暂无库存数据")])),_:1})])),_:1})):(o(!0),g(b,{key:2},h(S.value,(e=>(o(),u(t,{key:e.id,class:"inventory-card"},{default:i((()=>[d(t,{class:"card-header"},{default:i((()=>[d(l,{class:"inventory-id"},{default:i((()=>[f("ID: "+v(e.id),1)])),_:2},1024),d(l,{class:"warehouse-name"},{default:i((()=>[f(v(e.warehouseName),1)])),_:2},1024)])),_:2},1024),d(t,{class:"card-content"},{default:i((()=>[d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[f("物资:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[f(v(e.materialName),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[f("库存量:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[f(v(e.quantity),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[f("批次号:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[f(v(e.batchNumber||"无"),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[f("生产日期:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[f(v(e.productionDate||"无"),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[f("有效期至:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[f(v(e.expiryDate||"无"),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[f("最后入库:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[f(v(e.lastInbound||"无"),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[f("最后出库:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[f(v(e.lastOutbound||"无"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(t,{class:"card-footer"},{default:i((()=>[d(t,{class:"time-info"},{default:i((()=>[d(l,null,{default:i((()=>[f("创建: "+v(e.createTime),1)])),_:2},1024),d(l,null,{default:i((()=>[f("更新: "+v(e.updateTime),1)])),_:2},1024)])),_:2},1024),d(t,{class:"action-buttons"},{default:i((()=>[d(N,{"v-has-perm":["aioveuInventory:aioveuProcurement-inventory:edit"],class:"action-btn edit",onClick:a=>Y(e.id)},{default:i((()=>[d(l,null,{default:i((()=>[f("✏️")])),_:1}),d(l,null,{default:i((()=>[f("编辑")])),_:1})])),_:2},1032,["onClick"]),d(N,{"v-has-perm":["aioveuInventory:aioveuProcurement-inventory:delete"],class:"action-btn delete",onClick:a=>E(e.id)},{default:i((()=>[d(l,null,{default:i((()=>[f("🗑️")])),_:1}),d(l,null,{default:i((()=>[f("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),z.value>0?(o(),u(t,{key:3,class:"pagination"},{default:i((()=>[d(N,{class:"pagination-btn",disabled:O.pageNum<=1,onClick:U},{default:i((()=>[f(" 上一页 ")])),_:1},8,["disabled"]),d(l,{class:"page-info"},{default:i((()=>[f(v(O.pageNum)+" / "+v(Math.ceil(z.value/O.pageSize)),1)])),_:1}),d(N,{class:"pagination-btn",disabled:O.pageNum*O.pageSize>=z.value,onClick:W},{default:i((()=>[f(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):r("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-e350de8e"]]);export{D as default};
