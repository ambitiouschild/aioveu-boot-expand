import{d as e,h as a,y as l,Y as t,z as s,a as u,w as n,i as d,o as c,e as o,b as i,s as f,g as r,t as m,a4 as v,a6 as _,a0 as p,c as g,F as b,r as y,X as k,$ as h,aa as N,aI as I,aJ as C}from"./index-5U173LQ3.js";import{A}from"./aioveu-attendance.DrlmBXaU.js";import{A as w}from"./aioveu-employee.CCWXpWw-.js";import{D as j}from"./dict.R0KYYCD_.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D=x(e({__name:"index",setup(e){const x=a(!1),D=a([]),V=a(0),z=a(!1),H=l({pageNum:1,pageSize:10}),P=a([]),S=a([]),U=a([]),T=a(-1),$=a(-1),B=a(""),E=()=>{z.value=!z.value},F=e=>{const a=e.detail.value;T.value=a,S.value[a]&&(H.employeeName=S.value[a].employeeName)},G=e=>{const a=e.detail.value;$.value=a,U.value[a]&&(H.status=Number(U.value[a].value))},J=()=>{x.value=!0,A.getPage(H).then((e=>{P.value=e.list,V.value=e.total})).finally((()=>{x.value=!1}))},L=()=>{H.pageNum=1,H.attendanceId=void 0,H.employeeName="",H.workHours=void 0,H.status=void 0,T.value=-1,$.value=-1,B.value="",P.value=[],J()},M=()=>{H.pageNum>1&&(H.pageNum--,J())},O=()=>{H.pageNum*H.pageSize<V.value&&(H.pageNum++,J())},R=a(!1);t((()=>{R.value&&(J(),R.value=!1)}));const X=e=>{R.value=!0;let a="/packageC/pages/aioveu_department/attendance/form";void 0!==e&&(a+=`?attendanceId=${e}`),console.log("跳转URL:",a),k({url:a})},Y=e=>{const a=e?[e]:D.value;0!==a.length?N({title:"提示",content:"确认删除选中的考勤记录吗？",success:e=>{e.confirm&&(I({title:"删除中..."}),A.deleteByIds(a.join(",")).then((()=>{h({title:"删除成功",icon:"success"}),L()})).finally((()=>C())))}}):h({title:"请选择要删除的考勤记录",icon:"none"})},q=e=>{const a=U.value.find((a=>a.value===e.toString()));return a?a.label:"未知状态"};return s((()=>{J(),w.getAllEmployeeOptions().then((e=>{Array.isArray(e)&&(S.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))})),j.getDictItems("attendance_status").then((e=>{U.value=e}))})),(e,a)=>{const l=f,t=d,s=v,k=_,h=p;return c(),u(t,{class:"app-container"},{default:n((()=>[o(t,{class:"search-container"},{default:n((()=>[o(t,{class:"filter-header",onClick:E},{default:n((()=>[o(l,null,{default:n((()=>[r("🔍 筛选条件")])),_:1}),o(l,null,{default:n((()=>[r(m(z.value?"▲":"▼"),1)])),_:1})])),_:1}),z.value?(c(),u(t,{key:0,class:"filter-content"},{default:n((()=>[o(t,{class:"filter-item"},{default:n((()=>[o(l,{class:"filter-label"},{default:n((()=>[r("考勤ID")])),_:1}),o(s,{type:"text",class:"filter-input",placeholder:"请输入考勤ID",modelValue:H.attendanceId,"onUpdate:modelValue":a[0]||(a[0]=e=>H.attendanceId=e),onConfirm:J},null,8,["modelValue"])])),_:1}),o(t,{class:"filter-item"},{default:n((()=>[o(l,{class:"filter-label"},{default:n((()=>[r("员工姓名")])),_:1}),o(k,{class:"filter-picker",mode:"selector",range:S.value,"range-key":"employeeName",value:T.value,onChange:F},{default:n((()=>[o(t,{class:"picker-view"},{default:n((()=>[r(m(T.value>=0?S.value[T.value].employeeName:"请选择员工"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),o(t,{class:"filter-item"},{default:n((()=>[o(l,{class:"filter-label"},{default:n((()=>[r("工作时长(小时)")])),_:1}),o(s,{type:"number",class:"filter-input",placeholder:"请输入工作时长",modelValue:H.workHours,"onUpdate:modelValue":a[1]||(a[1]=e=>H.workHours=e),onConfirm:J},null,8,["modelValue"])])),_:1}),o(t,{class:"filter-item"},{default:n((()=>[o(l,{class:"filter-label"},{default:n((()=>[r("考勤状态")])),_:1}),o(k,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"label",value:$.value,onChange:G},{default:n((()=>[o(t,{class:"picker-view"},{default:n((()=>[r(m($.value>=0?U.value[$.value].label:"请选择状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),o(t,{class:"filter-buttons"},{default:n((()=>[o(h,{class:"filter-btn reset",onClick:L},{default:n((()=>[r("重置")])),_:1}),o(h,{class:"filter-btn confirm",onClick:J},{default:n((()=>[r("搜索")])),_:1})])),_:1})])),_:1})):i("",!0)])),_:1}),o(t,{class:"action-buttons"},{default:n((()=>[o(h,{"v-has-perm":["aioveuAttendance:aioveuProcurement-attendance:add"],class:"action-btn add",onClick:a[2]||(a[2]=e=>X())},{default:n((()=>[o(l,null,{default:n((()=>[r("+")])),_:1}),o(l,null,{default:n((()=>[r("新增")])),_:1})])),_:1}),o(h,{"v-has-perm":["aioveuAttendance:aioveuProcurement-attendance:delete"],class:"action-btn delete",disabled:0===D.value.length,onClick:a[3]||(a[3]=e=>Y())},{default:n((()=>[o(l,null,{default:n((()=>[r("🗑️")])),_:1}),o(l,null,{default:n((()=>[r("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),o(t,{class:"list-container"},{default:n((()=>[x.value?(c(),u(t,{key:0,class:"loading-state"},{default:n((()=>[o(l,null,{default:n((()=>[r("加载中...")])),_:1})])),_:1})):0===P.value.length?(c(),u(t,{key:1,class:"empty-state"},{default:n((()=>[o(l,{class:"empty-icon"},{default:n((()=>[r("📁")])),_:1}),o(l,{class:"empty-text"},{default:n((()=>[r("暂无考勤数据")])),_:1})])),_:1})):(c(!0),g(b,{key:2},y(P.value,(e=>(c(),u(t,{key:e.attendanceId,class:"attendance-card"},{default:n((()=>[o(t,{class:"card-header"},{default:n((()=>[o(l,{class:"attendance-id"},{default:n((()=>[r("考勤ID: "+m(e.attendanceId),1)])),_:2},1024),o(l,{class:"date"},{default:n((()=>[r(m(e.date),1)])),_:2},1024)])),_:2},1024),o(t,{class:"card-content"},{default:n((()=>[o(t,{class:"info-item"},{default:n((()=>[o(l,{class:"info-label"},{default:n((()=>[r("员工姓名:")])),_:1}),o(l,{class:"info-value"},{default:n((()=>[r(m(e.employeeName),1)])),_:2},1024)])),_:2},1024),o(t,{class:"info-item"},{default:n((()=>[o(l,{class:"info-label"},{default:n((()=>[r("上班打卡:")])),_:1}),o(l,{class:"info-value"},{default:n((()=>[r(m(e.checkinTime||"未打卡"),1)])),_:2},1024)])),_:2},1024),o(t,{class:"info-item"},{default:n((()=>[o(l,{class:"info-label"},{default:n((()=>[r("下班打卡:")])),_:1}),o(l,{class:"info-value"},{default:n((()=>[r(m(e.checkoutTime||"未打卡"),1)])),_:2},1024)])),_:2},1024),o(t,{class:"info-item"},{default:n((()=>[o(l,{class:"info-label"},{default:n((()=>[r("工作时长:")])),_:1}),o(l,{class:"info-value"},{default:n((()=>[r(m(e.workHours)+" 小时",1)])),_:2},1024)])),_:2},1024),o(t,{class:"info-item"},{default:n((()=>[o(l,{class:"info-label"},{default:n((()=>[r("考勤状态:")])),_:1}),o(l,{class:"info-value"},{default:n((()=>[r(m(q(e.status)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),o(t,{class:"card-footer"},{default:n((()=>[o(h,{"v-has-perm":["aioveuAttendance:aioveuProcurement-attendance:edit"],class:"action-btn edit",onClick:a=>X(e.attendanceId)},{default:n((()=>[o(l,null,{default:n((()=>[r("✏️")])),_:1}),o(l,null,{default:n((()=>[r("编辑")])),_:1})])),_:2},1032,["onClick"]),o(h,{"v-has-perm":["aioveuAttendance:aioveuProcurement-attendance:delete"],class:"action-btn delete",onClick:a=>Y(e.attendanceId)},{default:n((()=>[o(l,null,{default:n((()=>[r("🗑️")])),_:1}),o(l,null,{default:n((()=>[r("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),V.value>0?(c(),u(t,{key:3,class:"pagination"},{default:n((()=>[o(h,{class:"pagination-btn",disabled:H.pageNum<=1,onClick:M},{default:n((()=>[r(" 上一页 ")])),_:1},8,["disabled"]),o(l,{class:"page-info"},{default:n((()=>[r(m(H.pageNum)+" / "+m(Math.ceil(V.value/H.pageSize)),1)])),_:1}),o(h,{class:"pagination-btn",disabled:H.pageNum*H.pageSize>=V.value,onClick:O},{default:n((()=>[r(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):i("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-2a76062c"]]);export{D as default};
