import{d as e,h as a,y as l,Y as t,z as s,a as u,w as o,i,o as n,e as c,b as d,s as r,g as f,t as _,a4 as v,a6 as m,a0 as p,c as g,F as y,r as b,X as k,$ as C,aa as h,aI as N,aJ as I}from"./index-5U173LQ3.js";import{A as w}from"./aioveu-category.DEnk_6py.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const V=x(e({__name:"index",setup(e){const x=a(!1),V=a([]),z=a(0),P=a(!1),j=l({pageNum:1,pageSize:10}),A=a([]),D=a([]),S=a(-1),T=()=>{P.value=!P.value},U=e=>{const a=e.detail.value;S.value=a,D.value[a]&&(j.name=D.value[a].categoryName)},$=()=>{x.value=!0,w.getPage(j).then((e=>{A.value=e.list,z.value=e.total})).finally((()=>{x.value=!1}))},B=()=>{j.pageNum=1,j.name="",j.description="",S.value=-1,A.value=[],$()},F=()=>{j.pageNum>1&&(j.pageNum--,$())},J=()=>{j.pageNum*j.pageSize<z.value&&(j.pageNum++,$())},K=a(!1);t((()=>{K.value&&($(),K.value=!1)}));const M=e=>{K.value=!0;let a="/packageD/pages/aioveu_material/category/form";void 0!==e&&(a+=`?id=${e}`),k({url:a})},O=e=>{const a=e?[e]:V.value;0!==a.length?h({title:"提示",content:"确认删除选中的分类吗？",success:e=>{e.confirm&&(N({title:"删除中..."}),w.deleteByIds(a.join(",")).then((()=>{C({title:"删除成功",icon:"success"}),B()})).finally((()=>I())))}}):C({title:"请选择要删除的分类",icon:"none"})};return s((()=>{$(),w.getAllCategoryOptions().then((e=>{Array.isArray(e)&&(D.value=e.map((e=>({categoryId:Number(e.categoryId),categoryName:e.categoryName}))))}))})),(e,a)=>{const l=r,t=i,s=v,k=m,C=p;return n(),u(t,{class:"app-container"},{default:o((()=>[c(t,{class:"search-container"},{default:o((()=>[c(t,{class:"filter-header",onClick:T},{default:o((()=>[c(l,null,{default:o((()=>[f("🔍 筛选条件")])),_:1}),c(l,null,{default:o((()=>[f(_(P.value?"▲":"▼"),1)])),_:1})])),_:1}),P.value?(n(),u(t,{key:0,class:"filter-content"},{default:o((()=>[c(t,{class:"filter-item"},{default:o((()=>[c(l,{class:"filter-label"},{default:o((()=>[f("分类ID")])),_:1}),c(s,{type:"text",class:"filter-input",placeholder:"请输入分类ID",modelValue:j.id,"onUpdate:modelValue":a[0]||(a[0]=e=>j.id=e),onConfirm:$},null,8,["modelValue"])])),_:1}),c(t,{class:"filter-item"},{default:o((()=>[c(l,{class:"filter-label"},{default:o((()=>[f("分类名称")])),_:1}),c(k,{class:"filter-picker",mode:"selector",range:D.value,"range-key":"categoryName",value:S.value,onChange:U},{default:o((()=>[c(t,{class:"picker-view"},{default:o((()=>[f(_(S.value>=0?D.value[S.value].categoryName:"请选择分类"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),c(t,{class:"filter-item"},{default:o((()=>[c(l,{class:"filter-label"},{default:o((()=>[f("分类描述")])),_:1}),c(s,{type:"text",class:"filter-input",placeholder:"请输入分类描述",modelValue:j.description,"onUpdate:modelValue":a[1]||(a[1]=e=>j.description=e),onConfirm:$},null,8,["modelValue"])])),_:1}),c(t,{class:"filter-buttons"},{default:o((()=>[c(C,{class:"filter-btn reset",onClick:B},{default:o((()=>[f("重置")])),_:1}),c(C,{class:"filter-btn confirm",onClick:$},{default:o((()=>[f("搜索")])),_:1})])),_:1})])),_:1})):d("",!0)])),_:1}),c(t,{class:"action-buttons"},{default:o((()=>[c(C,{"v-has-perm":["aioveuCategory:aioveuProcurement-category:add"],class:"action-btn add",onClick:a[2]||(a[2]=e=>M())},{default:o((()=>[c(l,null,{default:o((()=>[f("+")])),_:1}),c(l,null,{default:o((()=>[f("新增")])),_:1})])),_:1}),c(C,{"v-has-perm":["aioveuCategory:aioveuProcurement-category:delete"],class:"action-btn delete",disabled:0===V.value.length,onClick:a[3]||(a[3]=e=>O())},{default:o((()=>[c(l,null,{default:o((()=>[f("🗑️")])),_:1}),c(l,null,{default:o((()=>[f("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),c(t,{class:"list-container"},{default:o((()=>[x.value?(n(),u(t,{key:0,class:"loading-state"},{default:o((()=>[c(l,null,{default:o((()=>[f("加载中...")])),_:1})])),_:1})):0===A.value.length?(n(),u(t,{key:1,class:"empty-state"},{default:o((()=>[c(l,{class:"empty-icon"},{default:o((()=>[f("📁")])),_:1}),c(l,{class:"empty-text"},{default:o((()=>[f("暂无分类数据")])),_:1})])),_:1})):(n(!0),g(y,{key:2},b(A.value,(e=>(n(),u(t,{key:e.id,class:"category-card"},{default:o((()=>[c(t,{class:"card-header"},{default:o((()=>[c(l,{class:"category-id"},{default:o((()=>[f("ID: "+_(e.id),1)])),_:2},1024),c(l,{class:"category-name"},{default:o((()=>[f(_(e.name),1)])),_:2},1024)])),_:2},1024),c(t,{class:"card-content"},{default:o((()=>[c(t,{class:"info-row"},{default:o((()=>[c(l,{class:"info-label"},{default:o((()=>[f("父分类:")])),_:1}),c(l,{class:"info-value"},{default:o((()=>[f(_(e.parentCategoryName||"无"),1)])),_:2},1024)])),_:2},1024),c(t,{class:"info-row"},{default:o((()=>[c(l,{class:"info-label"},{default:o((()=>[f("分类层级:")])),_:1}),c(l,{class:"info-value"},{default:o((()=>[f(_(e.level),1)])),_:2},1024)])),_:2},1024),c(t,{class:"info-row"},{default:o((()=>[c(l,{class:"info-label"},{default:o((()=>[f("分类描述:")])),_:1}),c(l,{class:"info-value"},{default:o((()=>[f(_(e.description||"无"),1)])),_:2},1024)])),_:2},1024),c(t,{class:"info-row"},{default:o((()=>[c(l,{class:"info-label"},{default:o((()=>[f("创建时间:")])),_:1}),c(l,{class:"info-value"},{default:o((()=>[f(_(e.createTime),1)])),_:2},1024)])),_:2},1024),c(t,{class:"info-row"},{default:o((()=>[c(l,{class:"info-label"},{default:o((()=>[f("更新时间:")])),_:1}),c(l,{class:"info-value"},{default:o((()=>[f(_(e.updateTime),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),c(t,{class:"card-footer"},{default:o((()=>[c(t,{class:"action-buttons"},{default:o((()=>[c(C,{"v-has-perm":["aioveuCategory:aioveuProcurement-category:edit"],class:"action-btn edit",onClick:a=>M(e.id)},{default:o((()=>[c(l,null,{default:o((()=>[f("✏️")])),_:1}),c(l,null,{default:o((()=>[f("编辑")])),_:1})])),_:2},1032,["onClick"]),c(C,{"v-has-perm":["aioveuCategory:aioveuProcurement-category:delete"],class:"action-btn delete",onClick:a=>O(e.id)},{default:o((()=>[c(l,null,{default:o((()=>[f("🗑️")])),_:1}),c(l,null,{default:o((()=>[f("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),z.value>0?(n(),u(t,{key:3,class:"pagination"},{default:o((()=>[c(C,{class:"pagination-btn",disabled:j.pageNum<=1,onClick:F},{default:o((()=>[f(" 上一页 ")])),_:1},8,["disabled"]),c(l,{class:"page-info"},{default:o((()=>[f(_(j.pageNum)+" / "+_(Math.ceil(z.value/j.pageSize)),1)])),_:1}),c(C,{class:"pagination-btn",disabled:j.pageNum*j.pageSize>=z.value,onClick:J},{default:o((()=>[f(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):d("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-017262a5"]]);export{V as default};
