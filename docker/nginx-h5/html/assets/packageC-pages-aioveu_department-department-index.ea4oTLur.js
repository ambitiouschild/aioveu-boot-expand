import{d as e,h as a,y as l,Y as t,z as s,a as u,w as d,$ as n,i,o as c,e as o,b as r,s as f,g as p,t as v,a4 as m,a6 as _,a0 as g,c as b,F as k,r as N,X as h,aa as y,aI as C,aJ as I}from"./index-5U173LQ3.js";import{A as D}from"./aioveu-department.Ni2j20Wl.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=w(e({__name:"index",setup(e){const w=a(!1),x=a([]),z=a(0),j=a(!1),A=l({pageNum:1,pageSize:10}),S=a([]),V=a([]),T=a([]),$=a(-1),B=a(-1),E=a(void 0),F=()=>{j.value=!j.value},J=e=>{const a=e.detail.value;$.value=a,V.value[a]&&(A.deptName=V.value[a].deptName)},M=e=>{const a=e.detail.value;B.value=a,T.value[a]&&(A.parentDeptName=T.value[a].deptName)},O=()=>{w.value=!0,D.getPage(A).then((e=>{S.value=e.list,z.value=e.total})).catch((e=>{console.error("查询部门失败:",e),n({title:"加载数据失败",icon:"none"})})).finally((()=>{w.value=!1}))},P=()=>{A.pageNum=1,A.deptName="",A.parentDeptName="",$.value=-1,B.value=-1,S.value=[],O()},U=()=>{A.pageNum>1&&(A.pageNum--,O())},X=()=>{A.pageNum*A.pageSize<z.value&&(A.pageNum++,O())},Y=a(!1),q=e=>{E.value=e;let a="/packageC/pages/aioveu_department/department/form";void 0!==e&&(a+=`?id=${e}`),Y.value=!0,h({url:a})};t((()=>{Y.value&&(O(),Y.value=!1)}));const G=e=>{const a=e?[e]:x.value;0!==a.length?y({title:"提示",content:"确认删除选中的部门吗？",success:e=>{e.confirm&&(C({title:"删除中..."}),D.deleteByIds(a.join(",")).then((()=>{n({title:"删除成功",icon:"success"}),P()})).catch((e=>{console.error("删除失败:",e),n({title:"删除失败",icon:"none"})})).finally((()=>I())))}}):n({title:"请选择要删除的部门",icon:"none"})};return s((()=>{O(),D.getAllDepartmentOptions().then((e=>{Array.isArray(e)&&(V.value=e.map((e=>({deptId:Number(e.deptId),deptName:e.deptName}))),T.value=[...V.value])})).catch((e=>{console.error("加载部门选项失败:",e),n({title:"加载部门列表失败",icon:"none"})}))})),(e,a)=>{const l=f,t=i,s=m,n=_,h=g;return c(),u(t,{class:"app-container"},{default:d((()=>[o(t,{class:"search-container"},{default:d((()=>[o(t,{class:"filter-header",onClick:F},{default:d((()=>[o(l,null,{default:d((()=>[p("🔍 筛选条件")])),_:1}),o(l,null,{default:d((()=>[p(v(j.value?"▲":"▼"),1)])),_:1})])),_:1}),j.value?(c(),u(t,{key:0,class:"filter-content"},{default:d((()=>[o(t,{class:"filter-item"},{default:d((()=>[o(l,{class:"filter-label"},{default:d((()=>[p("部门ID")])),_:1}),o(s,{type:"text",class:"filter-input",placeholder:"请输入部门ID",modelValue:A.deptId,"onUpdate:modelValue":a[0]||(a[0]=e=>A.deptId=e),onConfirm:O},null,8,["modelValue"])])),_:1}),o(t,{class:"filter-item"},{default:d((()=>[o(l,{class:"filter-label"},{default:d((()=>[p("部门名称")])),_:1}),o(n,{class:"filter-picker",mode:"selector",range:V.value,"range-key":"deptName",value:$.value,onChange:J},{default:d((()=>[o(t,{class:"picker-view"},{default:d((()=>[p(v($.value>=0?V.value[$.value].deptName:"请选择部门名称"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),o(t,{class:"filter-item"},{default:d((()=>[o(l,{class:"filter-label"},{default:d((()=>[p("上级部门")])),_:1}),o(n,{class:"filter-picker",mode:"selector",range:T.value,"range-key":"deptName",value:B.value,onChange:M},{default:d((()=>[o(t,{class:"picker-view"},{default:d((()=>[p(v(B.value>=0?T.value[B.value].deptName:"请选择上级部门"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),o(t,{class:"filter-buttons"},{default:d((()=>[o(h,{class:"filter-btn reset",onClick:P},{default:d((()=>[p("重置")])),_:1}),o(h,{class:"filter-btn confirm",onClick:O},{default:d((()=>[p("搜索")])),_:1})])),_:1})])),_:1})):r("",!0)])),_:1}),o(t,{class:"action-buttons"},{default:d((()=>[o(h,{"v-has-perm":["aioveuDepartment:aioveu-department:add"],class:"action-btn add",onClick:a[1]||(a[1]=e=>q())},{default:d((()=>[o(l,null,{default:d((()=>[p("+")])),_:1}),o(l,null,{default:d((()=>[p("新增")])),_:1})])),_:1}),o(h,{"v-has-perm":["aioveuDepartment:aioveu-department:delete"],class:"action-btn delete",disabled:0===x.value.length,onClick:a[2]||(a[2]=e=>G())},{default:d((()=>[o(l,null,{default:d((()=>[p("🗑️")])),_:1}),o(l,null,{default:d((()=>[p("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),o(t,{class:"list-container"},{default:d((()=>[w.value?(c(),u(t,{key:0,class:"loading-state"},{default:d((()=>[o(l,null,{default:d((()=>[p("加载中...")])),_:1})])),_:1})):0===S.value.length?(c(),u(t,{key:1,class:"empty-state"},{default:d((()=>[o(l,{class:"empty-icon"},{default:d((()=>[p("🏢")])),_:1}),o(l,{class:"empty-text"},{default:d((()=>[p("暂无部门数据")])),_:1})])),_:1})):(c(!0),b(k,{key:2},N(S.value,(e=>(c(),u(t,{key:e.deptId,class:"department-card"},{default:d((()=>[o(t,{class:"card-header"},{default:d((()=>[o(l,{class:"dept-id"},{default:d((()=>[p("ID: "+v(e.deptId),1)])),_:2},1024),o(l,{class:"dept-name"},{default:d((()=>[p(v(e.deptName),1)])),_:2},1024)])),_:2},1024),o(t,{class:"card-content"},{default:d((()=>[o(t,{class:"info-row"},{default:d((()=>[o(l,{class:"info-label"},{default:d((()=>[p("上级部门:")])),_:1}),o(l,{class:"info-value"},{default:d((()=>[p(v(e.parentDeptName||"无"),1)])),_:2},1024)])),_:2},1024),o(t,{class:"info-row"},{default:d((()=>[o(l,{class:"info-label"},{default:d((()=>[p("创建时间:")])),_:1}),o(l,{class:"info-value"},{default:d((()=>[p(v(e.createTime),1)])),_:2},1024)])),_:2},1024),o(t,{class:"info-row"},{default:d((()=>[o(l,{class:"info-label"},{default:d((()=>[p("更新时间:")])),_:1}),o(l,{class:"info-value"},{default:d((()=>[p(v(e.updateTime),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),o(t,{class:"card-footer"},{default:d((()=>[o(t,{class:"action-buttons"},{default:d((()=>[o(h,{"v-has-perm":["aioveuDepartment:aioveu-department:edit"],class:"action-btn edit",onClick:a=>q(e.deptId)},{default:d((()=>[o(l,null,{default:d((()=>[p("✏️")])),_:1}),o(l,null,{default:d((()=>[p("编辑")])),_:1})])),_:2},1032,["onClick"]),o(h,{"v-has-perm":["aioveuDepartment:aioveu-department:delete"],class:"action-btn delete",onClick:a=>G(e.deptId)},{default:d((()=>[o(l,null,{default:d((()=>[p("🗑️")])),_:1}),o(l,null,{default:d((()=>[p("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),z.value>0?(c(),u(t,{key:3,class:"pagination"},{default:d((()=>[o(h,{class:"pagination-btn",disabled:A.pageNum<=1,onClick:U},{default:d((()=>[p(" 上一页 ")])),_:1},8,["disabled"]),o(l,{class:"page-info"},{default:d((()=>[p(v(A.pageNum)+" / "+v(Math.ceil(z.value/A.pageSize)),1)])),_:1}),o(h,{class:"pagination-btn",disabled:A.pageNum*A.pageSize>=z.value,onClick:X},{default:d((()=>[p(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):r("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-4c795f7e"]]);export{x as default};
