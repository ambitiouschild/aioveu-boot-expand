import{d as e,h as a,P as l,k as t,l as s,z as o,C as d,j as i,a as r,o as u,w as n,e as m,i as c,f as p,n as f,b as v,v as _,g as w,t as b,c as g,F as h,u as y,aw as k,y as x,ax as j,al as V,ap as $,E as C,G as q,D as I,R as T,r as z,a3 as D}from"./index-5U173LQ3.js";import{b as P,a as U,c as S,f as E,o as N,e as A,h as F,_ as O}from"./wd-icon.CDbxLjoy.js";import{_ as G}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as B,a as R,b as H}from"./wd-loadmore.Dd59NB56.js";import{_ as L}from"./wd-input.C2gvQ-R0.js";import{_ as M,a as J}from"./wd-status-tip.CQEDPUFS.js";import{_ as K}from"./wd-button.BzRx3gca.js";import{_ as Q}from"./wd-img.B2iROZ-I.js";import{_ as W}from"./wd-text.BpXk7M2k.js";import{_ as X}from"./wd-tag.CuuEfSYT.js";import{_ as Y}from"./wd-cell.yQBIY-AL.js";import{_ as Z}from"./wd-cell-group.CJNVuq-S.js";import{_ as ee}from"./wd-card.qIX23JsB.js";import{u as ae,_ as le,a as te,b as se}from"./wd-message-box.CD4PrFqY.js";import{_ as oe}from"./wd-form.BbkYwo7Z.js";import{w as de}from"./wd-popup.BsbILK4T.js";import{_ as ie,R as re}from"./role.hH2QPHbF.js";import"./index.BkHvPazf.js";import"./clickoutside.C7ctyI5d.js";import"./useParent.Bak0uCS8.js";import"./useChildren.Crbe03ZE.js";import"./wd-divider.DIyXdxGw.js";import"./wd-overlay.iGBdgU4M.js";import"./base64.3RFQOR3W.js";import"./wd-transition.7-0aPBrJ.js";import"./useTranslate.Kg86_MV8.js";import"./useCell.qN6vSEvF.js";import"./types.DZx-jF8C.js";import"./types.Prh_CF5p.js";import"./wd-badge.DAC9AGTt.js";import"./dayjs.CSix6rHa.js";import"./wd-toast.BszgenSq.js";import"./wd-picker-view.C4DkyJ3f.js";import"./wd-action-sheet.Dzykoifh.js";import"./wd-radio-group.DF6hNek8.js";const ue=G(e({name:"wd-navbar",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...S,title:String,leftText:String,rightText:String,leftArrow:P(!1),bordered:P(!0),fixed:P(!1),placeholder:P(!1),zIndex:U(500),safeAreaInsetTop:P(!1),leftDisabled:P(!1),rightDisabled:P(!1)},emits:["click-left","click-right"],setup(e,{emit:k}){const x=e,j=k,V=a(""),{statusBarHeight:$}=l();t([()=>x.fixed,()=>x.placeholder],(()=>{z()}),{deep:!0,immediate:!1});const C=s((()=>{const e={};return x.fixed&&E(x.zIndex)&&(e["z-index"]=x.zIndex),x.safeAreaInsetTop&&(e["padding-top"]=A($||0)),`${N(e)};${x.customStyle}`}));function q(){x.leftDisabled||j("click-left")}function I(){x.rightDisabled||j("click-right")}o((()=>{x.fixed&&x.placeholder&&d((()=>{z()}))}));const{proxy:T}=i();function z(){x.fixed&&x.placeholder&&F(".wd-navbar",!1,T).then((e=>{V.value=e.height}))}return(e,a)=>{const l=c;return u(),r(l,{style:p({height:y(A)(V.value)})},{default:n((()=>[m(l,{class:f(`wd-navbar ${e.customClass} ${e.fixed?"is-fixed":""} ${e.bordered?"is-border":""}`),style:p(C.value)},{default:n((()=>[m(l,{class:"wd-navbar__content"},{default:n((()=>[e.$slots.capsule?(u(),r(l,{key:0,class:"wd-navbar__capsule"},{default:n((()=>[_(e.$slots,"capsule",{},void 0,!0)])),_:3})):e.$slots.left?(u(),r(l,{key:2,class:f("wd-navbar__left "+(e.leftDisabled?"is-disabled":"")),onClick:q},{default:n((()=>[_(e.$slots,"left",{},void 0,!0)])),_:3},8,["class"])):(u(),r(l,{key:1,class:f("wd-navbar__left "+(e.leftDisabled?"is-disabled":"")),onClick:q},{default:n((()=>[e.leftArrow?(u(),r(O,{key:0,name:"arrow-left","custom-class":"wd-navbar__arrow"})):v("",!0),e.leftText?(u(),r(l,{key:1,class:"wd-navbar__text"},{default:n((()=>[w(b(e.leftText),1)])),_:1})):v("",!0)])),_:1},8,["class"])),m(l,{class:"wd-navbar__title"},{default:n((()=>[_(e.$slots,"title",{},void 0,!0),!e.$slots.title&&e.title?(u(),g(h,{key:0},[w(b(e.title),1)],64)):v("",!0)])),_:3}),e.$slots.right||e.rightText?(u(),r(l,{key:3,class:f("wd-navbar__right "+(e.rightDisabled?"is-disabled":"")),onClick:I},{default:n((()=>[_(e.$slots,"right",{},void 0,!0),!e.$slots.right&&e.rightText?(u(),r(l,{key:0,class:"wd-navbar__text","hover-class":"wd-navbar__text--hover","hover-stay-time":70},{default:n((()=>[w(b(e.rightText),1)])),_:1})):v("",!0)])),_:3},8,["class"])):v("",!0)])),_:3})])),_:3},8,["class","style"])])),_:3},8,["style"])}}}),[["__scopeId","data-v-f471d3d7"]]),ne="/api/v1/dept",me={getList:e=>k({url:`${ne}`,method:"GET",data:e}),getOptions:()=>k({url:`${ne}/options`,method:"GET"}),getFormData:e=>k({url:`${ne}/${e}/form`,method:"GET"}),add:e=>k({url:`${ne}`,method:"POST",data:e}),update:(e,a)=>k({url:`${ne}/${e}`,method:"PUT",data:a}),deleteByIds:e=>k({url:`${ne}/${e}`,method:"DELETE"})},ce=G(e({options:{styleIsolation:"shared"},__name:"index",setup(e){const l=ae(),t=a("loading"),s=a(),o=a(),d=a(0),i=a([{label:"默认排序",value:0},{label:"最近创建",value:1},{label:"最近更新",value:2}]);let p={pageNum:1,pageSize:10};const f=a(0),_=a([]),k=x({visible:!1}),P={id:void 0,roleIds:[],username:void 0,nickname:void 0,deptId:void 0,mobile:void 0,email:void 0,status:1},U=x({...P}),S=a([]),E=a([]),N={username:[{required:!0,message:"请输入用户名"}],nickname:[{required:!0,message:"请输入昵称"}],roleIds:[{required:!0,message:"请选择角色"}],deptId:[{required:!0,message:"请选择部门"}],status:[{required:!0,message:"请选择状态"}],mobile:[{required:!1,message:"手机号格式不正确",validator:e=>e?/^1[3456789]\d{9}$/.test(e)?Promise.resolve():Promise.reject("手机号格式不正确"):Promise.resolve()}],email:[{required:!1,message:"邮箱格式不正确",validator:e=>e?/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e)?Promise.resolve():Promise.reject("邮箱格式不正确"):Promise.resolve()}]},A=({value:e})=>{1===e?(p.field="create_time",p.direction="DESC"):2===e?(p.field="update_time",p.direction="DESC"):(p.field="",p.direction=""),F()},F=()=>{var e;null==(e=s.value)||e.close(),p.pageNum=1,ne(),console.log("queryParams",p)},G=()=>{p={pageNum:1,pageSize:10},F()};function ne(){t.value="loading",$.getPage(p).then((e=>{_.value=e.list,f.value=e.total,p.pageNum++})).catch((e=>{_.value=[]})).finally((()=>{t.value="finished"}))}async function ce(e){k.visible=!0,S.value=await re.getOptions(),E.value=await me.getOptions(),e&&$.getFormData(e).then((e=>{Object.assign(U,{...e})}))}function pe(){fe(),o.value.validate().then((({valid:e})=>{if(e){const e=U.id;e?$.update(e,U).then((()=>{l.show("修改成功"),fe(),F()})):$.add(U).then((()=>{l.show("添加成功"),fe(),F()}))}}))}function fe(){k.visible=!1,o.value.reset(),Object.assign(U,P)}return j((()=>{p.pageNum*p.pageSize<f.value?ne():p.pageNum*p.pageSize>=f.value&&(t.value="finished")})),V((()=>{F()})),(e,a)=>{const x=c,j=C(q("wd-icon"),O),V=C(q("wd-navbar"),ue),P=C(q("wd-drop-menu-item"),B),ae=C(q("wd-input"),L),re=C(q("cu-date-query"),M),me=C(q("wd-button"),K),ve=C(q("wd-drop-menu"),R),_e=C(q("wd-img"),Q),we=C(q("wd-text"),W),be=C(q("wd-tag"),X),ge=C(q("wd-cell"),Y),he=C(q("wd-cell-group"),Z),ye=C(q("wd-card"),ee),ke=C(q("wd-loadmore"),H),xe=C(q("wd-status-tip"),J),je=C(q("wd-select-picker"),le),Ve=I("CuPicker"),$e=C(q("wd-switch"),te),Ce=C(q("wd-form"),oe),qe=C(q("wd-popup"),de),Ie=C(q("wd-fab"),ie),Te=C(q("wd-message-box"),se);return u(),g(h,null,[m(x,{style:{width:"100%",height:"var(--status-bar-height)"}}),m(x,{class:"user-container"},{default:n((()=>[m(V,{title:"用户管理"},{left:n((()=>[m(j,{name:"thin-arrow-left",onClick:a[0]||(a[0]=e=>{D()})})])),_:1}),m(x,{class:"filter-container"},{default:n((()=>[m(ve,null,{default:n((()=>[m(P,{modelValue:y(d),"onUpdate:modelValue":a[1]||(a[1]=e=>T(d)?d.value=e:null),options:y(i),title:"排序",icon:"unfold-more",onChange:A},null,8,["modelValue","options"]),m(P,{ref_key:"filterDropMenu",ref:s,title:"筛选",icon:"filter"},{default:n((()=>[m(x,null,{default:n((()=>[m(ae,{modelValue:y(p).keywords,"onUpdate:modelValue":a[2]||(a[2]=e=>y(p).keywords=e),label:"关键字",placeholder:"用户名/昵称/手机号"},null,8,["modelValue"]),m(re,{modelValue:y(p).createTime,"onUpdate:modelValue":a[3]||(a[3]=e=>y(p).createTime=e),label:"创建时间"},null,8,["modelValue"]),m(x,{class:"flex-between py-2"},{default:n((()=>[m(me,{type:"info",onClick:G},{default:n((()=>[w("重置")])),_:1}),m(me,{onClick:F},{default:n((()=>[w("查询")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})])),_:1}),m(x,{class:"data-container"},{default:n((()=>[(u(!0),g(h,null,z(y(_),(e=>(u(),r(ye,{key:e.id},{title:n((()=>[m(x,{class:"flex-between"},{default:n((()=>[m(x,{class:"flex-center"},{default:n((()=>[m(_e,{width:50,height:50,round:"",src:e.avatar,class:"round"},null,8,["src"]),m(x,{class:"ml-2"},{default:n((()=>[m(x,{class:"font-bold"},{default:n((()=>[w(b(e.nickname)+" ",1),1==e.gender?(u(),r(j,{key:0,name:"gender-male",class:"color-_wn_4D80F0"})):2==e.gender?(u(),r(j,{key:1,name:"gender-female",class:"color-_wn_FA4350"})):v("",!0)])),_:2},1024),m(x,{class:"mt-1"},{default:n((()=>[m(we,{text:e.deptName,size:"12px"},null,8,["text"])])),_:2},1024)])),_:2},1024)])),_:2},1024),m(x,null,{default:n((()=>[1===e.status?(u(),r(be,{key:0,type:"success",plain:"",class:"plain"},{default:n((()=>[w("正常")])),_:1})):0===e.status?(u(),r(be,{key:1,plain:"",class:"plain"},{default:n((()=>[w("禁用")])),_:1})):v("",!0)])),_:2},1024)])),_:2},1024)])),footer:n((()=>[m(x,{class:"flex-between"},{default:n((()=>[m(x,{class:"text-left"},{default:n((()=>[m(we,{text:"创建时间：",size:"small",class:"font-bold text-创建时间："}),m(we,{text:e.createTime,size:"small"},null,8,["text"])])),_:2},1024),m(x,{class:"text-right"},{default:n((()=>[m(me,{type:"primary",size:"small",plain:"","v-has-perm":"sys:user:edit",onClick:a=>ce(e.id),class:"plain"},{default:n((()=>[w(" 编辑 ")])),_:2},1032,["onClick"]),w("   "),m(me,{type:"error",size:"small",plain:"","v-has-perm":"sys:user:delete",onClick:a=>{return t=e.id,void l.confirm({msg:"确认删除用户吗？",title:"提示"}).then((()=>{$.deleteByIds(t+"").then((()=>{l.show("删除成功"),F()}))}));var t},class:"plain"},{default:n((()=>[w(" 删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),default:n((()=>[m(he,null,{default:n((()=>[m(ge,{title:"用户名",value:e.username,icon:"user"},null,8,["value"]),m(ge,{title:"角色",value:e.roleNames,icon:"usergroup"},null,8,["value"]),m(ge,{title:"手机号码",value:e.mobile,icon:"mobile"},null,8,["value"]),m(ge,{title:"邮箱",value:e.email,icon:"mail"},null,8,["value"])])),_:2},1024)])),_:2},1024)))),128)),y(f)>0?(u(),r(ke,{key:0,state:y(t),onReload:ne},null,8,["state"])):0==y(f)?(u(),r(xe,{key:1,image:"search",tip:"当前搜索无结果"})):v("",!0)])),_:1}),m(qe,{modelValue:y(k).visible,"onUpdate:modelValue":a[12]||(a[12]=e=>y(k).visible=e),position:"bottom",onClose:fe},{default:n((()=>[m(Ce,{ref_key:"userFormRef",ref:o,model:y(U),rules:N},{default:n((()=>[m(he,{border:"",class:"border"},{default:n((()=>[m(ae,{modelValue:y(U).username,"onUpdate:modelValue":a[4]||(a[4]=e=>y(U).username=e),label:"用户名",readonly:!y(U).id,required:"",class:"required"},null,8,["modelValue","readonly"]),m(ae,{modelValue:y(U).nickname,"onUpdate:modelValue":a[5]||(a[5]=e=>y(U).nickname=e),label:"昵称",required:"",class:"required"},null,8,["modelValue"]),m(je,{modelValue:y(U).roleIds,"onUpdate:modelValue":a[6]||(a[6]=e=>y(U).roleIds=e),label:"角色",columns:y(S),required:"",class:"required"},null,8,["modelValue","columns"]),m(Ve,{modelValue:y(U).deptId,"onUpdate:modelValue":a[7]||(a[7]=e=>y(U).deptId=e),data:y(E),"onUpdate:data":a[8]||(a[8]=e=>T(E)?E.value=e:null),label:"部门",required:!0},null,8,["modelValue","data"]),m(ae,{modelValue:y(U).mobile,"onUpdate:modelValue":a[9]||(a[9]=e=>y(U).mobile=e),label:"手机号",prop:"mobile"},null,8,["modelValue"]),m(ae,{modelValue:y(U).email,"onUpdate:modelValue":a[10]||(a[10]=e=>y(U).email=e),label:"邮箱",prop:"email"},null,8,["modelValue"]),m(ge,{title:"状态"},{default:n((()=>[m($e,{modelValue:y(U).status,"onUpdate:modelValue":a[11]||(a[11]=e=>y(U).status=e),"active-value":1,"inactive-value":0,required:"",class:"required"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model"]),m(x,{class:"popup-footer"},{default:n((()=>[m(me,{type:"primary",block:"",onClick:pe,class:"block"},{default:n((()=>[w("提交")])),_:1})])),_:1})])),_:1},8,["modelValue"]),m(Ie,{"v-has-perm":"sys:user:add",position:"left-bottom",expandable:!1,"custom-style":"z-index: 9",onClick:ce}),m(Te)])),_:1})],64)}}}),[["__scopeId","data-v-c87508a2"]]);export{ce as default};
