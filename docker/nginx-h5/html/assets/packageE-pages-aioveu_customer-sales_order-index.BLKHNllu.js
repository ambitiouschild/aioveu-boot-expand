import{d as e,h as a,y as l,Y as s,z as t,a as u,w as o,$ as i,i as d,o as n,e as r,b as c,s as f,g as v,t as _,a4 as m,a6 as p,a0 as b,c as g,F as N,r as h,X as y,aa as k,aI as w,aJ as C}from"./index-5U173LQ3.js";import{A}from"./aioveu-sales-order.NYwjDYB-.js";import{A as I}from"./aioveu-customer.MhylDKEJ.js";import{A as S}from"./aioveu-contact.B_5Ds4O-.js";import{A as D}from"./aioveu-employee.t1i7jtWp.js";import{D as x}from"./dict.R0KYYCD_.js";import{_ as O}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=O(e({__name:"index",setup(e){const O=a(!1),j=a([]),V=a(0),z=a(!1),M=l({pageNum:1,pageSize:10}),R=a([]),T=a([]),E=a([]),U=a([]),X=a([]),$=a([]),B=a([]),F=a(-1),J=a(-1),P=a(-1),W=a(-1),Y=a(-1),Z=a(-1),q=a(void 0),G=()=>{z.value=!z.value},H=e=>{const a=e.detail.value;F.value=a,T.value[a]&&(M.customerName=T.value[a].customerName)},K=e=>{const a=e.detail.value;W.value=a,X.value[a]&&(M.paymentStatus=Number(X.value[a].value))},L=e=>{const a=e.detail.value;Y.value=a,$.value[a]&&(M.orderStatus=Number($.value[a].value))},Q=e=>{const a=e.detail.value;Z.value=a,B.value[a]&&(M.shippingMethod=Number(B.value[a].value))},ee=e=>{const a=e.detail.value;P.value=a,U.value[a]&&(M.salesRepName=U.value[a].employeeName)},ae=()=>{O.value=!0,A.getPage(M).then((e=>{R.value=e.list,V.value=e.total})).catch((e=>{console.error("查询销售订单失败:",e),i({title:"加载数据失败",icon:"none"})})).finally((()=>{O.value=!1}))},le=()=>{M.pageNum=1,M.orderNo="",M.customerName="",M.paymentStatus=void 0,M.orderStatus=void 0,M.shippingMethod=void 0,M.salesRepName="",F.value=-1,J.value=-1,P.value=-1,W.value=-1,Y.value=-1,Z.value=-1,R.value=[],ae()},se=()=>{M.pageNum>1&&(M.pageNum--,ae())},te=()=>{M.pageNum*M.pageSize<V.value&&(M.pageNum++,ae())},ue=a(!1);s((()=>{ue.value&&(ae(),ue.value=!1)}));const oe=e=>{ue.value=!0,q.value=e;let a="/packageE/pages/aioveu_customer/sales_order/form";void 0!==e&&(a+=`?id=${e}`),y({url:a})},ie=e=>{const a=e?[e]:j.value;0!==a.length?k({title:"提示",content:"确认删除选中的销售订单吗？",success:e=>{e.confirm&&(w({title:"删除中..."}),A.deleteByIds(a.join(",")).then((()=>{i({title:"删除成功",icon:"success"}),le()})).catch((e=>{console.error("删除失败:",e),i({title:"删除失败",icon:"none"})})).finally((()=>C())))}}):i({title:"请选择要删除的销售订单",icon:"none"})},de=e=>{const a=X.value.find((a=>Number(a.value)===e));return a?a.label:"未知"},ne=e=>{const a=$.value.find((a=>Number(a.value)===e));return a?a.label:"未知"},re=e=>{const a=B.value.find((a=>Number(a.value)===e));return a?a.label:"未知"};return t((()=>{ae(),I.getAllCustomerOptions().then((e=>{Array.isArray(e)&&(T.value=e.map((e=>({customerId:Number(e.customerId),customerName:e.customerName}))))})).catch((e=>{console.error("加载客户选项失败:",e)})),S.getAllContactOptions().then((e=>{Array.isArray(e)&&(E.value=e.map((e=>({contactId:Number(e.contactId),contactName:e.contactName}))))})).catch((e=>{console.error("加载联系人选项失败:",e)})),D.getAllEmployeeOptions().then((e=>{Array.isArray(e)&&(U.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))})).catch((e=>{console.error("加载员工选项失败:",e)})),x.getDictItems("salesOrder_payment_status").then((e=>{X.value=e})),x.getDictItems("salesOrder_order_status").then((e=>{$.value=e})),x.getDictItems("salesOrder_shipping_method").then((e=>{B.value=e}))})),(e,a)=>{const l=f,s=d,t=m,i=p,y=b;return n(),u(s,{class:"app-container"},{default:o((()=>[r(s,{class:"search-container"},{default:o((()=>[r(s,{class:"filter-header",onClick:G},{default:o((()=>[r(l,null,{default:o((()=>[v("🔍 筛选条件")])),_:1}),r(l,null,{default:o((()=>[v(_(z.value?"▲":"▼"),1)])),_:1})])),_:1}),z.value?(n(),u(s,{key:0,class:"filter-content"},{default:o((()=>[r(s,{class:"filter-item"},{default:o((()=>[r(l,{class:"filter-label"},{default:o((()=>[v("订单ID")])),_:1}),r(t,{type:"text",class:"filter-input",placeholder:"请输入订单ID",modelValue:M.id,"onUpdate:modelValue":a[0]||(a[0]=e=>M.id=e),onConfirm:ae},null,8,["modelValue"])])),_:1}),r(s,{class:"filter-item"},{default:o((()=>[r(l,{class:"filter-label"},{default:o((()=>[v("订单编号")])),_:1}),r(t,{type:"text",class:"filter-input",placeholder:"请输入订单编号",modelValue:M.orderNo,"onUpdate:modelValue":a[1]||(a[1]=e=>M.orderNo=e),onConfirm:ae},null,8,["modelValue"])])),_:1}),r(s,{class:"filter-item"},{default:o((()=>[r(l,{class:"filter-label"},{default:o((()=>[v("客户")])),_:1}),r(i,{class:"filter-picker",mode:"selector",range:T.value,"range-key":"customerName",value:F.value,onChange:H},{default:o((()=>[r(s,{class:"picker-view"},{default:o((()=>[v(_(F.value>=0?T.value[F.value].customerName:"请选择客户"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(s,{class:"filter-item"},{default:o((()=>[r(l,{class:"filter-label"},{default:o((()=>[v("支付状态")])),_:1}),r(i,{class:"filter-picker",mode:"selector",range:X.value,"range-key":"label",value:W.value,onChange:K},{default:o((()=>[r(s,{class:"picker-view"},{default:o((()=>[v(_(W.value>=0?X.value[W.value].label:"请选择支付状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(s,{class:"filter-item"},{default:o((()=>[r(l,{class:"filter-label"},{default:o((()=>[v("订单状态")])),_:1}),r(i,{class:"filter-picker",mode:"selector",range:$.value,"range-key":"label",value:Y.value,onChange:L},{default:o((()=>[r(s,{class:"picker-view"},{default:o((()=>[v(_(Y.value>=0?$.value[Y.value].label:"请选择订单状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(s,{class:"filter-item"},{default:o((()=>[r(l,{class:"filter-label"},{default:o((()=>[v("运输方式")])),_:1}),r(i,{class:"filter-picker",mode:"selector",range:B.value,"range-key":"label",value:Z.value,onChange:Q},{default:o((()=>[r(s,{class:"picker-view"},{default:o((()=>[v(_(Z.value>=0?B.value[Z.value].label:"请选择运输方式"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(s,{class:"filter-item"},{default:o((()=>[r(l,{class:"filter-label"},{default:o((()=>[v("负责人")])),_:1}),r(i,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"employeeName",value:P.value,onChange:ee},{default:o((()=>[r(s,{class:"picker-view"},{default:o((()=>[v(_(P.value>=0?U.value[P.value].employeeName:"请选择负责人"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),r(s,{class:"filter-buttons"},{default:o((()=>[r(y,{class:"filter-btn reset",onClick:le},{default:o((()=>[v("重置")])),_:1}),r(y,{class:"filter-btn confirm",onClick:ae},{default:o((()=>[v("搜索")])),_:1})])),_:1})])),_:1})):c("",!0)])),_:1}),r(s,{class:"action-buttons"},{default:o((()=>[r(y,{"v-has-perm":["aioveuSalesOrder:aioveu-sales-order:add"],class:"action-btn add",onClick:a[2]||(a[2]=e=>oe())},{default:o((()=>[r(l,null,{default:o((()=>[v("+")])),_:1}),r(l,null,{default:o((()=>[v("新增")])),_:1})])),_:1}),r(y,{"v-has-perm":["aioveuSalesOrder:aioveu-sales-order:delete"],class:"action-btn delete",disabled:0===j.value.length,onClick:a[3]||(a[3]=e=>ie())},{default:o((()=>[r(l,null,{default:o((()=>[v("🗑️")])),_:1}),r(l,null,{default:o((()=>[v("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),r(s,{class:"list-container"},{default:o((()=>[O.value?(n(),u(s,{key:0,class:"loading-state"},{default:o((()=>[r(l,null,{default:o((()=>[v("加载中...")])),_:1})])),_:1})):0===R.value.length?(n(),u(s,{key:1,class:"empty-state"},{default:o((()=>[r(l,{class:"empty-icon"},{default:o((()=>[v("📦")])),_:1}),r(l,{class:"empty-text"},{default:o((()=>[v("暂无销售订单数据")])),_:1})])),_:1})):(n(!0),g(N,{key:2},h(R.value,(e=>(n(),u(s,{key:e.id,class:"sales-order-card"},{default:o((()=>[r(s,{class:"card-header"},{default:o((()=>[r(l,{class:"order-id"},{default:o((()=>[v("ID: "+_(e.id),1)])),_:2},1024),r(l,{class:"order-no"},{default:o((()=>[v(_(e.orderNo),1)])),_:2},1024)])),_:2},1024),r(s,{class:"card-content"},{default:o((()=>[r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("客户:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.customerName),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("联系人:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.contactName),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("下单时间:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.orderDate),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("预计交货:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.expectedDelivery),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("实际交货:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.actualDelivery),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("订单金额:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.totalAmount)+" "+_(e.currency),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("折扣率:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.discount),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("税率:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.taxRate),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("税额:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.taxAmount),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("总额:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.grandTotal),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("支付状态:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(de(e.paymentStatus)),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("订单状态:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(ne(e.orderStatus)),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("收货地址:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.shippingAddress),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("运输方式:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(re(e.shippingMethod)),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("物流单号:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.trackingNo),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("负责人:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.salesRepName),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("操作员:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.operatorName),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:o((()=>[r(l,{class:"info-label"},{default:o((()=>[v("备注:")])),_:1}),r(l,{class:"info-value"},{default:o((()=>[v(_(e.notes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),r(s,{class:"card-footer"},{default:o((()=>[r(s,{class:"time-info"},{default:o((()=>[r(l,null,{default:o((()=>[v("创建: "+_(e.createTime),1)])),_:2},1024),r(l,null,{default:o((()=>[v("更新: "+_(e.updateTime),1)])),_:2},1024)])),_:2},1024),r(s,{class:"action-buttons"},{default:o((()=>[r(y,{"v-has-perm":["aioveuSalesOrder:aioveu-sales-order:edit"],class:"action-btn edit",onClick:a=>oe(e.id)},{default:o((()=>[r(l,null,{default:o((()=>[v("✏️")])),_:1}),r(l,null,{default:o((()=>[v("编辑")])),_:1})])),_:2},1032,["onClick"]),r(y,{"v-has-perm":["aioveuSalesOrder:aioveu-sales-order:delete"],class:"action-btn delete",onClick:a=>ie(e.id)},{default:o((()=>[r(l,null,{default:o((()=>[v("🗑️")])),_:1}),r(l,null,{default:o((()=>[v("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),V.value>0?(n(),u(s,{key:3,class:"pagination"},{default:o((()=>[r(y,{class:"pagination-btn",disabled:M.pageNum<=1,onClick:se},{default:o((()=>[v(" 上一页 ")])),_:1},8,["disabled"]),r(l,{class:"page-info"},{default:o((()=>[v(_(M.pageNum)+" / "+_(Math.ceil(V.value/M.pageSize)),1)])),_:1}),r(y,{class:"pagination-btn",disabled:M.pageNum*M.pageSize>=V.value,onClick:te},{default:o((()=>[v(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):c("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-739a54c8"]]);export{j as default};
