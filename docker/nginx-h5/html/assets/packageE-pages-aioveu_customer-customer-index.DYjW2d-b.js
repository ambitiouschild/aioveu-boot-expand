import{d as e,h as l,y as a,Y as t,z as u,a as s,w as o,$ as c,i,o as r,e as n,b as d,s as f,g as v,t as m,a4 as _,a6 as p,a0 as b,c as g,F as y,r as h,X as k,aa as N,aI as C,aJ as w}from"./index-5U173LQ3.js";import{A as V}from"./aioveu-customer.MhylDKEJ.js";import{A as I}from"./aioveu-employee.t1i7jtWp.js";import{D as x}from"./dict.R0KYYCD_.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=D(e({__name:"index",setup(e){const D=l(!1),A=l([]),S=l(0),j=l(!1),R=a({pageNum:1,pageSize:10}),z=l([]),U=l([]),E=l([]),O=l([]),T=l([]),$=l([]),B=l([]),F=l(-1),J=l(-1),M=l(-1),P=l(-1),W=l(-1),X=l(-1),Y=l(void 0),q=()=>{j.value=!j.value},G=e=>{const l=e.detail.value;F.value=l,U.value[l]&&(R.name=U.value[l].customerName)},H=e=>{const l=e.detail.value;M.value=l,O.value[l]&&(R.type=Number(O.value[l].value))},K=e=>{const l=e.detail.value;P.value=l,T.value[l]&&(R.creditRating=Number(T.value[l].value))},L=e=>{const l=e.detail.value;W.value=l,$.value[l]&&(R.customerStatus=Number($.value[l].value))},Q=e=>{const l=e.detail.value;X.value=l,B.value[l]&&(R.source=Number(B.value[l].value))},Z=e=>{const l=e.detail.value;J.value=l,E.value[l]&&(R.salesRepName=E.value[l].employeeName)},ee=()=>{D.value=!0,V.getPage(R).then((e=>{z.value=e.list,S.value=e.total})).catch((e=>{console.error("查询客户失败:",e),c({title:"加载数据失败",icon:"none"})})).finally((()=>{D.value=!1}))},le=()=>{R.pageNum=1,R.customerNo="",R.name="",R.type=void 0,R.creditRating=void 0,R.customerStatus=void 0,R.city="",R.province="",R.phone="",R.source=void 0,R.salesRepName="",F.value=-1,J.value=-1,M.value=-1,P.value=-1,W.value=-1,X.value=-1,z.value=[],ee()},ae=()=>{R.pageNum>1&&(R.pageNum--,ee())},te=()=>{R.pageNum*R.pageSize<S.value&&(R.pageNum++,ee())},ue=l(!1);t((()=>{ue.value&&(ee(),ue.value=!1)}));const se=e=>{ue.value=!0,Y.value=e;let l="/packageE/pages/aioveu_customer/customer/form";void 0!==e&&(l+=`?id=${e}`),k({url:l})},oe=e=>{const l=e?[e]:A.value;0!==l.length?N({title:"提示",content:"确认删除选中的客户吗？",success:e=>{e.confirm&&(C({title:"删除中..."}),V.deleteByIds(l.join(",")).then((()=>{c({title:"删除成功",icon:"success"}),le()})).catch((e=>{console.error("删除失败:",e),c({title:"删除失败",icon:"none"})})).finally((()=>w())))}}):c({title:"请选择要删除的客户",icon:"none"})},ce=e=>{const l=O.value.find((l=>Number(l.value)===e));return l?l.label:"未知类型"},ie=e=>{const l=T.value.find((l=>Number(l.value)===e));return l?l.label:"未知等级"},re=e=>{const l=$.value.find((l=>Number(l.value)===e));return l?l.label:"未知状态"},ne=e=>{const l=B.value.find((l=>Number(l.value)===e));return l?l.label:"未知来源"};return u((()=>{ee(),V.getAllCustomerOptions().then((e=>{Array.isArray(e)&&(U.value=e.map((e=>({customerId:Number(e.customerId),customerName:e.customerName}))))})).catch((e=>{console.error("加载客户选项失败:",e)})),I.getAllEmployeeOptions().then((e=>{Array.isArray(e)&&(E.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))})).catch((e=>{console.error("加载员工选项失败:",e)})),x.getDictItems("customer_customer_type").then((e=>{O.value=e})),x.getDictItems("customer_credit_rating").then((e=>{T.value=e})),x.getDictItems("customer_status").then((e=>{$.value=e})),x.getDictItems("customer_source").then((e=>{B.value=e}))})),(e,l)=>{const a=f,t=i,u=_,c=p,k=b;return r(),s(t,{class:"app-container"},{default:o((()=>[n(t,{class:"search-container"},{default:o((()=>[n(t,{class:"filter-header",onClick:q},{default:o((()=>[n(a,null,{default:o((()=>[v("🔍 筛选条件")])),_:1}),n(a,null,{default:o((()=>[v(m(j.value?"▲":"▼"),1)])),_:1})])),_:1}),j.value?(r(),s(t,{key:0,class:"filter-content"},{default:o((()=>[n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("客户ID")])),_:1}),n(u,{type:"text",class:"filter-input",placeholder:"请输入客户ID",modelValue:R.id,"onUpdate:modelValue":l[0]||(l[0]=e=>R.id=e),onConfirm:ee},null,8,["modelValue"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("客户编号")])),_:1}),n(u,{type:"text",class:"filter-input",placeholder:"请输入客户编号",modelValue:R.customerNo,"onUpdate:modelValue":l[1]||(l[1]=e=>R.customerNo=e),onConfirm:ee},null,8,["modelValue"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("客户名称")])),_:1}),n(c,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"customerName",value:F.value,onChange:G},{default:o((()=>[n(t,{class:"picker-view"},{default:o((()=>[v(m(F.value>=0?U.value[F.value].customerName:"请选择客户"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("客户类型")])),_:1}),n(c,{class:"filter-picker",mode:"selector",range:O.value,"range-key":"label",value:M.value,onChange:H},{default:o((()=>[n(t,{class:"picker-view"},{default:o((()=>[v(m(M.value>=0?O.value[M.value].label:"请选择类型"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("信用等级")])),_:1}),n(c,{class:"filter-picker",mode:"selector",range:T.value,"range-key":"label",value:P.value,onChange:K},{default:o((()=>[n(t,{class:"picker-view"},{default:o((()=>[v(m(P.value>=0?T.value[P.value].label:"请选择等级"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("客户状态")])),_:1}),n(c,{class:"filter-picker",mode:"selector",range:$.value,"range-key":"label",value:W.value,onChange:L},{default:o((()=>[n(t,{class:"picker-view"},{default:o((()=>[v(m(W.value>=0?$.value[W.value].label:"请选择状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("所在城市")])),_:1}),n(u,{type:"text",class:"filter-input",placeholder:"请输入所在城市",modelValue:R.city,"onUpdate:modelValue":l[2]||(l[2]=e=>R.city=e),onConfirm:ee},null,8,["modelValue"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("所在省份")])),_:1}),n(u,{type:"text",class:"filter-input",placeholder:"请输入所在省份",modelValue:R.province,"onUpdate:modelValue":l[3]||(l[3]=e=>R.province=e),onConfirm:ee},null,8,["modelValue"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("联系电话")])),_:1}),n(u,{type:"tel",class:"filter-input",placeholder:"请输入联系电话",modelValue:R.phone,"onUpdate:modelValue":l[4]||(l[4]=e=>R.phone=e),onConfirm:ee},null,8,["modelValue"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("客户来源")])),_:1}),n(c,{class:"filter-picker",mode:"selector",range:B.value,"range-key":"label",value:X.value,onChange:Q},{default:o((()=>[n(t,{class:"picker-view"},{default:o((()=>[v(m(X.value>=0?B.value[X.value].label:"请选择来源"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"filter-item"},{default:o((()=>[n(a,{class:"filter-label"},{default:o((()=>[v("负责人")])),_:1}),n(c,{class:"filter-picker",mode:"selector",range:E.value,"range-key":"employeeName",value:J.value,onChange:Z},{default:o((()=>[n(t,{class:"picker-view"},{default:o((()=>[v(m(J.value>=0?E.value[J.value].employeeName:"请选择负责人"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"filter-buttons"},{default:o((()=>[n(k,{class:"filter-btn reset",onClick:le},{default:o((()=>[v("重置")])),_:1}),n(k,{class:"filter-btn confirm",onClick:ee},{default:o((()=>[v("搜索")])),_:1})])),_:1})])),_:1})):d("",!0)])),_:1}),n(t,{class:"action-buttons"},{default:o((()=>[n(k,{"v-has-perm":["aioveuCustomer:aioveu-customer:add"],class:"action-btn add _cl_v-has-perm aioveuCustomer_cl_aioveu-customer_cl_add",onClick:l[5]||(l[5]=e=>se())},{default:o((()=>[n(a,null,{default:o((()=>[v("+")])),_:1}),n(a,null,{default:o((()=>[v("新增")])),_:1})])),_:1}),n(k,{"v-has-perm":["aioveuCustomer:aioveu-customer:delete"],class:"action-btn delete _cl_v-has-perm aioveuCustomer_cl_aioveu-customer_cl_delete",disabled:0===A.value.length,onClick:l[6]||(l[6]=e=>oe())},{default:o((()=>[n(a,null,{default:o((()=>[v("🗑️")])),_:1}),n(a,null,{default:o((()=>[v("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),n(t,{class:"list-container"},{default:o((()=>[D.value?(r(),s(t,{key:0,class:"loading-state"},{default:o((()=>[n(a,null,{default:o((()=>[v("加载中...")])),_:1})])),_:1})):0===z.value.length?(r(),s(t,{key:1,class:"empty-state"},{default:o((()=>[n(a,{class:"empty-icon"},{default:o((()=>[v("👤")])),_:1}),n(a,{class:"empty-text"},{default:o((()=>[v("暂无客户数据")])),_:1})])),_:1})):(r(!0),g(y,{key:2},h(z.value,(e=>(r(),s(t,{key:e.id,class:"customer-card"},{default:o((()=>[n(t,{class:"card-header"},{default:o((()=>[n(a,{class:"customer-id"},{default:o((()=>[v("ID: "+m(e.id),1)])),_:2},1024),n(a,{class:"customer-name"},{default:o((()=>[v(m(e.name),1)])),_:2},1024)])),_:2},1024),n(t,{class:"card-content"},{default:o((()=>[n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("编号:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(e.customerNo),1)])),_:2},1024)])),_:2},1024),n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("类型:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(ce(e.type)),1)])),_:2},1024)])),_:2},1024),n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("信用等级:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(ie(e.creditRating)),1)])),_:2},1024)])),_:2},1024),n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("状态:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(re(e.customerStatus)),1)])),_:2},1024)])),_:2},1024),n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("城市:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(e.city),1)])),_:2},1024)])),_:2},1024),n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("省份:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(e.province),1)])),_:2},1024)])),_:2},1024),n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("电话:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(e.phone),1)])),_:2},1024)])),_:2},1024),n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("来源:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(ne(e.source)),1)])),_:2},1024)])),_:2},1024),n(t,{class:"info-row"},{default:o((()=>[n(a,{class:"info-label"},{default:o((()=>[v("负责人:")])),_:1}),n(a,{class:"info-value"},{default:o((()=>[v(m(e.salesRepName),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),n(t,{class:"card-footer"},{default:o((()=>[n(t,{class:"time-info"},{default:o((()=>[n(a,null,{default:o((()=>[v("创建: "+m(e.createTime),1)])),_:2},1024),n(a,null,{default:o((()=>[v("更新: "+m(e.updateTime),1)])),_:2},1024)])),_:2},1024),n(t,{class:"action-buttons"},{default:o((()=>[n(k,{"v-has-perm":["aioveuCustomer:aioveu-customer:edit"],class:"action-btn edit _cl_v-has-perm aioveuCustomer_cl_aioveu-customer_cl_edit",onClick:l=>se(e.id)},{default:o((()=>[n(a,null,{default:o((()=>[v("✏️")])),_:1}),n(a,null,{default:o((()=>[v("编辑")])),_:1})])),_:2},1032,["onClick"]),n(k,{"v-has-perm":["aioveuCustomer:aioveu-customer:delete"],class:"action-btn delete _cl_v-has-perm aioveuCustomer_cl_aioveu-customer_cl_delete",onClick:l=>oe(e.id)},{default:o((()=>[n(a,null,{default:o((()=>[v("🗑️")])),_:1}),n(a,null,{default:o((()=>[v("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),S.value>0?(r(),s(t,{key:3,class:"pagination"},{default:o((()=>[n(k,{class:"pagination-btn",disabled:R.pageNum<=1,onClick:ae},{default:o((()=>[v(" 上一页 ")])),_:1},8,["disabled"]),n(a,{class:"page-info"},{default:o((()=>[v(m(R.pageNum)+" / "+m(Math.ceil(S.value/R.pageSize)),1)])),_:1}),n(k,{class:"pagination-btn",disabled:R.pageNum*R.pageSize>=S.value,onClick:te},{default:o((()=>[v(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):d("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-94f8eb3f"]]);export{A as default};
