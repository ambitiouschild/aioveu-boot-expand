import{d as a,h as e,y as l,Y as t,z as s,a as u,w as i,i as o,o as c,e as d,b as n,s as f,g as r,t as _,a4 as m,a6 as v,a0 as p,c as g,F as b,r as y,X as k,$ as h,aa as N,aI as C,aJ as w}from"./index-5U173LQ3.js";import{A as I}from"./aioveu-material.D870okzX.js";import{A as x}from"./aioveu-category.DEnk_6py.js";import{D as V}from"./dict.R0KYYCD_.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=D(a({__name:"index",setup(a){const D=e(!1),A=e([]),j=e(0),P=e(!1),S=l({pageNum:1,pageSize:10}),z=e([]),M=e([]),U=e([]),T=e(-1),$=e(-1),B=()=>{P.value=!P.value},F=a=>{const e=a.detail.value;T.value=e,M.value[e]&&(S.categoryName=M.value[e].categoryName)},J=a=>{const e=a.detail.value;$.value=e,U.value[e]&&(S.isActive=Number(U.value[e].value))},K=()=>{D.value=!0,I.getPage(S).then((a=>{z.value=a.list,j.value=a.total})).finally((()=>{D.value=!1}))},L=()=>{S.pageNum=1,S.name="",S.categoryName="",S.barcode="",T.value=-1,$.value=-1,z.value=[],K()},O=()=>{S.pageNum>1&&(S.pageNum--,K())},X=()=>{S.pageNum*S.pageSize<j.value&&(S.pageNum++,K())},Y=e(!1);t((()=>{Y.value&&(K(),Y.value=!1)}));const q=a=>{Y.value=!0;let e="/packageD/pages/aioveu_material/material/form";void 0!==a&&(e+=`?id=${a}`),k({url:e})},E=a=>{const e=a?[a]:A.value;0!==e.length?N({title:"提示",content:"确认删除选中的物资吗？",success:a=>{a.confirm&&(C({title:"删除中..."}),I.deleteByIds(e.join(",")).then((()=>{h({title:"删除成功",icon:"success"}),L()})).finally((()=>w())))}}):h({title:"请选择要删除的物资",icon:"none"})},G=a=>{const e=U.value.find((e=>Number(e.value)===a));return e?e.label:"未知状态"};return s((()=>{K(),x.getAllCategoryOptions().then((a=>{Array.isArray(a)&&(M.value=a.map((a=>({categoryId:Number(a.categoryId),categoryName:a.categoryName}))))})),V.getDictItems("material_is_active").then((a=>{U.value=a}))})),(a,e)=>{const l=f,t=o,s=m,k=v,h=p;return c(),u(t,{class:"app-container"},{default:i((()=>[d(t,{class:"search-container"},{default:i((()=>[d(t,{class:"filter-header",onClick:B},{default:i((()=>[d(l,null,{default:i((()=>[r("🔍 筛选条件")])),_:1}),d(l,null,{default:i((()=>[r(_(P.value?"▲":"▼"),1)])),_:1})])),_:1}),P.value?(c(),u(t,{key:0,class:"filter-content"},{default:i((()=>[d(t,{class:"filter-item"},{default:i((()=>[d(l,{class:"filter-label"},{default:i((()=>[r("物资ID")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入物资ID",modelValue:S.id,"onUpdate:modelValue":e[0]||(e[0]=a=>S.id=a),onConfirm:K},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:i((()=>[d(l,{class:"filter-label"},{default:i((()=>[r("物资名称")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入物资名称",modelValue:S.name,"onUpdate:modelValue":e[1]||(e[1]=a=>S.name=a),onConfirm:K},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:i((()=>[d(l,{class:"filter-label"},{default:i((()=>[r("物资分类")])),_:1}),d(k,{class:"filter-picker",mode:"selector",range:M.value,"range-key":"categoryName",value:T.value,onChange:F},{default:i((()=>[d(t,{class:"picker-view"},{default:i((()=>[r(_(T.value>=0?M.value[T.value].categoryName:"请选择分类"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-item"},{default:i((()=>[d(l,{class:"filter-label"},{default:i((()=>[r("启用状态")])),_:1}),d(k,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"label",value:$.value,onChange:J},{default:i((()=>[d(t,{class:"picker-view"},{default:i((()=>[r(_($.value>=0?U.value[$.value].label:"请选择状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-item"},{default:i((()=>[d(l,{class:"filter-label"},{default:i((()=>[r("商品条码")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入商品条码",modelValue:S.barcode,"onUpdate:modelValue":e[2]||(e[2]=a=>S.barcode=a),onConfirm:K},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-buttons"},{default:i((()=>[d(h,{class:"filter-btn reset",onClick:L},{default:i((()=>[r("重置")])),_:1}),d(h,{class:"filter-btn confirm",onClick:K},{default:i((()=>[r("搜索")])),_:1})])),_:1})])),_:1})):n("",!0)])),_:1}),d(t,{class:"action-buttons"},{default:i((()=>[d(h,{"v-has-perm":["aioveuMaterial:aioveuProcurement-material:add"],class:"action-btn add",onClick:e[3]||(e[3]=a=>q())},{default:i((()=>[d(l,null,{default:i((()=>[r("+")])),_:1}),d(l,null,{default:i((()=>[r("新增")])),_:1})])),_:1}),d(h,{"v-has-perm":["aioveuMaterial:aioveuProcurement-material:delete"],class:"action-btn delete",disabled:0===A.value.length,onClick:e[4]||(e[4]=a=>E())},{default:i((()=>[d(l,null,{default:i((()=>[r("🗑️")])),_:1}),d(l,null,{default:i((()=>[r("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),d(t,{class:"list-container"},{default:i((()=>[D.value?(c(),u(t,{key:0,class:"loading-state"},{default:i((()=>[d(l,null,{default:i((()=>[r("加载中...")])),_:1})])),_:1})):0===z.value.length?(c(),u(t,{key:1,class:"empty-state"},{default:i((()=>[d(l,{class:"empty-icon"},{default:i((()=>[r("📁")])),_:1}),d(l,{class:"empty-text"},{default:i((()=>[r("暂无物资数据")])),_:1})])),_:1})):(c(!0),g(b,{key:2},y(z.value,(a=>(c(),u(t,{key:a.id,class:"material-card"},{default:i((()=>[d(t,{class:"card-header"},{default:i((()=>[d(l,{class:"material-id"},{default:i((()=>[r("ID: "+_(a.id),1)])),_:2},1024),d(l,{class:"material-name"},{default:i((()=>[r(_(a.name),1)])),_:2},1024)])),_:2},1024),d(t,{class:"card-content"},{default:i((()=>[d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[r("分类:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[r(_(a.categoryName),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[r("单位:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[r(_(a.unit),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[r("规格型号:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[r(_(a.spec),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[r("采购单价:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[r(_(a.purchasePrice),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[r("供应商ID:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[r(_(a.supplierId),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[r("库存范围:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[r(_(a.minStock)+" - "+_(a.maxStock),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[r("启用状态:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[r(_(G(a.isActive)),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:i((()=>[d(l,{class:"info-label"},{default:i((()=>[r("商品条码:")])),_:1}),d(l,{class:"info-value"},{default:i((()=>[r(_(a.barcode),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(t,{class:"card-footer"},{default:i((()=>[d(t,{class:"time-info"},{default:i((()=>[d(l,null,{default:i((()=>[r("创建: "+_(a.createTime),1)])),_:2},1024),d(l,null,{default:i((()=>[r("更新: "+_(a.updateTime),1)])),_:2},1024)])),_:2},1024),d(t,{class:"action-buttons"},{default:i((()=>[d(h,{"v-has-perm":["aioveuMaterial:aioveuProcurement-material:edit"],class:"action-btn edit",onClick:e=>q(a.id)},{default:i((()=>[d(l,null,{default:i((()=>[r("✏️")])),_:1}),d(l,null,{default:i((()=>[r("编辑")])),_:1})])),_:2},1032,["onClick"]),d(h,{"v-has-perm":["aioveuMaterial:aioveuProcurement-material:delete"],class:"action-btn delete",onClick:e=>E(a.id)},{default:i((()=>[d(l,null,{default:i((()=>[r("🗑️")])),_:1}),d(l,null,{default:i((()=>[r("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),j.value>0?(c(),u(t,{key:3,class:"pagination"},{default:i((()=>[d(h,{class:"pagination-btn",disabled:S.pageNum<=1,onClick:O},{default:i((()=>[r(" 上一页 ")])),_:1},8,["disabled"]),d(l,{class:"page-info"},{default:i((()=>[r(_(S.pageNum)+" / "+_(Math.ceil(j.value/S.pageSize)),1)])),_:1}),d(h,{class:"pagination-btn",disabled:S.pageNum*S.pageSize>=j.value,onClick:X},{default:i((()=>[r(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):n("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-e1fd2145"]]);export{A as default};
