import{d as e,h as a,y as l,al as t,$ as o,k as s,a as u,w as r,i as d,o as m,e as n,s as i,g as c,t as f,ay as v,a4 as p,a6 as _,a0 as g,aI as h,a3 as b,aJ as y}from"./index-5U173LQ3.js";import{A as N}from"./aioveu-employee.CCWXpWw-.js";import{A as k}from"./aioveu-department.Ni2j20Wl.js";import{A as V}from"./aioveu-position.5P-apEWx.js";import{D as C}from"./dict.R0KYYCD_.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=D(e({__name:"form",setup(e){const D=a("新增员工"),I=a(void 0),x=a(!1),w=l({}),A=a(-1),j=a([]),U=a(-1),O=a([]),E=a(-1),F=["离职","在职","休假","实习"],$=a(-1),G=a([]);t((e=>{if(console.log("页面参数:",e),P(),R(),Q(),null==e?void 0:e.employeeId)try{const a=decodeURIComponent(e.employeeId);if("string"!=typeof a||isNaN(Number(a)))throw new Error(`无效的员工ID: ${a}`);const l=Number(a);I.value=l,D.value="编辑员工",J()}catch(a){console.error("参数解析错误:",a),o({title:"参数错误",icon:"none"})}else D.value="新增员工"}));const J=()=>{I.value&&(x.value=!0,N.getFormData(I.value).then((e=>{if(Object.assign(w,e),void 0!==w.gender){const e=String(w.gender),a=G.value.findIndex((a=>a.value===e));-1!==a&&(A.value=a)}})).finally((()=>{x.value=!1})))},P=()=>{k.getAllDepartmentOptions().then((e=>{Array.isArray(e)&&(j.value=e.map((e=>({deptId:Number(e.deptId),deptName:e.deptName}))))}))},R=()=>{V.getAllPositionOptions().then((e=>{Array.isArray(e)&&(O.value=e.map((e=>({positionId:Number(e.positionId),positionName:e.positionName}))))}))},S=e=>{const a=e.detail.value;A.value=a,G.value[a]&&(w.gender=Number(G.value[a].value))},q=e=>{const a=e.detail.value;U.value=a,j.value[a]&&(w.deptName=j.value[a].deptName)},z=e=>{const a=e.detail.value;E.value=a,O.value[a]&&(w.positionName=O.value[a].positionName)},B=e=>{const a=e.detail.value;$.value=a,w.status=a},H=e=>{w.birthDate=e.detail.value},K=e=>{w.hireDate=e.detail.value,console.log("入职日期:",w.hireDate)},L=()=>{M()&&(h({title:"提交中..."}),I.value?N.update(I.value,w).then((()=>{o({title:"修改成功",icon:"success"}),b()})).finally((()=>y())):N.add(w).then((()=>{o({title:"新增成功",icon:"success"}),b()})).finally((()=>y())))},M=()=>w.empCode?w.name?!!w.phone||(o({title:"请输入手机号码",icon:"none"}),!1):(o({title:"请输入姓名",icon:"none"}),!1):(o({title:"请输入员工编号",icon:"none"}),!1),Q=()=>{C.getDictItems("gender").then((e=>{G.value=e,console.log("性别字典数据:",e),!I.value&&e.length>0&&(A.value=0,w.gender=Number(e[0].value))})).catch((e=>{console.error("加载性别状态选项失败:",e)}))};s([()=>G.value,()=>w.gender],(([e,a])=>{if(e.length>0&&void 0!==a){const l=e.findIndex((e=>Number(e.value)===a));-1!==l&&(A.value=l)}}),{immediate:!0});const T=()=>{b()};return(e,a)=>{const l=i,t=d,o=p,s=_,h=v,b=g;return m(),u(t,{class:"form-container"},{default:r((()=>[n(t,{class:"form-header"},{default:r((()=>[n(l,{class:"form-title"},{default:r((()=>[c(f(D.value),1)])),_:1})])),_:1}),n(h,{class:"form-body scroll-y","scroll-y":""},{default:r((()=>[n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("员工编号")])),_:1}),n(o,{type:"text",class:"form-input",placeholder:"请输入员工编号",modelValue:w.empCode,"onUpdate:modelValue":a[0]||(a[0]=e=>w.empCode=e)},null,8,["modelValue"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("姓名")])),_:1}),n(o,{type:"text",class:"form-input",placeholder:"请输入姓名",modelValue:w.name,"onUpdate:modelValue":a[1]||(a[1]=e=>w.name=e)},null,8,["modelValue"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("性别")])),_:1}),n(s,{class:"form-picker",mode:"selector",range:G.value,"range-key":"label",value:A.value,onChange:S},{default:r((()=>[n(t,{class:"picker-view"},{default:r((()=>[c(f(A.value>=0?G.value[A.value].label:"请选择性别"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("出生日期")])),_:1}),n(s,{class:"form-picker",mode:"date",value:w.birthDate,onChange:H},{default:r((()=>[n(t,{class:"picker-view"},{default:r((()=>[c(f(w.birthDate||"请选择出生日期"),1)])),_:1})])),_:1},8,["value"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("身份证号")])),_:1}),n(o,{type:"text",class:"form-input",placeholder:"请输入身份证号",modelValue:w.idCard,"onUpdate:modelValue":a[2]||(a[2]=e=>w.idCard=e)},null,8,["modelValue"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("手机号码")])),_:1}),n(o,{type:"text",class:"form-input",placeholder:"请输入手机号码",modelValue:w.phone,"onUpdate:modelValue":a[3]||(a[3]=e=>w.phone=e)},null,8,["modelValue"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("邮箱")])),_:1}),n(o,{type:"text",class:"form-input",placeholder:"请输入邮箱",modelValue:w.email,"onUpdate:modelValue":a[4]||(a[4]=e=>w.email=e)},null,8,["modelValue"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("所属部门")])),_:1}),n(s,{class:"form-picker",mode:"selector",range:j.value,"range-key":"deptName",value:U.value,onChange:q},{default:r((()=>[n(t,{class:"picker-view"},{default:r((()=>[c(f(U.value>=0?j.value[U.value].deptName:"请选择部门"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("所属岗位")])),_:1}),n(s,{class:"form-picker",mode:"selector",range:O.value,"range-key":"positionName",value:E.value,onChange:z},{default:r((()=>[n(t,{class:"picker-view"},{default:r((()=>[c(f(E.value>=0?O.value[E.value].positionName:"请选择岗位"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("入职日期")])),_:1}),n(s,{class:"form-picker",mode:"date",value:w.hireDate,onChange:K},{default:r((()=>[n(t,{class:"picker-view"},{default:r((()=>[c(f(w.hireDate||"请选择入职日期"),1)])),_:1})])),_:1},8,["value"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("基本薪资")])),_:1}),n(o,{type:"number",class:"form-input",placeholder:"请输入基本薪资",modelValue:w.salary,"onUpdate:modelValue":a[5]||(a[5]=e=>w.salary=e)},null,8,["modelValue"])])),_:1}),n(t,{class:"form-item"},{default:r((()=>[n(l,{class:"form-label"},{default:r((()=>[c("状态")])),_:1}),n(s,{class:"form-picker",mode:"selector",range:F,value:$.value,onChange:B},{default:r((()=>[n(t,{class:"picker-view"},{default:r((()=>[c(f($.value>=0?F[$.value]:"请选择状态"),1)])),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),n(t,{class:"form-footer"},{default:r((()=>[n(b,{class:"form-btn cancel",onClick:T},{default:r((()=>[c("取消")])),_:1}),n(b,{class:"form-btn confirm",onClick:L},{default:r((()=>[c("提交")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-25b03b91"]]);export{I as default};
