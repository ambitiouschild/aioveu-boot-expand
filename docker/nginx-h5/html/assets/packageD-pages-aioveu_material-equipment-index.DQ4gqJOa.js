import{d as e,h as a,y as l,Y as t,z as s,a as u,w as o,$ as i,i as n,o as c,e as d,b as r,s as f,g as m,t as v,a4 as p,a6 as _,a0 as g,c as y,F as b,r as N,X as h,aa as k,aI as C,aJ as q}from"./index-5U173LQ3.js";import{A as w}from"./aioveu-equipment.Cs6gwxur.js";import{A as V}from"./aioveu-employee.BSG7yiTE.js";import{A as I}from"./aioveu-category.DEnk_6py.js";import{D as x}from"./dict.R0KYYCD_.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D=A(e({__name:"index",setup(e){const A=a(!1),D=a([]),P=a(0),j=a(!1),z=l({pageNum:1,pageSize:10}),E=a([]),S=a([]),U=a([]),O=a([]),T=a(-1),$=a(-1),B=a(-1),F=a(void 0),J=()=>{j.value=!j.value},K=e=>{const a=e.detail.value;T.value=a,S.value[a]&&(z.categoryName=S.value[a].categoryName)},M=e=>{const a=e.detail.value;$.value=a,U.value[a]&&(z.responsiblePersonName=U.value[a].employeeName)},R=e=>{const a=e.detail.value;B.value=a,O.value[a]&&(z.status=Number(O.value[a].value))},X=()=>{A.value=!0,w.getPage(z).then((e=>{E.value=e.list,P.value=e.total})).catch((e=>{console.error("查询设备失败:",e),i({title:"加载数据失败",icon:"none"})})).finally((()=>{A.value=!1}))},Y=()=>{z.pageNum=1,z.assetNo="",z.name="",z.categoryName="",z.serialNo="",z.responsiblePersonName="",z.status=void 0,T.value=-1,$.value=-1,B.value=-1,E.value=[],X()},G=()=>{z.pageNum>1&&(z.pageNum--,X())},H=()=>{z.pageNum*z.pageSize<P.value&&(z.pageNum++,X())},L=a(!1);t((()=>{L.value&&(X(),L.value=!1)}));const Q=e=>{L.value=!0,F.value=e;let a="/packageD/pages/aioveu_material/equipment/form";void 0!==e&&(a+=`?id=${e}`),h({url:a})},W=e=>{const a=e?[e]:D.value;0!==a.length?k({title:"提示",content:"确认删除选中的设备吗？",success:e=>{e.confirm&&(C({title:"删除中..."}),w.deleteByIds(a.join(",")).then((()=>{i({title:"删除成功",icon:"success"}),Y()})).catch((e=>{console.error("删除失败:",e),i({title:"删除失败",icon:"none"})})).finally((()=>q())))}}):i({title:"请选择要删除的设备",icon:"none"})},Z=e=>{const a=O.value.find((a=>Number(a.value)===e));return a?a.label:"未知状态"};return s((()=>{X(),I.getAllCategoryOptions().then((e=>{Array.isArray(e)&&(S.value=e.map((e=>({categoryId:Number(e.categoryId),categoryName:e.categoryName}))))})).catch((e=>{console.error("加载分类选项失败:",e)})),V.getAllEmployeeOptions().then((e=>{Array.isArray(e)&&(U.value=e.map((e=>({employeeId:Number(e.employeeId),employeeName:e.employeeName}))))})).catch((e=>{console.error("加载员工选项失败:",e)})),x.getDictItems("equipment_status").then((e=>{O.value=e})).catch((e=>{console.error("加载状态选项失败:",e)}))})),(e,a)=>{const l=f,t=n,s=p,i=_,h=g;return c(),u(t,{class:"app-container"},{default:o((()=>[d(t,{class:"search-container"},{default:o((()=>[d(t,{class:"filter-header",onClick:J},{default:o((()=>[d(l,null,{default:o((()=>[m("🔍 筛选条件")])),_:1}),d(l,null,{default:o((()=>[m(v(j.value?"▲":"▼"),1)])),_:1})])),_:1}),j.value?(c(),u(t,{key:0,class:"filter-content"},{default:o((()=>[d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[m("设备ID")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入设备ID",modelValue:z.id,"onUpdate:modelValue":a[0]||(a[0]=e=>z.id=e),onConfirm:X},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[m("资产编号")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入资产编号",modelValue:z.assetNo,"onUpdate:modelValue":a[1]||(a[1]=e=>z.assetNo=e),onConfirm:X},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[m("设备名称")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入设备名称",modelValue:z.name,"onUpdate:modelValue":a[2]||(a[2]=e=>z.name=e),onConfirm:X},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[m("设备分类")])),_:1}),d(i,{class:"filter-picker",mode:"selector",range:S.value,"range-key":"categoryName",value:T.value,onChange:K},{default:o((()=>[d(t,{class:"picker-view"},{default:o((()=>[m(v(T.value>=0?S.value[T.value].categoryName:"请选择设备分类"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[m("序列号")])),_:1}),d(s,{type:"text",class:"filter-input",placeholder:"请输入序列号",modelValue:z.serialNo,"onUpdate:modelValue":a[3]||(a[3]=e=>z.serialNo=e),onConfirm:X},null,8,["modelValue"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[m("责任人")])),_:1}),d(i,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"employeeName",value:$.value,onChange:M},{default:o((()=>[d(t,{class:"picker-view"},{default:o((()=>[m(v($.value>=0?U.value[$.value].employeeName:"请选择责任人"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-item"},{default:o((()=>[d(l,{class:"filter-label"},{default:o((()=>[m("状态")])),_:1}),d(i,{class:"filter-picker",mode:"selector",range:O.value,"range-key":"label",value:B.value,onChange:R},{default:o((()=>[d(t,{class:"picker-view"},{default:o((()=>[m(v(B.value>=0?O.value[B.value].label:"请选择状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),d(t,{class:"filter-buttons"},{default:o((()=>[d(h,{class:"filter-btn reset",onClick:Y},{default:o((()=>[m("重置")])),_:1}),d(h,{class:"filter-btn confirm",onClick:X},{default:o((()=>[m("搜索")])),_:1})])),_:1})])),_:1})):r("",!0)])),_:1}),d(t,{class:"action-buttons"},{default:o((()=>[d(h,{"v-has-perm":["aioveuEquipment:aioveuProcurement-equipment:add"],class:"action-btn add",onClick:a[4]||(a[4]=e=>Q())},{default:o((()=>[d(l,null,{default:o((()=>[m("+")])),_:1}),d(l,null,{default:o((()=>[m("新增")])),_:1})])),_:1}),d(h,{"v-has-perm":["aioveuEquipment:aioveuProcurement-equipment:delete"],class:"action-btn delete",disabled:0===D.value.length,onClick:a[5]||(a[5]=e=>W())},{default:o((()=>[d(l,null,{default:o((()=>[m("🗑️")])),_:1}),d(l,null,{default:o((()=>[m("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),d(t,{class:"list-container"},{default:o((()=>[A.value?(c(),u(t,{key:0,class:"loading-state"},{default:o((()=>[d(l,null,{default:o((()=>[m("加载中...")])),_:1})])),_:1})):0===E.value.length?(c(),u(t,{key:1,class:"empty-state"},{default:o((()=>[d(l,{class:"empty-icon"},{default:o((()=>[m("📁")])),_:1}),d(l,{class:"empty-text"},{default:o((()=>[m("暂无设备数据")])),_:1})])),_:1})):(c(!0),y(b,{key:2},N(E.value,(e=>(c(),u(t,{key:e.id,class:"equipment-card"},{default:o((()=>[d(t,{class:"card-header"},{default:o((()=>[d(l,{class:"equipment-id"},{default:o((()=>[m("ID: "+v(e.id),1)])),_:2},1024),d(l,{class:"equipment-name"},{default:o((()=>[m(v(e.name),1)])),_:2},1024)])),_:2},1024),d(t,{class:"card-content"},{default:o((()=>[d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[m("资产编号:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[m(v(e.assetNo),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[m("设备分类:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[m(v(e.categoryName),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[m("型号:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[m(v(e.model),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[m("序列号:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[m(v(e.serialNo),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[m("所属部门:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[m(v(e.departmentName),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[m("责任人:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[m(v(e.responsiblePersonName),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[m("采购日期:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[m(v(e.purchaseDate),1)])),_:2},1024)])),_:2},1024),d(t,{class:"info-row"},{default:o((()=>[d(l,{class:"info-label"},{default:o((()=>[m("状态:")])),_:1}),d(l,{class:"info-value"},{default:o((()=>[m(v(Z(e.status)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(t,{class:"card-footer"},{default:o((()=>[d(t,{class:"time-info"},{default:o((()=>[d(l,null,{default:o((()=>[m("创建: "+v(e.createTime),1)])),_:2},1024),d(l,null,{default:o((()=>[m("更新: "+v(e.updateTime),1)])),_:2},1024)])),_:2},1024),d(t,{class:"action-buttons"},{default:o((()=>[d(h,{"v-has-perm":["aioveuEquipment:aioveuProcurement-equipment:edit"],class:"action-btn edit",onClick:a=>Q(e.id)},{default:o((()=>[d(l,null,{default:o((()=>[m("✏️")])),_:1}),d(l,null,{default:o((()=>[m("编辑")])),_:1})])),_:2},1032,["onClick"]),d(h,{"v-has-perm":["aioveuEquipment:aioveuProcurement-equipment:delete"],class:"action-btn delete",onClick:a=>W(e.id)},{default:o((()=>[d(l,null,{default:o((()=>[m("🗑️")])),_:1}),d(l,null,{default:o((()=>[m("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),P.value>0?(c(),u(t,{key:3,class:"pagination"},{default:o((()=>[d(h,{class:"pagination-btn",disabled:z.pageNum<=1,onClick:G},{default:o((()=>[m(" 上一页 ")])),_:1},8,["disabled"]),d(l,{class:"page-info"},{default:o((()=>[m(v(z.pageNum)+" / "+v(Math.ceil(P.value/z.pageSize)),1)])),_:1}),d(h,{class:"pagination-btn",disabled:z.pageNum*z.pageSize>=P.value,onClick:H},{default:o((()=>[m(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):r("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-e9d9fa51"]]);export{D as default};
