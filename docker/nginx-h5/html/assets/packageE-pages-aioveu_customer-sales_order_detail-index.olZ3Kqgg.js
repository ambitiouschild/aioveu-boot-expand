import{d as e,h as a,y as l,Y as s,z as t,a as u,w as i,$ as o,i as r,o as d,e as n,b as f,s as c,g as v,t as _,a4 as m,a6 as p,a0 as b,c as g,F as h,r as N,X as k,aa as w,aI as y,aJ as O}from"./index-5U173LQ3.js";import{A as C,a as I,b as A}from"./aioveu-warehouse.C1Qj9JK7.js";import{A as D}from"./aioveu-sales-order.NYwjDYB-.js";import{D as S}from"./dict.R0KYYCD_.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=x(e({__name:"index",setup(e){const x=a(!1),j=a([]),z=a(0),P=a(!1),V=l({pageNum:1,pageSize:10}),M=a([]),T=a([]),$=a([]),q=a([]),B=a([]),E=a(-1),F=a(-1),J=a(-1),R=a(-1),U=a(void 0),W=()=>{P.value=!P.value},X=e=>{const a=e.detail.value;E.value=a,T.value[a]&&(V.orderName=T.value[a].salesOrderNo)},Y=e=>{const a=e.detail.value;F.value=a,$.value[a]&&(V.materialName=$.value[a].materialName)},Z=e=>{const a=e.detail.value;J.value=a,q.value[a]&&(V.warehouseName=q.value[a].warehouseName)},G=e=>{const a=e.detail.value;R.value=a,B.value[a]&&(V.status=Number(B.value[a].value))},H=()=>{x.value=!0,C.getPage(V).then((e=>{M.value=e.list,z.value=e.total})).catch((e=>{console.error("æŸ¥è¯¢è®¢å•æ˜Žç»†å¤±è´¥:",e),o({title:"åŠ è½½æ•°æ®å¤±è´¥",icon:"none"})})).finally((()=>{x.value=!1}))},K=()=>{V.pageNum=1,V.orderName="",V.materialName="",V.warehouseName="",V.status=void 0,E.value=-1,F.value=-1,J.value=-1,R.value=-1,M.value=[],H()},L=()=>{V.pageNum>1&&(V.pageNum--,H())},Q=()=>{V.pageNum*V.pageSize<z.value&&(V.pageNum++,H())},ee=a(!1);s((()=>{ee.value&&(H(),ee.value=!1)}));const ae=e=>{ee.value=!0,U.value=e;let a="/packageE/pages/aioveu_customer/sales_order_detail/form";void 0!==e&&(a+=`?id=${e}`),k({url:a})},le=e=>{const a=e?[e]:j.value;0!==a.length?w({title:"æç¤º",content:"ç¡®è®¤åˆ é™¤é€‰ä¸­çš„è®¢å•æ˜Žç»†å—ï¼Ÿ",success:e=>{e.confirm&&(y({title:"åˆ é™¤ä¸­..."}),C.deleteByIds(a.join(",")).then((()=>{o({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),K()})).catch((e=>{console.error("åˆ é™¤å¤±è´¥:",e),o({title:"åˆ é™¤å¤±è´¥",icon:"none"})})).finally((()=>O())))}}):o({title:"è¯·é€‰æ‹©è¦åˆ é™¤çš„è®¢å•æ˜Žç»†",icon:"none"})},se=e=>{const a=B.value.find((a=>Number(a.value)===e));return a?a.label:"æœªçŸ¥"};return t((()=>{H(),D.getAllSalesOrderOptions().then((e=>{Array.isArray(e)&&(T.value=e.map((e=>({salesOrderId:Number(e.salesOrderId),salesOrderNo:e.salesOrderNo}))))})).catch((e=>{console.error("åŠ è½½é”€å”®è®¢å•é€‰é¡¹å¤±è´¥:",e)})),I.getAllMaterialOptions().then((e=>{Array.isArray(e)&&($.value=e.map((e=>({materialId:Number(e.materialId),materialName:e.materialName}))))})).catch((e=>{console.error("åŠ è½½ç‰©èµ„é€‰é¡¹å¤±è´¥:",e)})),A.getAllWarehouseOptions().then((e=>{Array.isArray(e)&&(q.value=e.map((e=>({warehouseId:Number(e.warehouseId),warehouseName:e.warehouseName}))))})).catch((e=>{console.error("åŠ è½½ä»“åº“é€‰é¡¹å¤±è´¥:",e)})),S.getDictItems("salesOrderDetail_status").then((e=>{B.value=e}))})),(e,a)=>{const l=c,s=r,t=m,o=p,k=b;return d(),u(s,{class:"app-container"},{default:i((()=>[n(s,{class:"search-container"},{default:i((()=>[n(s,{class:"filter-header",onClick:W},{default:i((()=>[n(l,null,{default:i((()=>[v("ðŸ” ç­›é€‰æ¡ä»¶")])),_:1}),n(l,null,{default:i((()=>[v(_(P.value?"â–²":"â–¼"),1)])),_:1})])),_:1}),P.value?(d(),u(s,{key:0,class:"filter-content"},{default:i((()=>[n(s,{class:"filter-item"},{default:i((()=>[n(l,{class:"filter-label"},{default:i((()=>[v("æ˜Žç»†ID")])),_:1}),n(t,{type:"text",class:"filter-input",placeholder:"è¯·è¾“å…¥æ˜Žç»†ID",modelValue:V.id,"onUpdate:modelValue":a[0]||(a[0]=e=>V.id=e),onConfirm:H},null,8,["modelValue"])])),_:1}),n(s,{class:"filter-item"},{default:i((()=>[n(l,{class:"filter-label"},{default:i((()=>[v("è®¢å•")])),_:1}),n(o,{class:"filter-picker",mode:"selector",range:T.value,"range-key":"salesOrderNo",value:E.value,onChange:X},{default:i((()=>[n(s,{class:"picker-view"},{default:i((()=>[v(_(E.value>=0?T.value[E.value].salesOrderNo:"è¯·é€‰æ‹©è®¢å•"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(s,{class:"filter-item"},{default:i((()=>[n(l,{class:"filter-label"},{default:i((()=>[v("ç‰©èµ„")])),_:1}),n(o,{class:"filter-picker",mode:"selector",range:$.value,"range-key":"materialName",value:F.value,onChange:Y},{default:i((()=>[n(s,{class:"picker-view"},{default:i((()=>[v(_(F.value>=0?$.value[F.value].materialName:"è¯·é€‰æ‹©ç‰©èµ„"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(s,{class:"filter-item"},{default:i((()=>[n(l,{class:"filter-label"},{default:i((()=>[v("å‘è´§ä»“åº“")])),_:1}),n(o,{class:"filter-picker",mode:"selector",range:q.value,"range-key":"warehouseName",value:J.value,onChange:Z},{default:i((()=>[n(s,{class:"picker-view"},{default:i((()=>[v(_(J.value>=0?q.value[J.value].warehouseName:"è¯·é€‰æ‹©å‘è´§ä»“åº“"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(s,{class:"filter-item"},{default:i((()=>[n(l,{class:"filter-label"},{default:i((()=>[v("æ˜Žç»†çŠ¶æ€")])),_:1}),n(o,{class:"filter-picker",mode:"selector",range:B.value,"range-key":"label",value:R.value,onChange:G},{default:i((()=>[n(s,{class:"picker-view"},{default:i((()=>[v(_(R.value>=0?B.value[R.value].label:"è¯·é€‰æ‹©æ˜Žç»†çŠ¶æ€"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),n(s,{class:"filter-buttons"},{default:i((()=>[n(k,{class:"filter-btn reset",onClick:K},{default:i((()=>[v("é‡ç½®")])),_:1}),n(k,{class:"filter-btn confirm",onClick:H},{default:i((()=>[v("æœç´¢")])),_:1})])),_:1})])),_:1})):f("",!0)])),_:1}),n(s,{class:"action-buttons"},{default:i((()=>[n(k,{"v-has-perm":["aioveuSalesOrderDetail:aioveu-sales-order-detail:add"],class:"action-btn add",onClick:a[1]||(a[1]=e=>ae())},{default:i((()=>[n(l,null,{default:i((()=>[v("+")])),_:1}),n(l,null,{default:i((()=>[v("æ–°å¢ž")])),_:1})])),_:1}),n(k,{"v-has-perm":["aioveuSalesOrderDetail:aioveu-sales-order-detail:delete"],class:"action-btn delete",disabled:0===j.value.length,onClick:a[2]||(a[2]=e=>le())},{default:i((()=>[n(l,null,{default:i((()=>[v("ðŸ—‘ï¸")])),_:1}),n(l,null,{default:i((()=>[v("åˆ é™¤")])),_:1})])),_:1},8,["disabled"])])),_:1}),n(s,{class:"list-container"},{default:i((()=>[x.value?(d(),u(s,{key:0,class:"loading-state"},{default:i((()=>[n(l,null,{default:i((()=>[v("åŠ è½½ä¸­...")])),_:1})])),_:1})):0===M.value.length?(d(),u(s,{key:1,class:"empty-state"},{default:i((()=>[n(l,{class:"empty-icon"},{default:i((()=>[v("ðŸ“‹")])),_:1}),n(l,{class:"empty-text"},{default:i((()=>[v("æš‚æ— è®¢å•æ˜Žç»†æ•°æ®")])),_:1})])),_:1})):(d(!0),g(h,{key:2},N(M.value,(e=>(d(),u(s,{key:e.id,class:"detail-card"},{default:i((()=>[n(s,{class:"card-header"},{default:i((()=>[n(l,{class:"detail-id"},{default:i((()=>[v("ID: "+_(e.id),1)])),_:2},1024)])),_:2},1024),n(s,{class:"card-content"},{default:i((()=>[n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("è®¢å•:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.salesOrderNo),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("ç‰©èµ„:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.materialName),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("æ•°é‡:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.quantity),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("å•ä»·:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.unitPrice),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("æŠ˜æ‰£çŽ‡:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.discount),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("ç¨ŽçŽ‡:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.taxRate),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("å°è®¡:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.subtotal),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("ç¨Žé¢:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.taxAmount),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("æ€»é‡‘é¢:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.totalPrice),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("æ‰¹æ¬¡å·:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.batchNumber),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("è¦æ±‚äº¤è´§æ—¥æœŸ:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.deliveryDate),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("å‘è´§ä»“åº“:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.warehouseName),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("æ˜Žç»†çŠ¶æ€:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(se(e.status)),1)])),_:2},1024)])),_:2},1024),n(s,{class:"info-row"},{default:i((()=>[n(l,{class:"info-label"},{default:i((()=>[v("å¤‡æ³¨:")])),_:1}),n(l,{class:"info-value"},{default:i((()=>[v(_(e.notes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),n(s,{class:"card-footer"},{default:i((()=>[n(s,{class:"time-info"},{default:i((()=>[n(l,null,{default:i((()=>[v("åˆ›å»º: "+_(e.createTime),1)])),_:2},1024),n(l,null,{default:i((()=>[v("æ›´æ–°: "+_(e.updateTime),1)])),_:2},1024)])),_:2},1024),n(s,{class:"action-buttons"},{default:i((()=>[n(k,{"v-has-perm":["aioveuSalesOrderDetail:aioveu-sales-order-detail:edit"],class:"action-btn edit",onClick:a=>ae(e.id)},{default:i((()=>[n(l,null,{default:i((()=>[v("âœï¸")])),_:1}),n(l,null,{default:i((()=>[v("ç¼–è¾‘")])),_:1})])),_:2},1032,["onClick"]),n(k,{"v-has-perm":["aioveuSalesOrderDetail:aioveu-sales-order-detail:delete"],class:"action-btn delete",onClick:a=>le(e.id)},{default:i((()=>[n(l,null,{default:i((()=>[v("ðŸ—‘ï¸")])),_:1}),n(l,null,{default:i((()=>[v("åˆ é™¤")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),z.value>0?(d(),u(s,{key:3,class:"pagination"},{default:i((()=>[n(k,{class:"pagination-btn",disabled:V.pageNum<=1,onClick:L},{default:i((()=>[v(" ä¸Šä¸€é¡µ ")])),_:1},8,["disabled"]),n(l,{class:"page-info"},{default:i((()=>[v(_(V.pageNum)+" / "+_(Math.ceil(z.value/V.pageSize)),1)])),_:1}),n(k,{class:"pagination-btn",disabled:V.pageNum*V.pageSize>=z.value,onClick:Q},{default:i((()=>[v(" ä¸‹ä¸€é¡µ ")])),_:1},8,["disabled"])])),_:1})):f("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-babf7acb"]]);export{j as default};
