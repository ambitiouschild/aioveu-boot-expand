import{d as a,h as e,y as l,Y as t,z as s,a as u,w as n,$ as o,i as c,o as i,e as f,b as d,s as r,g as v,t as _,a4 as m,a6 as p,a0 as b,c as g,F as N,r as y,X as h,aa as k,aI as w,aJ as C}from"./index-5U173LQ3.js";import{A as I}from"./aioveu-transaction.BId28B5W.js";import{A}from"./aioveu-customer.MhylDKEJ.js";import{A as D}from"./aioveu-contact.B_5Ds4O-.js";import{D as S}from"./dict.R0KYYCD_.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const T=x(a({__name:"index",setup(a){const x=e(!1),T=e([]),j=e(0),V=e(!1),z=l({pageNum:1,pageSize:10}),M=e([]),O=e([]),P=e([]),R=e([]),U=e([]),X=e([]),Y=e([]),$=e(-1),q=e(-1),B=e(-1),E=e(-1),F=e(-1),J=e(-1),G=e(void 0),H=()=>{V.value=!V.value},K=a=>{const e=a.detail.value;$.value=e,O.value[e]&&(z.customerName=O.value[e].customerName)},L=a=>{const e=a.detail.value;q.value=e,P.value[e]&&(z.contactName=P.value[e].contactName)},Q=a=>{const e=a.detail.value;B.value=e,R.value[e]&&(z.paymentMethod=Number(R.value[e].value))},W=a=>{const e=a.detail.value;E.value=e,U.value[e]&&(z.paymentStatus=Number(U.value[e].value))},Z=a=>{const e=a.detail.value;F.value=e,X.value[e]&&(z.transactionType=Number(X.value[e].value))},aa=a=>{const e=a.detail.value;J.value=e,Y.value[e]&&(z.transactionStatus=Number(Y.value[e].value))},ea=()=>{x.value=!0,I.getPage(z).then((a=>{M.value=a.list,j.value=a.total})).catch((a=>{console.error("查询交易记录失败:",a),o({title:"加载数据失败",icon:"none"})})).finally((()=>{x.value=!1}))},la=()=>{z.pageNum=1,z.transactionNo="",z.customerName="",z.contactName="",z.paymentMethod=void 0,z.paymentStatus=void 0,z.transactionType=void 0,z.transactionStatus=void 0,$.value=-1,q.value=-1,B.value=-1,E.value=-1,F.value=-1,J.value=-1,M.value=[],ea()},ta=()=>{z.pageNum>1&&(z.pageNum--,ea())},sa=()=>{z.pageNum*z.pageSize<j.value&&(z.pageNum++,ea())},ua=e(!1);t((()=>{ua.value&&(ea(),ua.value=!1)}));const na=a=>{ua.value=!0,G.value=a;let e="/packageE/pages/aioveu_customer/transaction/form";void 0!==a&&(e+=`?id=${a}`),h({url:e})},oa=a=>{const e=a?[a]:T.value;0!==e.length?k({title:"提示",content:"确认删除选中的交易记录吗？",success:a=>{a.confirm&&(w({title:"删除中..."}),I.deleteByIds(e.join(",")).then((()=>{o({title:"删除成功",icon:"success"}),la()})).catch((a=>{console.error("删除失败:",a),o({title:"删除失败",icon:"none"})})).finally((()=>C())))}}):o({title:"请选择要删除的交易记录",icon:"none"})},ca=a=>{const e=R.value.find((e=>Number(e.value)===a));return e?e.label:"未知"},ia=a=>{const e=U.value.find((e=>Number(e.value)===a));return e?e.label:"未知"},fa=a=>{const e=X.value.find((e=>Number(e.value)===a));return e?e.label:"未知"},da=a=>{const e=Y.value.find((e=>Number(e.value)===a));return e?e.label:"未知"};return s((()=>{ea(),A.getAllCustomerOptions().then((a=>{Array.isArray(a)&&(O.value=a.map((a=>({customerId:Number(a.customerId),customerName:a.customerName}))))})).catch((a=>{console.error("加载客户选项失败:",a)})),D.getAllContactOptions().then((a=>{Array.isArray(a)&&(P.value=a.map((a=>({contactId:Number(a.contactId),contactName:a.contactName}))))})).catch((a=>{console.error("加载联系人选项失败:",a)})),S.getDictItems("transaction_payment_method").then((a=>{R.value=a})),S.getDictItems("transaction_payment_status").then((a=>{U.value=a})),S.getDictItems("transaction_type").then((a=>{X.value=a})),S.getDictItems("transaction_status").then((a=>{Y.value=a}))})),(a,e)=>{const l=r,t=c,s=m,o=p,h=b;return i(),u(t,{class:"app-container"},{default:n((()=>[f(t,{class:"search-container"},{default:n((()=>[f(t,{class:"filter-header",onClick:H},{default:n((()=>[f(l,null,{default:n((()=>[v("🔍 筛选条件")])),_:1}),f(l,null,{default:n((()=>[v(_(V.value?"▲":"▼"),1)])),_:1})])),_:1}),V.value?(i(),u(t,{key:0,class:"filter-content"},{default:n((()=>[f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("交易ID")])),_:1}),f(s,{type:"text",class:"filter-input",placeholder:"请输入交易ID",modelValue:z.id,"onUpdate:modelValue":e[0]||(e[0]=a=>z.id=a),onConfirm:ea},null,8,["modelValue"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("交易编号")])),_:1}),f(s,{type:"text",class:"filter-input",placeholder:"请输入交易编号",modelValue:z.transactionNo,"onUpdate:modelValue":e[1]||(e[1]=a=>z.transactionNo=a),onConfirm:ea},null,8,["modelValue"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("客户")])),_:1}),f(o,{class:"filter-picker",mode:"selector",range:O.value,"range-key":"customerName",value:$.value,onChange:K},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(_($.value>=0?O.value[$.value].customerName:"请选择客户"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("联系人")])),_:1}),f(o,{class:"filter-picker",mode:"selector",range:P.value,"range-key":"contactName",value:q.value,onChange:L},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(_(q.value>=0?P.value[q.value].contactName:"请选择联系人"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("支付方式")])),_:1}),f(o,{class:"filter-picker",mode:"selector",range:R.value,"range-key":"label",value:B.value,onChange:Q},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(_(B.value>=0?R.value[B.value].label:"请选择支付方式"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("支付状态")])),_:1}),f(o,{class:"filter-picker",mode:"selector",range:U.value,"range-key":"label",value:E.value,onChange:W},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(_(E.value>=0?U.value[E.value].label:"请选择支付状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("交易类型")])),_:1}),f(o,{class:"filter-picker",mode:"selector",range:X.value,"range-key":"label",value:F.value,onChange:Z},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(_(F.value>=0?X.value[F.value].label:"请选择交易类型"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-item"},{default:n((()=>[f(l,{class:"filter-label"},{default:n((()=>[v("交易状态")])),_:1}),f(o,{class:"filter-picker",mode:"selector",range:Y.value,"range-key":"label",value:J.value,onChange:aa},{default:n((()=>[f(t,{class:"picker-view"},{default:n((()=>[v(_(J.value>=0?Y.value[J.value].label:"请选择交易状态"),1)])),_:1})])),_:1},8,["range","value"])])),_:1}),f(t,{class:"filter-buttons"},{default:n((()=>[f(h,{class:"filter-btn reset",onClick:la},{default:n((()=>[v("重置")])),_:1}),f(h,{class:"filter-btn confirm",onClick:ea},{default:n((()=>[v("搜索")])),_:1})])),_:1})])),_:1})):d("",!0)])),_:1}),f(t,{class:"action-buttons"},{default:n((()=>[f(h,{"v-has-perm":["aioveuTransaction:aioveu-transaction:add"],class:"action-btn add",onClick:e[2]||(e[2]=a=>na())},{default:n((()=>[f(l,null,{default:n((()=>[v("+")])),_:1}),f(l,null,{default:n((()=>[v("新增")])),_:1})])),_:1}),f(h,{"v-has-perm":["aioveuTransaction:aioveu-transaction:delete"],class:"action-btn delete",disabled:0===T.value.length,onClick:e[3]||(e[3]=a=>oa())},{default:n((()=>[f(l,null,{default:n((()=>[v("🗑️")])),_:1}),f(l,null,{default:n((()=>[v("删除")])),_:1})])),_:1},8,["disabled"])])),_:1}),f(t,{class:"list-container"},{default:n((()=>[x.value?(i(),u(t,{key:0,class:"loading-state"},{default:n((()=>[f(l,null,{default:n((()=>[v("加载中...")])),_:1})])),_:1})):0===M.value.length?(i(),u(t,{key:1,class:"empty-state"},{default:n((()=>[f(l,{class:"empty-icon"},{default:n((()=>[v("💰")])),_:1}),f(l,{class:"empty-text"},{default:n((()=>[v("暂无交易记录")])),_:1})])),_:1})):(i(!0),g(N,{key:2},y(M.value,(a=>(i(),u(t,{key:a.id,class:"transaction-card"},{default:n((()=>[f(t,{class:"card-header"},{default:n((()=>[f(l,{class:"transaction-id"},{default:n((()=>[v("ID: "+_(a.id),1)])),_:2},1024),f(l,{class:"transaction-no"},{default:n((()=>[v(_(a.transactionNo),1)])),_:2},1024)])),_:2},1024),f(t,{class:"card-content"},{default:n((()=>[f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("客户:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.customerName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("联系人:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.contactName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("交易日期:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.transactionDate),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("交易金额:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.amount)+" "+_(a.currency),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("支付方式:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(ca(a.paymentMethod)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("支付状态:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(ia(a.paymentStatus)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("交易类型:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(fa(a.transactionType)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("发票号码:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.invoiceNo),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("产品ID:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.productId),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("数量:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.quantity),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("单价:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.unitPrice),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("折扣率:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.discount),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("税率:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.taxRate),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("税额:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.taxAmount),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("总金额:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.totalAmount),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("负责人:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.salesRepName),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("交易状态:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(da(a.transactionStatus)),1)])),_:2},1024)])),_:2},1024),f(t,{class:"info-row"},{default:n((()=>[f(l,{class:"info-label"},{default:n((()=>[v("备注:")])),_:1}),f(l,{class:"info-value"},{default:n((()=>[v(_(a.notes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),f(t,{class:"card-footer"},{default:n((()=>[f(t,{class:"time-info"},{default:n((()=>[f(l,null,{default:n((()=>[v("创建: "+_(a.createTime),1)])),_:2},1024),f(l,null,{default:n((()=>[v("更新: "+_(a.updateTime),1)])),_:2},1024)])),_:2},1024),f(t,{class:"action-buttons"},{default:n((()=>[f(h,{"v-has-perm":["aioveuTransaction:aioveu-transaction:edit"],class:"action-btn edit",onClick:e=>na(a.id)},{default:n((()=>[f(l,null,{default:n((()=>[v("✏️")])),_:1}),f(l,null,{default:n((()=>[v("编辑")])),_:1})])),_:2},1032,["onClick"]),f(h,{"v-has-perm":["aioveuTransaction:aioveu-transaction:delete"],class:"action-btn delete",onClick:e=>oa(a.id)},{default:n((()=>[f(l,null,{default:n((()=>[v("🗑️")])),_:1}),f(l,null,{default:n((()=>[v("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),j.value>0?(i(),u(t,{key:3,class:"pagination"},{default:n((()=>[f(h,{class:"pagination-btn",disabled:z.pageNum<=1,onClick:ta},{default:n((()=>[v(" 上一页 ")])),_:1},8,["disabled"]),f(l,{class:"page-info"},{default:n((()=>[v(_(z.pageNum)+" / "+_(Math.ceil(j.value/z.pageSize)),1)])),_:1}),f(h,{class:"pagination-btn",disabled:z.pageNum*z.pageSize>=j.value,onClick:sa},{default:n((()=>[v(" 下一页 ")])),_:1},8,["disabled"])])),_:1})):d("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-9c8cb0aa"]]);export{T as default};
