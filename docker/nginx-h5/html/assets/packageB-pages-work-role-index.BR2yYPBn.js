import{d as e,h as t,l as a,k as l,a as s,o,w as u,e as n,b as i,i as r,a1 as d,n as c,a4 as p,f as m,C as f,y as b,ax as g,al as w,E as h,G as v,u as _,g as x,c as y,F as j,r as V,t as k,aB as N,$ as S,X as C}from"./index-5U173LQ3.js";import{_ as I}from"./wd-input.C2gvQ-R0.js";import{_ as M}from"./wd-button.BzRx3gca.js";import{_ as B,a as P,b as T}from"./wd-loadmore.Dd59NB56.js";import{_ as W}from"./wd-tag.CuuEfSYT.js";import{_ as z}from"./wd-cell.yQBIY-AL.js";import{_ as F}from"./wd-cell-group.CJNVuq-S.js";import{_ as U}from"./wd-text.BpXk7M2k.js";import{_ as q}from"./wd-card.qIX23JsB.js";import{R as $,_ as E}from"./role.hH2QPHbF.js";import{u as O,_ as R,a as G,b as A}from"./wd-message-box.CD4PrFqY.js";import{c as D,b as X,m as H,d as L,a as J,r as K,n as Q,v as Y,f as Z,_ as ee,C as te}from"./wd-icon.CDbxLjoy.js";import{_ as ae}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as le}from"./wd-form.BbkYwo7Z.js";import{w as se}from"./wd-popup.BsbILK4T.js";import"./index.BkHvPazf.js";import"./useCell.qN6vSEvF.js";import"./useParent.Bak0uCS8.js";import"./types.DZx-jF8C.js";import"./types.Prh_CF5p.js";import"./useTranslate.Kg86_MV8.js";import"./base64.3RFQOR3W.js";import"./clickoutside.C7ctyI5d.js";import"./useChildren.Crbe03ZE.js";import"./wd-divider.DIyXdxGw.js";import"./wd-overlay.iGBdgU4M.js";import"./wd-transition.7-0aPBrJ.js";import"./dayjs.CSix6rHa.js";import"./wd-action-sheet.Dzykoifh.js";import"./wd-radio-group.DF6hNek8.js";import"./wd-toast.BszgenSq.js";var oe=(e=>(e.Input="input",e.Blur="blur",e.Watch="watch",e.Button="button",e))(oe||{});function ue(){}const ne=ae(e({name:"wd-input-number",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...D,modelValue:K(Q),min:J(1),max:J(Number.MAX_SAFE_INTEGER),step:J(1),stepStrictly:X(!1),precision:L(0),disabled:X(!1),disableInput:X(!1),disableMinus:X(!1),disablePlus:X(!1),withoutInput:X(!1),inputWidth:L(36),allowNull:X(!1),placeholder:H(""),adjustPosition:X(!0),beforeChange:Function,longPress:X(!1)},emits:["focus","blur","change","update:modelValue"],setup(e,{emit:b}){const g=e,w=b,h=t(function(){const e=z(g.modelValue);y(e,g.modelValue)||w("update:modelValue",e);return e}());let v=null;const _=a((()=>{const e=z(h.value),{disabled:t,min:a,step:l}=g;return t||Number(e)<=a||N(e,-l)<a})),x=a((()=>{const e=z(h.value),{disabled:t,max:a,step:l}=g;return t||Number(e)>=a||N(e,l)>a}));function y(e,t){return te(String(e),String(t))}function j(e){const t=Number(g.precision);return Number(parseFloat(""+Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toFixed(t))}function V(e){if(!Z(e))return 0;const t=e.toString(),a=t.indexOf(".");let l=0;return-1!==a&&(l=t.length-a-1),l}function k(e,t=oe.Input){const a=t!==oe.Watch,l=t===oe.Blur||t===oe.Button;if((t===oe.Input||t===oe.Watch)&&String(e).endsWith(".")&&g.precision)return h.value=e,void f((()=>{h.value=function(e){if(Number(g.precision)>0){const t=e.indexOf(".");return-1===t?e:e.substring(0,t+1)+e.substring(t+1).replace(/\./g,"")}{const t=e.indexOf(".");return-1!==t?e.substring(0,t):e}}(String(e)),w("update:modelValue",h.value),w("change",{value:h.value})}));if(!l&&y(e,h.value))return;const s=()=>function(e){h.value=e;const t=z(e);f((()=>{h.value=t,w("update:modelValue",h.value),w("change",{value:h.value})}))}(e);a?function(e,{args:t=[],done:a,canceled:l,error:s}){if(e){const o=e.apply(null,t);Y(o)?o.then((e=>{e?a():l&&l()})).catch(s||ue):o?a():l&&l()}else a()}(g.beforeChange,{args:[e],done:s}):s()}function N(e,t){if(e=Number(e),isNaN(e))return g.min;const a=Math.max(V(e),V(t)),l=Math.pow(10,a);return j((e*l+t*l)/l)}function S(e){!function(e){if(e<0&&(_.value||g.disableMinus)||e>0&&(x.value||g.disablePlus))return;k(N(h.value,e),oe.Button)}("add"===e?g.step:-g.step)}function C(e){k(e.detail.value||"",oe.Input)}function I(e){const t=e.detail.value||"";k(t,oe.Blur),w("blur",{value:t})}function M(e){T(),v=setTimeout((()=>{S(e),M(e)}),250)}function B(e){g.longPress&&(T(),v=setTimeout((()=>{S(e),M(e)}),600))}function P(){g.longPress&&T()}function T(){v&&(clearTimeout(v),v=null)}function W(e){w("focus",e.detail)}function z(e){if(g.allowNull&&(!Z(e)||""===e))return"";let t=Number(e);return isNaN(t)&&(t=g.min),g.stepStrictly&&(t=function(e){const t=V(g.step),a=Math.pow(10,t);return Math.round(Number(e)/g.step)*a*g.step/a}(e)),t=Math.min(Math.max(t,g.min),g.max),Z(g.precision)&&(t=j(t)),t}return l((()=>g.modelValue),(e=>{k(e,oe.Watch)})),l([()=>g.max,()=>g.min,()=>g.precision],(()=>{k(z(h.value),oe.Watch)})),(e,t)=>{const a=r,l=p;return o(),s(a,{class:c(`wd-input-number ${e.customClass} ${e.disabled?"is-disabled":""} ${e.withoutInput?"is-without-input":""}`),style:m(e.customStyle)},{default:u((()=>[n(a,{class:c("wd-input-number__action "+(_.value||e.disableMinus?"is-disabled":"")),onClick:t[0]||(t[0]=e=>S("sub")),onTouchstart:t[1]||(t[1]=e=>B("sub")),onTouchend:d(P,["stop"])},{default:u((()=>[n(ee,{name:"decrease","custom-class":"wd-input-number__action-icon"})])),_:1},8,["class"]),e.withoutInput?i("",!0):(o(),s(a,{key:0,class:"wd-input-number__inner",onClick:t[2]||(t[2]=d((()=>{}),["stop"]))},{default:u((()=>[n(l,{class:"wd-input-number__input",style:m(""+(e.inputWidth?"width: "+e.inputWidth:"")),type:"digit",disabled:e.disabled||e.disableInput,value:String(h.value),placeholder:e.placeholder,"adjust-position":e.adjustPosition,onInput:C,onFocus:W,onBlur:I},null,8,["style","disabled","value","placeholder","adjust-position"]),n(a,{class:"wd-input-number__input-border"})])),_:1})),n(a,{class:c("wd-input-number__action "+(x.value||e.disablePlus?"is-disabled":"")),onClick:t[3]||(t[3]=e=>S("add")),onTouchstart:t[4]||(t[4]=e=>B("add")),onTouchend:d(P,["stop"])},{default:u((()=>[n(ee,{name:"add","custom-class":"wd-input-number__action-icon"})])),_:1},8,["class"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-b6c8799e"]]),ie=ae(e({options:{styleIsolation:"shared"},__name:"index",setup(e){const a=O(),l=t("loading"),d=t(0),c=b({pageNum:1,pageSize:10}),p=t();function m(){var e;null==(e=p.value)||e.close(),c.pageNum=1,D.value=[],X()}const f=()=>{var e;null==(e=p.value)||e.close(),c.keywords="",c.pageNum=1,D.value=[],X()},D=t([]);function X(){l.value="loading",$.getPage(c).then((e=>{var t;null==(t=D.value)||t.push(...e.list),d.value=e.total})).catch((e=>{console.log("系统异常",e)})).finally((()=>{l.value="finished"}))}g((()=>{c.pageNum*c.pageSize<d.value?(c.pageNum++,X()):l.value="finished"}));const H=e=>{const t=["编辑","分配权限","删除"];N({itemList:t,success:({tapIndex:l})=>{switch(t[l]){case"编辑":Z(e.id);break;case"分配权限":s=e.id,C({url:"/pages/work/role/assign-perm?id="+s});break;case"删除":!function(e){a.confirm({msg:"确认删除角色吗？",title:"提示"}).then((()=>{$.deleteByIds(e+"").then((()=>{S({title:"删除成功",icon:"success"}),c.pageNum=1,m()}))})).catch((()=>{console.log("点击了取消按钮")}))}(e.id)}var s}})},L=b({visible:!1}),J=t([{label:"全部数据",value:0},{label:"部门及子部门数据",value:1},{label:"本部门数据",value:2},{label:"本人数据",value:3}]),K=b({dataScope:0,sort:1}),Q={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],code:[{required:!0,message:"请输入角色编码",trigger:"blur"}],dataScope:[{required:!0,message:"请选择数据权限",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],sort:[{required:!0,message:"请输入排序号",trigger:"change"}]},Y=t();async function Z(e){L.visible=!0,K.id=void 0,K.name="",K.code="",K.dataScope=0,K.status=1,K.sort=1,e&&$.getFormData(e).then((e=>{Object.assign(K,{...e})}))}function ee(){Y.value&&Y.value.validate().then((({valid:e})=>{if(e){const e=K.id;e?$.update(e,K).then((()=>{S({title:"修改成功",icon:"success"}),L.visible=!1,c.pageNum=1,m()})):$.add(K).then((()=>{S({title:"添加成功",icon:"success"}),L.visible=!1,c.pageNum=1,m()}))}}))}return w((()=>{m()})),(e,t)=>{const a=h(v("wd-input"),I),d=h(v("wd-button"),M),b=r,g=h(v("wd-drop-menu-item"),B),w=h(v("wd-drop-menu"),P),N=h(v("wd-tag"),W),S=h(v("wd-cell"),z),C=h(v("wd-cell-group"),F),$=h(v("wd-text"),U),O=h(v("wd-card"),q),te=h(v("wd-loadmore"),T),ae=h(v("wd-fab"),E),oe=h(v("wd-select-picker"),R),ue=h(v("wd-switch"),G),ie=h(v("wd-input-number"),ne),re=h(v("wd-form"),le),de=h(v("wd-popup"),se),ce=h(v("wd-message-box"),A);return o(),s(b,{class:"role"},{default:u((()=>[n(w,null,{default:u((()=>[n(g,{ref_key:"filterDropMenu",ref:p,icon:"filter","icon-size":"18px",title:"筛选"},{default:u((()=>[n(b,null,{default:u((()=>[n(a,{modelValue:_(c).keywords,"onUpdate:modelValue":t[0]||(t[0]=e=>_(c).keywords=e),label:"关键字",type:"text",placeholder:"请输入关键字"},null,8,["modelValue"]),n(b,{class:"flex-between py-2"},{default:u((()=>[n(d,{"custom-class":"w-20%",type:"info",onClick:f},{default:u((()=>[x("重置")])),_:1}),n(d,{"custom-class":"w-70%",onClick:m},{default:u((()=>[x("确定")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1}),n(b,{class:"list-container"},{default:u((()=>[(o(!0),y(j,null,V(_(D),(e=>(o(),s(O,{key:e.id,class:"role-card"},{title:u((()=>[n(b,{class:"flex-between"},{default:u((()=>[n(b,{class:"flex-center"},{default:u((()=>[n(b,{class:"ml-2"},{default:u((()=>[n(b,{class:"font-bold"},{default:u((()=>[x(k(e.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),n(b,null,{default:u((()=>[1===e.status?(o(),s(N,{key:0,type:"success",plain:"",class:"plain"},{default:u((()=>[x("正常")])),_:1})):0===e.status?(o(),s(N,{key:1,plain:"",class:"plain"},{default:u((()=>[x("停用")])),_:1})):i("",!0)])),_:2},1024)])),_:2},1024)])),footer:u((()=>[n(b,{class:"flex-between"},{default:u((()=>[n(b,{class:"text-left"},{default:u((()=>[n($,{text:"创建时间：",size:"small",class:"font-bold text-创建时间："}),n($,{text:e.createTime,size:"small"},null,8,["text"])])),_:2},1024),n(b,{class:"flex-right"},{default:u((()=>[n(d,{size:"small",plain:"",onClick:t=>H(e),class:"plain"},{default:u((()=>[x("操作")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),default:u((()=>[n(C,null,{default:u((()=>[n(S,{title:"编码","title-width":"150rpx",value:e.code},null,8,["value"]),n(S,{title:"排序号","title-width":"150rpx",value:e.sort},null,8,["value"])])),_:2},1024)])),_:2},1024)))),128)),n(te,{state:_(l),onReload:X},null,8,["state"])])),_:1}),n(ae,{position:"left-bottom",expandable:!1,customStyle:"width: 1rem; height: 1rem; line-height: 1rem;z-index:9",onClick:t[1]||(t[1]=e=>Z())}),n(de,{modelValue:_(L).visible,"onUpdate:modelValue":t[7]||(t[7]=e=>_(L).visible=e),position:"bottom","custom-class":"yl-popup"},{default:u((()=>[n(re,{ref_key:"roleFormRef",ref:Y,model:_(K),rules:Q},{default:u((()=>[n(C,{border:"",class:"border"},{default:u((()=>[n(a,{modelValue:_(K).name,"onUpdate:modelValue":t[2]||(t[2]=e=>_(K).name=e),label:"角色名称",prop:"name"},null,8,["modelValue"]),n(a,{modelValue:_(K).code,"onUpdate:modelValue":t[3]||(t[3]=e=>_(K).code=e),label:"角色编码",prop:"code"},null,8,["modelValue"]),n(oe,{modelValue:_(K).dataScope,"onUpdate:modelValue":t[4]||(t[4]=e=>_(K).dataScope=e),type:"radio",label:"数据权限",columns:_(J),"align-right":!0,prop:"dataScope"},null,8,["modelValue","columns"]),n(S,{title:"状态",prop:"status"},{default:u((()=>[n(ue,{modelValue:_(K).status,"onUpdate:modelValue":t[5]||(t[5]=e=>_(K).status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),n(S,{title:"排序",prop:"sort"},{default:u((()=>[n(ie,{modelValue:_(K).sort,"onUpdate:modelValue":t[6]||(t[6]=e=>_(K).sort=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model"]),n(b,{class:"footer"},{default:u((()=>[n(d,{type:"primary",block:"",onClick:ee,class:"block"},{default:u((()=>[x("提交")])),_:1})])),_:1})])),_:1},8,["modelValue"]),n(ce)])),_:1})}}}),[["__scopeId","data-v-f67b7821"]]);export{ie as default};
